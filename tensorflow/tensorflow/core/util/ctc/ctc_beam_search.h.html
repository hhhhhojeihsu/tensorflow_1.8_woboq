<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>ctc_beam_search.h source code [tensorflow/tensorflow/core/util/ctc/ctc_beam_search.h] - Woboq Code Browser</title>
<meta name="woboq:interestingDefinitions" content="tensorflow::ctc::CTCBeamSearchDecoder "/>
<link rel="stylesheet" href="https://code.woboq.org/data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="https://code.woboq.org/data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery-ui.min.js"></script>
<script>var file = 'tensorflow/tensorflow/core/util/ctc/ctc_beam_search.h'; var root_path = '../../../../..'; var data_path = 'https://code.woboq.org/data';</script>
<script src='https://code.woboq.org/data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../../..'>tensorflow</a>/<a href='../../..'>tensorflow</a>/<a href='../..'>core</a>/<a href='..'>util</a>/<a href='./'>ctc</a>/<a href='ctc_beam_search.h.html'>ctc_beam_search.h</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/* Copyright 2016 The TensorFlow Authors. All Rights Reserved.</i></td></tr>
<tr><th id="2">2</th><td><i></i></td></tr>
<tr><th id="3">3</th><td><i>Licensed under the Apache License, Version 2.0 (the "License");</i></td></tr>
<tr><th id="4">4</th><td><i>you may not use this file except in compliance with the License.</i></td></tr>
<tr><th id="5">5</th><td><i>You may obtain a copy of the License at</i></td></tr>
<tr><th id="6">6</th><td><i></i></td></tr>
<tr><th id="7">7</th><td><i>    <a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></i></td></tr>
<tr><th id="8">8</th><td><i></i></td></tr>
<tr><th id="9">9</th><td><i>Unless required by applicable law or agreed to in writing, software</i></td></tr>
<tr><th id="10">10</th><td><i>distributed under the License is distributed on an "AS IS" BASIS,</i></td></tr>
<tr><th id="11">11</th><td><i>WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</i></td></tr>
<tr><th id="12">12</th><td><i>See the License for the specific language governing permissions and</i></td></tr>
<tr><th id="13">13</th><td><i>limitations under the License.</i></td></tr>
<tr><th id="14">14</th><td><i>==============================================================================*/</i></td></tr>
<tr><th id="15">15</th><td></td></tr>
<tr><th id="16">16</th><td><u>#<span data-ppcond="16">ifndef</span> <span class="macro" data-ref="_M/TENSORFLOW_CORE_UTIL_CTC_CTC_BEAM_SEARCH_H_">TENSORFLOW_CORE_UTIL_CTC_CTC_BEAM_SEARCH_H_</span></u></td></tr>
<tr><th id="17">17</th><td><u>#define <dfn class="macro" id="_M/TENSORFLOW_CORE_UTIL_CTC_CTC_BEAM_SEARCH_H_" data-ref="_M/TENSORFLOW_CORE_UTIL_CTC_CTC_BEAM_SEARCH_H_">TENSORFLOW_CORE_UTIL_CTC_CTC_BEAM_SEARCH_H_</dfn></u></td></tr>
<tr><th id="18">18</th><td></td></tr>
<tr><th id="19">19</th><td><u>#include <a href="../../../../../include/c++/5/algorithm.html">&lt;algorithm&gt;</a></u></td></tr>
<tr><th id="20">20</th><td><u>#include <a href="../../../../../include/c++/5/cmath.html">&lt;cmath&gt;</a></u></td></tr>
<tr><th id="21">21</th><td><u>#include <a href="../../../../../include/c++/5/limits.html">&lt;limits&gt;</a></u></td></tr>
<tr><th id="22">22</th><td><u>#include <a href="../../../../../include/c++/5/memory.html">&lt;memory&gt;</a></u></td></tr>
<tr><th id="23">23</th><td><u>#include <a href="../../../../../include/c++/5/vector.html">&lt;vector&gt;</a></u></td></tr>
<tr><th id="24">24</th><td></td></tr>
<tr><th id="25">25</th><td><u>#include <a href="../../../../third_party/eigen3/Eigen/Core.html">"third_party/eigen3/Eigen/Core"</a></u></td></tr>
<tr><th id="26">26</th><td><u>#include <a href="../../lib/core/errors.h.html">"tensorflow/core/lib/core/errors.h"</a></u></td></tr>
<tr><th id="27">27</th><td><u>#include <a href="../../lib/core/status.h.html">"tensorflow/core/lib/core/status.h"</a></u></td></tr>
<tr><th id="28">28</th><td><u>#include <a href="../../lib/gtl/top_n.h.html">"tensorflow/core/lib/gtl/top_n.h"</a></u></td></tr>
<tr><th id="29">29</th><td><u>#include <a href="../../platform/logging.h.html">"tensorflow/core/platform/logging.h"</a></u></td></tr>
<tr><th id="30">30</th><td><u>#include <a href="../../platform/macros.h.html">"tensorflow/core/platform/macros.h"</a></u></td></tr>
<tr><th id="31">31</th><td><u>#include <a href="../../platform/types.h.html">"tensorflow/core/platform/types.h"</a></u></td></tr>
<tr><th id="32">32</th><td><u>#include <a href="ctc_beam_entry.h.html">"tensorflow/core/util/ctc/ctc_beam_entry.h"</a></u></td></tr>
<tr><th id="33">33</th><td><u>#include <a href="ctc_beam_scorer.h.html">"tensorflow/core/util/ctc/ctc_beam_scorer.h"</a></u></td></tr>
<tr><th id="34">34</th><td><u>#include <a href="ctc_decoder.h.html">"tensorflow/core/util/ctc/ctc_decoder.h"</a></u></td></tr>
<tr><th id="35">35</th><td><u>#include <a href="ctc_loss_util.h.html">"tensorflow/core/util/ctc/ctc_loss_util.h"</a></u></td></tr>
<tr><th id="36">36</th><td></td></tr>
<tr><th id="37">37</th><td><b>namespace</b> <span class="namespace">tensorflow</span> {</td></tr>
<tr><th id="38">38</th><td><b>namespace</b> <span class="namespace">ctc</span> {</td></tr>
<tr><th id="39">39</th><td></td></tr>
<tr><th id="40">40</th><td><b>template</b> &lt;<b>typename</b> CTCBeamState = <span class="namespace">ctc_beam_search::</span><a class="type" href="ctc_beam_entry.h.html#tensorflow::ctc::ctc_beam_search::EmptyBeamState" title='tensorflow::ctc::ctc_beam_search::EmptyBeamState' data-ref="tensorflow::ctc::ctc_beam_search::EmptyBeamState">EmptyBeamState</a>,</td></tr>
<tr><th id="41">41</th><td>          <b>typename</b> CTCBeamComparer =</td></tr>
<tr><th id="42">42</th><td>              <span class="namespace">ctc_beam_search::</span><a class="type" href="ctc_beam_entry.h.html#tensorflow::ctc::ctc_beam_search::BeamComparer" title='tensorflow::ctc::ctc_beam_search::BeamComparer' data-ref="tensorflow::ctc::ctc_beam_search::BeamComparer">BeamComparer</a>&lt;CTCBeamState&gt;&gt;</td></tr>
<tr><th id="43">43</th><td><b>class</b> <dfn class="type def" id="tensorflow::ctc::CTCBeamSearchDecoder" title='tensorflow::ctc::CTCBeamSearchDecoder' data-ref="tensorflow::ctc::CTCBeamSearchDecoder">CTCBeamSearchDecoder</dfn> : <b>public</b> <a class="type" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder" title='tensorflow::ctc::CTCDecoder' data-ref="tensorflow::ctc::CTCDecoder">CTCDecoder</a> {</td></tr>
<tr><th id="44">44</th><td>  <i>// Beam Search</i></td></tr>
<tr><th id="45">45</th><td><i>  //</i></td></tr>
<tr><th id="46">46</th><td><i>  // Example (GravesTh Fig. 7.5):</i></td></tr>
<tr><th id="47">47</th><td><i>  //         a    -</i></td></tr>
<tr><th id="48">48</th><td><i>  //  P = [ 0.3  0.7 ]  t = 0</i></td></tr>
<tr><th id="49">49</th><td><i>  //      [ 0.4  0.6 ]  t = 1</i></td></tr>
<tr><th id="50">50</th><td><i>  //</i></td></tr>
<tr><th id="51">51</th><td><i>  // Then P(l = -) = P(--) = 0.7 * 0.6 = 0.42</i></td></tr>
<tr><th id="52">52</th><td><i>  //      P(l = a) = P(a-) + P(aa) + P(-a) = 0.3*0.4 + ... = 0.58</i></td></tr>
<tr><th id="53">53</th><td><i>  //</i></td></tr>
<tr><th id="54">54</th><td><i>  // In this case, Best Path decoding is suboptimal.</i></td></tr>
<tr><th id="55">55</th><td><i>  //</i></td></tr>
<tr><th id="56">56</th><td><i>  // For Beam Search, we use the following main recurrence relations:</i></td></tr>
<tr><th id="57">57</th><td><i>  //</i></td></tr>
<tr><th id="58">58</th><td><i>  // Relation 1:</i></td></tr>
<tr><th id="59">59</th><td><i>  // ---------------------------------------------------------- Eq. 1</i></td></tr>
<tr><th id="60">60</th><td><i>  //      P(l=abcd @ t=7) = P(l=abc  @ t=6) * P(d @ 7)</i></td></tr>
<tr><th id="61">61</th><td><i>  //                      + P(l=abcd @ t=6) * (P(d @ 7) + P(- @ 7))</i></td></tr>
<tr><th id="62">62</th><td><i>  // where P(l=? @ t=7), ? = a, ab, abc, abcd are all stored and</i></td></tr>
<tr><th id="63">63</th><td><i>  // updated recursively in the beam entry.</i></td></tr>
<tr><th id="64">64</th><td><i>  //</i></td></tr>
<tr><th id="65">65</th><td><i>  // Relation 2:</i></td></tr>
<tr><th id="66">66</th><td><i>  // ---------------------------------------------------------- Eq. 2</i></td></tr>
<tr><th id="67">67</th><td><i>  //      P(l=abc? @ t=3) = P(l=abc @ t=2) * P(? @ 3)</i></td></tr>
<tr><th id="68">68</th><td><i>  // for ? in a, b, d, ..., (not including c or the blank index),</i></td></tr>
<tr><th id="69">69</th><td><i>  // and the recurrence starts from the beam entry for P(l=abc @ t=2).</i></td></tr>
<tr><th id="70">70</th><td><i>  //</i></td></tr>
<tr><th id="71">71</th><td><i>  // For this case, the length of the new sequence equals t+1 (t</i></td></tr>
<tr><th id="72">72</th><td><i>  // starts at 0).  This special case can be calculated as:</i></td></tr>
<tr><th id="73">73</th><td><i>  //   P(l=abc? @ t=3) = P(a @ 0)*P(b @ 1)*P(c @ 2)*P(? @ 3)</i></td></tr>
<tr><th id="74">74</th><td><i>  // but we calculate it recursively for speed purposes.</i></td></tr>
<tr><th id="75">75</th><td>  <b>typedef</b> <span class="namespace">ctc_beam_search::</span><a class="type" href="ctc_beam_entry.h.html#tensorflow::ctc::ctc_beam_search::BeamEntry" title='tensorflow::ctc::ctc_beam_search::BeamEntry' data-ref="tensorflow::ctc::ctc_beam_search::BeamEntry">BeamEntry</a>&lt;CTCBeamState&gt; <dfn class="typedef" id="tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry" title='tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry' data-type='ctc_beam_search::BeamEntry&lt;CTCBeamState&gt;' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry">BeamEntry</dfn>;</td></tr>
<tr><th id="76">76</th><td>  <b>typedef</b> <span class="namespace">ctc_beam_search::</span><a class="type" href="ctc_beam_entry.h.html#tensorflow::ctc::ctc_beam_search::BeamRoot" title='tensorflow::ctc::ctc_beam_search::BeamRoot' data-ref="tensorflow::ctc::ctc_beam_search::BeamRoot">BeamRoot</a>&lt;CTCBeamState&gt; <dfn class="typedef" id="tensorflow::ctc::CTCBeamSearchDecoder::BeamRoot" title='tensorflow::ctc::CTCBeamSearchDecoder::BeamRoot' data-type='ctc_beam_search::BeamRoot&lt;CTCBeamState&gt;' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::BeamRoot">BeamRoot</dfn>;</td></tr>
<tr><th id="77">77</th><td>  <b>typedef</b> <span class="namespace">ctc_beam_search::</span><a class="type" href="ctc_beam_entry.h.html#tensorflow::ctc::ctc_beam_search::BeamProbability" title='tensorflow::ctc::ctc_beam_search::BeamProbability' data-ref="tensorflow::ctc::ctc_beam_search::BeamProbability">BeamProbability</a> <dfn class="typedef" id="tensorflow::ctc::CTCBeamSearchDecoder::BeamProbability" title='tensorflow::ctc::CTCBeamSearchDecoder::BeamProbability' data-type='ctc_beam_search::BeamProbability' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::BeamProbability">BeamProbability</dfn>;</td></tr>
<tr><th id="78">78</th><td></td></tr>
<tr><th id="79">79</th><td> <b>public</b>:</td></tr>
<tr><th id="80">80</th><td>  <b>typedef</b> <a class="type" href="ctc_beam_scorer.h.html#tensorflow::ctc::BaseBeamScorer" title='tensorflow::ctc::BaseBeamScorer' data-ref="tensorflow::ctc::BaseBeamScorer">BaseBeamScorer</a>&lt;CTCBeamState&gt; <dfn class="typedef" id="tensorflow::ctc::CTCBeamSearchDecoder::DefaultBeamScorer" title='tensorflow::ctc::CTCBeamSearchDecoder::DefaultBeamScorer' data-type='BaseBeamScorer&lt;CTCBeamState&gt;' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::DefaultBeamScorer">DefaultBeamScorer</dfn>;</td></tr>
<tr><th id="81">81</th><td></td></tr>
<tr><th id="82">82</th><td>  <i>// The beam search decoder is constructed specifying the beam_width (number of</i></td></tr>
<tr><th id="83">83</th><td><i>  // candidates to keep at each decoding timestep) and a beam scorer (used for</i></td></tr>
<tr><th id="84">84</th><td><i>  // custom scoring, for example enabling the use of a language model).</i></td></tr>
<tr><th id="85">85</th><td><i>  // The ownership of the scorer remains with the caller. The default</i></td></tr>
<tr><th id="86">86</th><td><i>  // implementation, CTCBeamSearchDecoder&lt;&gt;::DefaultBeamScorer, generates the</i></td></tr>
<tr><th id="87">87</th><td><i>  // standard beam search.</i></td></tr>
<tr><th id="88">88</th><td>  <dfn class="decl def" id="_ZN10tensorflow3ctc20CTCBeamSearchDecoderC1EiiPNS0_14BaseBeamScorerIT_EEib" title='tensorflow::ctc::CTCBeamSearchDecoder::CTCBeamSearchDecoder&lt;CTCBeamState, CTCBeamComparer&gt;' data-ref="_ZN10tensorflow3ctc20CTCBeamSearchDecoderC1EiiPNS0_14BaseBeamScorerIT_EEib">CTCBeamSearchDecoder</dfn>(<em>int</em> <dfn class="local col2 decl" id="52num_classes" title='num_classes' data-type='int' data-ref="52num_classes">num_classes</dfn>, <em>int</em> <dfn class="local col3 decl" id="53beam_width" title='beam_width' data-type='int' data-ref="53beam_width">beam_width</dfn>,</td></tr>
<tr><th id="89">89</th><td>                       <a class="type" href="ctc_beam_scorer.h.html#tensorflow::ctc::BaseBeamScorer" title='tensorflow::ctc::BaseBeamScorer' data-ref="tensorflow::ctc::BaseBeamScorer">BaseBeamScorer</a>&lt;CTCBeamState&gt;* <dfn class="local col4 decl" id="54scorer" title='scorer' data-type='BaseBeamScorer&lt;CTCBeamState&gt; *' data-ref="54scorer">scorer</dfn>, <em>int</em> <dfn class="local col5 decl" id="55batch_size" title='batch_size' data-type='int' data-ref="55batch_size">batch_size</dfn> = <var>1</var>,</td></tr>
<tr><th id="90">90</th><td>                       <em>bool</em> <dfn class="local col6 decl" id="56merge_repeated" title='merge_repeated' data-type='bool' data-ref="56merge_repeated">merge_repeated</dfn> = <b>false</b>)</td></tr>
<tr><th id="91">91</th><td>      : <a class="type" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder" title='tensorflow::ctc::CTCDecoder' data-ref="tensorflow::ctc::CTCDecoder">CTCDecoder</a>(<a class="local col2 ref" href="#52num_classes" title='num_classes' data-ref="52num_classes">num_classes</a>, <a class="local col5 ref" href="#55batch_size" title='batch_size' data-ref="55batch_size">batch_size</a>, <a class="local col6 ref" href="#56merge_repeated" title='merge_repeated' data-ref="56merge_repeated">merge_repeated</a>),</td></tr>
<tr><th id="92">92</th><td>        <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::beam_width_" title='tensorflow::ctc::CTCBeamSearchDecoder::beam_width_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::beam_width_">beam_width_</a>(<a class="local col3 ref" href="#53beam_width" title='beam_width' data-ref="53beam_width">beam_width</a>),</td></tr>
<tr><th id="93">93</th><td>        <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::leaves_" title='tensorflow::ctc::CTCBeamSearchDecoder::leaves_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::leaves_">leaves_</a>(<a class="local col3 ref" href="#53beam_width" title='beam_width' data-ref="53beam_width">beam_width</a>),</td></tr>
<tr><th id="94">94</th><td>        <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_" title='tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_">beam_scorer_</a>(<a class="macro" href="../../platform/default/logging.h.html#257" title="::tensorflow::internal::CheckNotNull(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/./tensorflow/core/util/ctc/ctc_beam_search.h&quot;, 94, &quot;&apos;&quot; &quot;scorer&quot; &quot;&apos; Must be non NULL&quot;, (scorer))" data-ref="_M/CHECK_NOTNULL">CHECK_NOTNULL</a>(<a class="local col4 ref" href="#54scorer" title='scorer' data-ref="54scorer">scorer</a>)) {</td></tr>
<tr><th id="95">95</th><td>    <a class="member" href="#_ZN10tensorflow3ctc20CTCBeamSearchDecoder5ResetEv" title='tensorflow::ctc::CTCBeamSearchDecoder::Reset' data-ref="_ZN10tensorflow3ctc20CTCBeamSearchDecoder5ResetEv">Reset</a>();</td></tr>
<tr><th id="96">96</th><td>  }</td></tr>
<tr><th id="97">97</th><td></td></tr>
<tr><th id="98">98</th><td>  <dfn class="virtual decl def" id="_ZN10tensorflow3ctc20CTCBeamSearchDecoderD1Ev" title='tensorflow::ctc::CTCBeamSearchDecoder::~CTCBeamSearchDecoder&lt;CTCBeamState, CTCBeamComparer&gt;' data-ref="_ZN10tensorflow3ctc20CTCBeamSearchDecoderD1Ev">~CTCBeamSearchDecoder</dfn>() override {}</td></tr>
<tr><th id="99">99</th><td></td></tr>
<tr><th id="100">100</th><td>  <i>// Run the hibernating beam search algorithm on the given input.</i></td></tr>
<tr><th id="101">101</th><td>  <a class="type" href="../../lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a> <a class="virtual decl" href="#_ZN10tensorflow3ctc20CTCBeamSearchDecoder6DecodeERKN5Eigen3MapIKNS2_5ArrayIiLin1ELi1ELi0ELin1ELi1EEELi0ENS2_6StrideILi0ELi0EEEEERKSt6vectorINS3_IKNS2_15907997" title='tensorflow::ctc::CTCBeamSearchDecoder::Decode' data-ref="_ZN10tensorflow3ctc20CTCBeamSearchDecoder6DecodeERKN5Eigen3MapIKNS2_5ArrayIiLin1ELi1ELi0ELin1ELi1EEELi0ENS2_6StrideILi0ELi0EEEEERKSt6vectorINS3_IKNS2_15907997">Decode</a>(<em>const</em> <a class="type" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder" title='tensorflow::ctc::CTCDecoder' data-ref="tensorflow::ctc::CTCDecoder">CTCDecoder</a>::<a class="typedef" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder::SequenceLength" title='tensorflow::ctc::CTCDecoder::SequenceLength' data-type='Eigen::Map&lt;const Eigen::ArrayXi&gt;' data-ref="tensorflow::ctc::CTCDecoder::SequenceLength">SequenceLength</a>&amp; <dfn class="local col7 decl" id="57seq_len" title='seq_len' data-type='const CTCDecoder::SequenceLength &amp;' data-ref="57seq_len">seq_len</dfn>,</td></tr>
<tr><th id="102">102</th><td>                <em>const</em> <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<a class="type" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder" title='tensorflow::ctc::CTCDecoder' data-ref="tensorflow::ctc::CTCDecoder">CTCDecoder</a>::<a class="typedef" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder::Input" title='tensorflow::ctc::CTCDecoder::Input' data-type='Eigen::Map&lt;const Eigen::MatrixXf&gt;' data-ref="tensorflow::ctc::CTCDecoder::Input">Input</a>&gt;&amp; <dfn class="local col8 decl" id="58input" title='input' data-type='const std::vector&lt;CTCDecoder::Input&gt; &amp;' data-ref="58input">input</dfn>,</td></tr>
<tr><th id="103">103</th><td>                <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<a class="type" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder" title='tensorflow::ctc::CTCDecoder' data-ref="tensorflow::ctc::CTCDecoder">CTCDecoder</a>::<a class="typedef" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder::Output" title='tensorflow::ctc::CTCDecoder::Output' data-type='std::vector&lt;std::vector&lt;int&gt; &gt;' data-ref="tensorflow::ctc::CTCDecoder::Output">Output</a>&gt;* <dfn class="local col9 decl" id="59output" title='output' data-type='std::vector&lt;CTCDecoder::Output&gt; *' data-ref="59output">output</dfn>,</td></tr>
<tr><th id="104">104</th><td>                <a class="type" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder" title='tensorflow::ctc::CTCDecoder' data-ref="tensorflow::ctc::CTCDecoder">CTCDecoder</a>::<a class="typedef" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder::ScoreOutput" title='tensorflow::ctc::CTCDecoder::ScoreOutput' data-type='Eigen::Map&lt;Eigen::MatrixXf&gt;' data-ref="tensorflow::ctc::CTCDecoder::ScoreOutput">ScoreOutput</a>* <dfn class="local col0 decl" id="60scores" title='scores' data-type='CTCDecoder::ScoreOutput *' data-ref="60scores">scores</dfn>) override;</td></tr>
<tr><th id="105">105</th><td></td></tr>
<tr><th id="106">106</th><td>  <i>// Calculate the next step of the beam search and update the internal state.</i></td></tr>
<tr><th id="107">107</th><td>  <b>template</b> &lt;<b>typename</b> Vector&gt;</td></tr>
<tr><th id="108">108</th><td>  <em>void</em> <a class="decl" href="#_ZN10tensorflow3ctc20CTCBeamSearchDecoder4StepERKT_" title='tensorflow::ctc::CTCBeamSearchDecoder::Step' data-ref="_ZN10tensorflow3ctc20CTCBeamSearchDecoder4StepERKT_">Step</a>(<em>const</em> Vector&amp; <dfn class="local col1 decl" id="61log_input_t" title='log_input_t' data-type='const Vector &amp;' data-ref="61log_input_t">log_input_t</dfn>);</td></tr>
<tr><th id="109">109</th><td></td></tr>
<tr><th id="110">110</th><td>  <b>template</b> &lt;<b>typename</b> Vector&gt;</td></tr>
<tr><th id="111">111</th><td>  <em>float</em> <a class="decl" href="#_ZN10tensorflow3ctc20CTCBeamSearchDecoder7GetTopKEiRKT_PSt6vectorIfSaIfEEPS5_IiSaIiEE" title='tensorflow::ctc::CTCBeamSearchDecoder::GetTopK' data-ref="_ZN10tensorflow3ctc20CTCBeamSearchDecoder7GetTopKEiRKT_PSt6vectorIfSaIfEEPS5_IiSaIiEE">GetTopK</a>(<em>const</em> <em>int</em> <dfn class="local col2 decl" id="62K" title='K' data-type='const int' data-ref="62K">K</dfn>, <em>const</em> Vector&amp; <dfn class="local col3 decl" id="63input" title='input' data-type='const Vector &amp;' data-ref="63input">input</dfn>,</td></tr>
<tr><th id="112">112</th><td>                <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<em>float</em>&gt;* <dfn class="local col4 decl" id="64top_k_logits" title='top_k_logits' data-type='std::vector&lt;float&gt; *' data-ref="64top_k_logits">top_k_logits</dfn>,</td></tr>
<tr><th id="113">113</th><td>                <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<em>int</em>&gt;* <dfn class="local col5 decl" id="65top_k_indices" title='top_k_indices' data-type='std::vector&lt;int&gt; *' data-ref="65top_k_indices">top_k_indices</dfn>);</td></tr>
<tr><th id="114">114</th><td></td></tr>
<tr><th id="115">115</th><td>  <i>// Retrieve the beam scorer instance used during decoding.</i></td></tr>
<tr><th id="116">116</th><td>  <a class="type" href="ctc_beam_scorer.h.html#tensorflow::ctc::BaseBeamScorer" title='tensorflow::ctc::BaseBeamScorer' data-ref="tensorflow::ctc::BaseBeamScorer">BaseBeamScorer</a>&lt;CTCBeamState&gt;* <dfn class="decl def" id="_ZNK10tensorflow3ctc20CTCBeamSearchDecoder13GetBeamScorerEv" title='tensorflow::ctc::CTCBeamSearchDecoder::GetBeamScorer' data-ref="_ZNK10tensorflow3ctc20CTCBeamSearchDecoder13GetBeamScorerEv">GetBeamScorer</dfn>() <em>const</em> { <b>return</b> <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_" title='tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_">beam_scorer_</a>; }</td></tr>
<tr><th id="117">117</th><td></td></tr>
<tr><th id="118">118</th><td>  <i>// Set label selection parameters for faster decoding.</i></td></tr>
<tr><th id="119">119</th><td><i>  // See comments for label_selection_size_ and label_selection_margin_.</i></td></tr>
<tr><th id="120">120</th><td>  <em>void</em> <dfn class="decl def" id="_ZN10tensorflow3ctc20CTCBeamSearchDecoder27SetLabelSelectionParametersEif" title='tensorflow::ctc::CTCBeamSearchDecoder::SetLabelSelectionParameters' data-ref="_ZN10tensorflow3ctc20CTCBeamSearchDecoder27SetLabelSelectionParametersEif">SetLabelSelectionParameters</dfn>(<em>int</em> <dfn class="local col6 decl" id="66label_selection_size" title='label_selection_size' data-type='int' data-ref="66label_selection_size">label_selection_size</dfn>,</td></tr>
<tr><th id="121">121</th><td>                                   <em>float</em> <dfn class="local col7 decl" id="67label_selection_margin" title='label_selection_margin' data-type='float' data-ref="67label_selection_margin">label_selection_margin</dfn>) {</td></tr>
<tr><th id="122">122</th><td>    <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::label_selection_size_" title='tensorflow::ctc::CTCBeamSearchDecoder::label_selection_size_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::label_selection_size_">label_selection_size_</a> = <a class="local col6 ref" href="#66label_selection_size" title='label_selection_size' data-ref="66label_selection_size">label_selection_size</a>;</td></tr>
<tr><th id="123">123</th><td>    <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::label_selection_margin_" title='tensorflow::ctc::CTCBeamSearchDecoder::label_selection_margin_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::label_selection_margin_">label_selection_margin_</a> = <a class="local col7 ref" href="#67label_selection_margin" title='label_selection_margin' data-ref="67label_selection_margin">label_selection_margin</a>;</td></tr>
<tr><th id="124">124</th><td>  }</td></tr>
<tr><th id="125">125</th><td></td></tr>
<tr><th id="126">126</th><td>  <i>// Reset the beam search</i></td></tr>
<tr><th id="127">127</th><td>  <em>void</em> <a class="decl" href="#_ZN10tensorflow3ctc20CTCBeamSearchDecoder5ResetEv" title='tensorflow::ctc::CTCBeamSearchDecoder::Reset' data-ref="_ZN10tensorflow3ctc20CTCBeamSearchDecoder5ResetEv">Reset</a>();</td></tr>
<tr><th id="128">128</th><td></td></tr>
<tr><th id="129">129</th><td>  <i>// Extract the top n paths at current time step</i></td></tr>
<tr><th id="130">130</th><td>  <a class="type" href="../../lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a> <a class="decl" href="#_ZNK10tensorflow3ctc20CTCBeamSearchDecoder8TopPathsEiPSt6vectorIS2_IiSaIiEESaIS4_EEPS2_IfSaIfEEb" title='tensorflow::ctc::CTCBeamSearchDecoder::TopPaths' data-ref="_ZNK10tensorflow3ctc20CTCBeamSearchDecoder8TopPathsEiPSt6vectorIS2_IiSaIiEESaIS4_EEPS2_IfSaIfEEb">TopPaths</a>(<em>int</em> <dfn class="local col8 decl" id="68n" title='n' data-type='int' data-ref="68n">n</dfn>, <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<em>int</em>&gt;&gt;* <dfn class="local col9 decl" id="69paths" title='paths' data-type='std::vector&lt;std::vector&lt;int&gt; &gt; *' data-ref="69paths">paths</dfn>,</td></tr>
<tr><th id="131">131</th><td>                  <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<em>float</em>&gt;* <dfn class="local col0 decl" id="70log_probs" title='log_probs' data-type='std::vector&lt;float&gt; *' data-ref="70log_probs">log_probs</dfn>, <em>bool</em> <dfn class="local col1 decl" id="71merge_repeated" title='merge_repeated' data-type='bool' data-ref="71merge_repeated">merge_repeated</dfn>) <em>const</em>;</td></tr>
<tr><th id="132">132</th><td></td></tr>
<tr><th id="133">133</th><td> <b>private</b>:</td></tr>
<tr><th id="134">134</th><td>  <em>int</em> <dfn class="decl" id="tensorflow::ctc::CTCBeamSearchDecoder::beam_width_" title='tensorflow::ctc::CTCBeamSearchDecoder::beam_width_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::beam_width_">beam_width_</dfn>;</td></tr>
<tr><th id="135">135</th><td></td></tr>
<tr><th id="136">136</th><td>  <i>// Label selection is designed to avoid possibly very expensive scorer calls,</i></td></tr>
<tr><th id="137">137</th><td><i>  // by pruning the hypotheses based on the input alone.</i></td></tr>
<tr><th id="138">138</th><td><i>  // Label selection size controls how many items in each beam are passed</i></td></tr>
<tr><th id="139">139</th><td><i>  // through to the beam scorer. Only items with top N input scores are</i></td></tr>
<tr><th id="140">140</th><td><i>  // considered.</i></td></tr>
<tr><th id="141">141</th><td><i>  // Label selection margin controls the difference between minimal input score</i></td></tr>
<tr><th id="142">142</th><td><i>  // (versus the best scoring label) for an item to be passed to the beam</i></td></tr>
<tr><th id="143">143</th><td><i>  // scorer. This margin is expressed in terms of log-probability.</i></td></tr>
<tr><th id="144">144</th><td><i>  // Default is to do no label selection.</i></td></tr>
<tr><th id="145">145</th><td><i>  // For more detail: <a href="https://research.google.com/pubs/pub44823.html">https://research.google.com/pubs/pub44823.html</a></i></td></tr>
<tr><th id="146">146</th><td>  <em>int</em> <dfn class="decl" id="tensorflow::ctc::CTCBeamSearchDecoder::label_selection_size_" title='tensorflow::ctc::CTCBeamSearchDecoder::label_selection_size_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::label_selection_size_">label_selection_size_</dfn> = <var>0</var>;       <i>// zero means unlimited</i></td></tr>
<tr><th id="147">147</th><td>  <em>float</em> <dfn class="decl" id="tensorflow::ctc::CTCBeamSearchDecoder::label_selection_margin_" title='tensorflow::ctc::CTCBeamSearchDecoder::label_selection_margin_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::label_selection_margin_">label_selection_margin_</dfn> = -<var>1</var>;  <i>// -1 means unlimited.</i></td></tr>
<tr><th id="148">148</th><td></td></tr>
<tr><th id="149">149</th><td>  <span class="namespace">gtl::</span><a class="type" href="../../lib/gtl/top_n.h.html#tensorflow::gtl::TopN" title='tensorflow::gtl::TopN' data-ref="tensorflow::gtl::TopN">TopN</a>&lt;<a class="typedef" href="#tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry" title='tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry' data-type='ctc_beam_search::BeamEntry&lt;CTCBeamState&gt;' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry">BeamEntry</a>*, CTCBeamComparer&gt; <dfn class="decl" id="tensorflow::ctc::CTCBeamSearchDecoder::leaves_" title='tensorflow::ctc::CTCBeamSearchDecoder::leaves_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::leaves_">leaves_</dfn>;</td></tr>
<tr><th id="150">150</th><td>  <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/unique_ptr.h.html#std::unique_ptr" title='std::unique_ptr' data-ref="std::unique_ptr">unique_ptr</a>&lt;<a class="typedef" href="#tensorflow::ctc::CTCBeamSearchDecoder::BeamRoot" title='tensorflow::ctc::CTCBeamSearchDecoder::BeamRoot' data-type='ctc_beam_search::BeamRoot&lt;CTCBeamState&gt;' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::BeamRoot">BeamRoot</a>&gt; <dfn class="decl" id="tensorflow::ctc::CTCBeamSearchDecoder::beam_root_" title='tensorflow::ctc::CTCBeamSearchDecoder::beam_root_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::beam_root_">beam_root_</dfn>;</td></tr>
<tr><th id="151">151</th><td>  <a class="type" href="ctc_beam_scorer.h.html#tensorflow::ctc::BaseBeamScorer" title='tensorflow::ctc::BaseBeamScorer' data-ref="tensorflow::ctc::BaseBeamScorer">BaseBeamScorer</a>&lt;CTCBeamState&gt;* <dfn class="decl" id="tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_" title='tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_">beam_scorer_</dfn>;</td></tr>
<tr><th id="152">152</th><td></td></tr>
<tr><th id="153">153</th><td>  <a class="macro" href="../../platform/macros.h.html#91" title="CTCBeamSearchDecoder(const CTCBeamSearchDecoder&amp;) = delete; void operator=(const CTCBeamSearchDecoder&amp;) = delete" data-ref="_M/TF_DISALLOW_COPY_AND_ASSIGN">TF_DISALLOW_COPY_AND_ASSIGN</a>(<dfn class="decl def" id="_ZN10tensorflow3ctc20CTCBeamSearchDecoderC1ERKNS0_20CTCBeamSearchDecoderIT_T0_EE" title='tensorflow::ctc::CTCBeamSearchDecoder::CTCBeamSearchDecoder&lt;CTCBeamState, CTCBeamComparer&gt;' data-ref="_ZN10tensorflow3ctc20CTCBeamSearchDecoderC1ERKNS0_20CTCBeamSearchDecoderIT_T0_EE">CTCBeamSearchDecoder</dfn>);</td></tr>
<tr><th id="154">154</th><td>};</td></tr>
<tr><th id="155">155</th><td></td></tr>
<tr><th id="156">156</th><td><b>template</b> &lt;<b>typename</b> CTCBeamState, <b>typename</b> CTCBeamComparer&gt;</td></tr>
<tr><th id="157">157</th><td><a class="type" href="../../lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a> <a class="type" href="#tensorflow::ctc::CTCBeamSearchDecoder" title='tensorflow::ctc::CTCBeamSearchDecoder' data-ref="tensorflow::ctc::CTCBeamSearchDecoder">CTCBeamSearchDecoder</a>&lt;CTCBeamState, CTCBeamComparer&gt;::<dfn class="virtual decl def" id="_ZN10tensorflow3ctc20CTCBeamSearchDecoder6DecodeERKN5Eigen3MapIKNS2_5ArrayIiLin1ELi1ELi0ELin1ELi1EEELi0ENS2_6StrideILi0ELi0EEEEERKSt6vectorINS3_IKNS2_15907997" title='tensorflow::ctc::CTCBeamSearchDecoder::Decode' data-ref="_ZN10tensorflow3ctc20CTCBeamSearchDecoder6DecodeERKN5Eigen3MapIKNS2_5ArrayIiLin1ELi1ELi0ELin1ELi1EEELi0ENS2_6StrideILi0ELi0EEEEERKSt6vectorINS3_IKNS2_15907997">Decode</dfn>(</td></tr>
<tr><th id="158">158</th><td>    <em>const</em> <a class="type" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder" title='tensorflow::ctc::CTCDecoder' data-ref="tensorflow::ctc::CTCDecoder">CTCDecoder</a>::<a class="typedef" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder::SequenceLength" title='tensorflow::ctc::CTCDecoder::SequenceLength' data-type='Eigen::Map&lt;const Eigen::ArrayXi&gt;' data-ref="tensorflow::ctc::CTCDecoder::SequenceLength">SequenceLength</a>&amp; <dfn class="local col2 decl" id="72seq_len" title='seq_len' data-type='const CTCDecoder::SequenceLength &amp;' data-ref="72seq_len">seq_len</dfn>,</td></tr>
<tr><th id="159">159</th><td>    <em>const</em> <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<a class="type" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder" title='tensorflow::ctc::CTCDecoder' data-ref="tensorflow::ctc::CTCDecoder">CTCDecoder</a>::<a class="typedef" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder::Input" title='tensorflow::ctc::CTCDecoder::Input' data-type='Eigen::Map&lt;const Eigen::MatrixXf&gt;' data-ref="tensorflow::ctc::CTCDecoder::Input">Input</a>&gt;&amp; <dfn class="local col3 decl" id="73input" title='input' data-type='const std::vector&lt;CTCDecoder::Input&gt; &amp;' data-ref="73input">input</dfn>,</td></tr>
<tr><th id="160">160</th><td>    <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<a class="type" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder" title='tensorflow::ctc::CTCDecoder' data-ref="tensorflow::ctc::CTCDecoder">CTCDecoder</a>::<a class="typedef" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder::Output" title='tensorflow::ctc::CTCDecoder::Output' data-type='std::vector&lt;std::vector&lt;int&gt; &gt;' data-ref="tensorflow::ctc::CTCDecoder::Output">Output</a>&gt;* <dfn class="local col4 decl" id="74output" title='output' data-type='std::vector&lt;CTCDecoder::Output&gt; *' data-ref="74output">output</dfn>, <a class="typedef" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder::ScoreOutput" title='tensorflow::ctc::CTCDecoder::ScoreOutput' data-type='Eigen::Map&lt;Eigen::MatrixXf&gt;' data-ref="tensorflow::ctc::CTCDecoder::ScoreOutput">ScoreOutput</a>* <dfn class="local col5 decl" id="75scores" title='scores' data-type='ScoreOutput *' data-ref="75scores">scores</dfn>) {</td></tr>
<tr><th id="161">161</th><td>  <i>// Storage for top paths.</i></td></tr>
<tr><th id="162">162</th><td>  <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<em>int</em>&gt;&gt; <a class="ref fake" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorC1Ev" title='std::vector::vector&lt;_Tp, _Alloc&gt;' data-ref="_ZNSt6vectorC1Ev"></a><dfn class="local col6 decl" id="76beams" title='beams' data-type='std::vector&lt;std::vector&lt;int&gt; &gt;' data-ref="76beams">beams</dfn>;</td></tr>
<tr><th id="163">163</th><td>  <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<em>float</em>&gt; <a class="ref fake" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorC1Ev" title='std::vector::vector&lt;_Tp, _Alloc&gt;' data-ref="_ZNSt6vectorC1Ev"></a><dfn class="local col7 decl" id="77beam_log_probabilities" title='beam_log_probabilities' data-type='std::vector&lt;float&gt;' data-ref="77beam_log_probabilities">beam_log_probabilities</dfn>;</td></tr>
<tr><th id="164">164</th><td>  <em>int</em> <dfn class="local col8 decl" id="78top_n" title='top_n' data-type='int' data-ref="78top_n">top_n</dfn> = <a class="local col4 ref" href="#74output" title='output' data-ref="74output">output</a>-&gt;<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNKSt6vector4sizeEv" title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv">size</a>();</td></tr>
<tr><th id="165">165</th><td>  <b>if</b> (<span class="namespace">std::</span>any_of(<a class="local col4 ref" href="#74output" title='output' data-ref="74output">output</a>-&gt;<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vector5beginEv" title='std::vector::begin' data-ref="_ZNSt6vector5beginEv">begin</a>(), <a class="local col4 ref" href="#74output" title='output' data-ref="74output">output</a>-&gt;<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vector3endEv" title='std::vector::end' data-ref="_ZNSt6vector3endEv">end</a>(),</td></tr>
<tr><th id="166">166</th><td>                  [<b>this</b>](<em>const</em> <a class="type" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder" title='tensorflow::ctc::CTCDecoder' data-ref="tensorflow::ctc::CTCDecoder">CTCDecoder</a>::<a class="typedef" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder::Output" title='tensorflow::ctc::CTCDecoder::Output' data-type='std::vector&lt;std::vector&lt;int&gt; &gt;' data-ref="tensorflow::ctc::CTCDecoder::Output">Output</a>&amp; <dfn class="local col9 decl" id="79output" title='output' data-type='const CTCDecoder::Output &amp;' data-ref="79output">output</dfn>) -&gt; <em>bool</em> {</td></tr>
<tr><th id="167">167</th><td>                    <b>return</b> <a class="local col9 ref" href="#79output" title='output' data-ref="79output">output</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNKSt6vector4sizeEv" title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv">size</a>() &lt; <b>this</b>-&gt;batch_size_;</td></tr>
<tr><th id="168">168</th><td>                  })) {</td></tr>
<tr><th id="169">169</th><td>    <b>return</b> <span class="namespace">errors::</span><a class="ref" href="../../lib/core/errors.h.html#103" title='tensorflow::errors::InvalidArgument' data-ref="_ZN10tensorflow6errors15InvalidArgumentEDpT_">InvalidArgument</a>(</td></tr>
<tr><th id="170">170</th><td>        <q>"output needs to be of size at least (top_n, batch_size)."</q>);</td></tr>
<tr><th id="171">171</th><td>  }</td></tr>
<tr><th id="172">172</th><td>  <b>if</b> (<a class="local col5 ref" href="#75scores" title='scores' data-ref="75scores">scores</a>-&gt;<span class='ref' title='Eigen::MapBase&lt;type-parameter-0-0, 0&gt;::rows' data-ref="_ZNK5Eigen7MapBaseIT_Li0EE4rowsEv">rows</span>() &lt; <a class="member" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder::batch_size_" title='tensorflow::ctc::CTCDecoder::batch_size_' data-ref="tensorflow::ctc::CTCDecoder::batch_size_">batch_size_</a> || <a class="local col5 ref" href="#75scores" title='scores' data-ref="75scores">scores</a>-&gt;<span class='ref' title='Eigen::MapBase&lt;type-parameter-0-0, 0&gt;::cols' data-ref="_ZNK5Eigen7MapBaseIT_Li0EE4colsEv">cols</span>() &lt; <a class="local col8 ref" href="#78top_n" title='top_n' data-ref="78top_n">top_n</a>) {</td></tr>
<tr><th id="173">173</th><td>    <b>return</b> <span class="namespace">errors::</span><a class="ref" href="../../lib/core/errors.h.html#103" title='tensorflow::errors::InvalidArgument' data-ref="_ZN10tensorflow6errors15InvalidArgumentEDpT_">InvalidArgument</a>(</td></tr>
<tr><th id="174">174</th><td>        <q>"scores needs to be of size at least (batch_size, top_n)."</q>);</td></tr>
<tr><th id="175">175</th><td>  }</td></tr>
<tr><th id="176">176</th><td></td></tr>
<tr><th id="177">177</th><td>  <b>for</b> (<em>int</em> <dfn class="local col0 decl" id="80b" title='b' data-type='int' data-ref="80b">b</dfn> = <var>0</var>; <a class="local col0 ref" href="#80b" title='b' data-ref="80b">b</a> &lt; <a class="member" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder::batch_size_" title='tensorflow::ctc::CTCDecoder::batch_size_' data-ref="tensorflow::ctc::CTCDecoder::batch_size_">batch_size_</a>; ++<a class="local col0 ref" href="#80b" title='b' data-ref="80b">b</a>) {</td></tr>
<tr><th id="178">178</th><td>    <em>int</em> <dfn class="local col1 decl" id="81seq_len_b" title='seq_len_b' data-type='int' data-ref="81seq_len_b">seq_len_b</dfn> = <a class="local col2 ref" href="#72seq_len" title='seq_len' data-ref="72seq_len">seq_len</a><span class='ref' title='Eigen::DenseCoeffsBase&lt;type-parameter-0-0, 0&gt;::operator[]' data-ref="_ZNK5Eigen15DenseCoeffsBaseIT_Li0EEixEl">[<a class="local col0 ref" href="#80b" title='b' data-ref="80b">b</a>]</span>;</td></tr>
<tr><th id="179">179</th><td>    <a class="member" href="#_ZN10tensorflow3ctc20CTCBeamSearchDecoder5ResetEv" title='tensorflow::ctc::CTCBeamSearchDecoder::Reset' data-ref="_ZN10tensorflow3ctc20CTCBeamSearchDecoder5ResetEv">Reset</a>();</td></tr>
<tr><th id="180">180</th><td></td></tr>
<tr><th id="181">181</th><td>    <b>for</b> (<em>int</em> <dfn class="local col2 decl" id="82t" title='t' data-type='int' data-ref="82t">t</dfn> = <var>0</var>; <a class="local col2 ref" href="#82t" title='t' data-ref="82t">t</a> &lt; <a class="local col1 ref" href="#81seq_len_b" title='seq_len_b' data-ref="81seq_len_b">seq_len_b</a>; ++<a class="local col2 ref" href="#82t" title='t' data-ref="82t">t</a>) {</td></tr>
<tr><th id="182">182</th><td>      <i>// Pass log-probabilities for this example + time.</i></td></tr>
<tr><th id="183">183</th><td>      Step(<a class="local col3 ref" href="#73input" title='input' data-ref="73input">input</a><a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNKSt6vectorixEm" title='std::vector::operator[]' data-ref="_ZNKSt6vectorixEm">[<a class="local col2 ref" href="#82t" title='t' data-ref="82t">t</a>]</a>.<span class='ref' title='Eigen::DenseBase::row' data-ref="_ZNK5Eigen9DenseBase3rowEl">row</span>(<a class="local col0 ref" href="#80b" title='b' data-ref="80b">b</a>));</td></tr>
<tr><th id="184">184</th><td>    }  <i>// for (int t...</i></td></tr>
<tr><th id="185">185</th><td></td></tr>
<tr><th id="186">186</th><td>    <i>// O(n * log(n))</i></td></tr>
<tr><th id="187">187</th><td>    <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/unique_ptr.h.html#std::unique_ptr" title='std::unique_ptr' data-ref="std::unique_ptr">unique_ptr</a>&lt;<span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<a class="typedef" href="#tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry" title='tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry' data-type='ctc_beam_search::BeamEntry&lt;CTCBeamState&gt;' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry">BeamEntry</a>*&gt;&gt; <dfn class="local col3 decl" id="83branches" title='branches' data-type='std::unique_ptr&lt;std::vector&lt;BeamEntry *&gt; &gt;' data-ref="83branches">branches</dfn>(<a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::leaves_" title='tensorflow::ctc::CTCBeamSearchDecoder::leaves_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::leaves_">leaves_</a>.Extract());</td></tr>
<tr><th id="188">188</th><td>    <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::leaves_" title='tensorflow::ctc::CTCBeamSearchDecoder::leaves_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::leaves_">leaves_</a>.Reset();</td></tr>
<tr><th id="189">189</th><td>    <b>for</b> (<em>int</em> <dfn class="local col4 decl" id="84i" title='i' data-type='int' data-ref="84i">i</dfn> = <var>0</var>; <a class="local col4 ref" href="#84i" title='i' data-ref="84i">i</a> &lt; <a class="local col3 ref" href="#83branches" title='branches' data-ref="83branches">branches</a>-&gt;size(); ++<a class="local col4 ref" href="#84i" title='i' data-ref="84i">i</a>) {</td></tr>
<tr><th id="190">190</th><td>      <a class="typedef" href="#tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry" title='tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry' data-type='ctc_beam_search::BeamEntry&lt;CTCBeamState&gt;' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry">BeamEntry</a>* <dfn class="local col5 decl" id="85entry" title='entry' data-type='BeamEntry *' data-ref="85entry">entry</dfn> = (*<a class="local col3 ref" href="#83branches" title='branches' data-ref="83branches">branches</a>)[<a class="local col4 ref" href="#84i" title='i' data-ref="84i">i</a>];</td></tr>
<tr><th id="191">191</th><td>      <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_" title='tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_">beam_scorer_</a>-&gt;ExpandStateEnd(&amp;<a class="local col5 ref" href="#85entry" title='entry' data-ref="85entry">entry</a>-&gt;state);</td></tr>
<tr><th id="192">192</th><td>      <a class="local col5 ref" href="#85entry" title='entry' data-ref="85entry">entry</a>-&gt;newp.total +=</td></tr>
<tr><th id="193">193</th><td>          <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_" title='tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_">beam_scorer_</a>-&gt;GetStateEndExpansionScore(<a class="local col5 ref" href="#85entry" title='entry' data-ref="85entry">entry</a>-&gt;state);</td></tr>
<tr><th id="194">194</th><td>      <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::leaves_" title='tensorflow::ctc::CTCBeamSearchDecoder::leaves_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::leaves_">leaves_</a>.push(<a class="local col5 ref" href="#85entry" title='entry' data-ref="85entry">entry</a>);</td></tr>
<tr><th id="195">195</th><td>    }</td></tr>
<tr><th id="196">196</th><td></td></tr>
<tr><th id="197">197</th><td>    <a class="type" href="../../lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a> <dfn class="local col6 decl" id="86status" title='status' data-type='tensorflow::Status' data-ref="86status">status</dfn> =</td></tr>
<tr><th id="198">198</th><td>        <a class="member" href="#_ZNK10tensorflow3ctc20CTCBeamSearchDecoder8TopPathsEiPSt6vectorIS2_IiSaIiEESaIS4_EEPS2_IfSaIfEEb" title='tensorflow::ctc::CTCBeamSearchDecoder::TopPaths' data-ref="_ZNK10tensorflow3ctc20CTCBeamSearchDecoder8TopPathsEiPSt6vectorIS2_IiSaIiEESaIS4_EEPS2_IfSaIfEEb">TopPaths</a>(<a class="local col8 ref" href="#78top_n" title='top_n' data-ref="78top_n">top_n</a>, &amp;<a class="local col6 ref" href="#76beams" title='beams' data-ref="76beams">beams</a>, &amp;<a class="local col7 ref" href="#77beam_log_probabilities" title='beam_log_probabilities' data-ref="77beam_log_probabilities">beam_log_probabilities</a>, <a class="member" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder::merge_repeated_" title='tensorflow::ctc::CTCDecoder::merge_repeated_' data-ref="tensorflow::ctc::CTCDecoder::merge_repeated_">merge_repeated_</a>);</td></tr>
<tr><th id="199">199</th><td>    <b>if</b> (!<a class="local col6 ref" href="#86status" title='status' data-ref="86status">status</a>.<a class="ref" href="../../lib/core/status.h.html#_ZNK10tensorflow6Status2okEv" title='tensorflow::Status::ok' data-ref="_ZNK10tensorflow6Status2okEv">ok</a>()) {</td></tr>
<tr><th id="200">200</th><td>      <b>return</b> <a class="local col6 ref" href="#86status" title='status' data-ref="86status">status</a>;</td></tr>
<tr><th id="201">201</th><td>    }</td></tr>
<tr><th id="202">202</th><td></td></tr>
<tr><th id="203">203</th><td>    <a class="macro" href="../../platform/default/logging.h.html#251" title="while (::tensorflow::internal::CheckOpString _result = ::tensorflow::internal::Check_EQImpl( ::tensorflow::internal::GetReferenceableValue(top_n), ::tensorflow::internal::GetReferenceableValue(beam_log_probabilities.size()), &quot;top_n&quot; &quot; &quot; &quot;==&quot; &quot; &quot; &quot;beam_log_probabilities.size()&quot;)) ::tensorflow::internal::LogMessageFatal(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/./tensorflow/core/util/ctc/ctc_beam_search.h&quot;, 203) &lt;&lt; *(_result.str_)" data-ref="_M/CHECK_EQ">CHECK_EQ</a>(<a class="local col8 ref" href="#78top_n" title='top_n' data-ref="78top_n">top_n</a>, <a class="local col7 ref" href="#77beam_log_probabilities" title='beam_log_probabilities' data-ref="77beam_log_probabilities">beam_log_probabilities</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNKSt6vector4sizeEv" title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv">size</a>());</td></tr>
<tr><th id="204">204</th><td>    <a class="macro" href="../../platform/default/logging.h.html#251" title="while (::tensorflow::internal::CheckOpString _result = ::tensorflow::internal::Check_EQImpl( ::tensorflow::internal::GetReferenceableValue(beams.size()), ::tensorflow::internal::GetReferenceableValue(beam_log_probabilities.size()), &quot;beams.size()&quot; &quot; &quot; &quot;==&quot; &quot; &quot; &quot;beam_log_probabilities.size()&quot;)) ::tensorflow::internal::LogMessageFatal(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/./tensorflow/core/util/ctc/ctc_beam_search.h&quot;, 204) &lt;&lt; *(_result.str_)" data-ref="_M/CHECK_EQ">CHECK_EQ</a>(<a class="local col6 ref" href="#76beams" title='beams' data-ref="76beams">beams</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNKSt6vector4sizeEv" title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv">size</a>(), <a class="local col7 ref" href="#77beam_log_probabilities" title='beam_log_probabilities' data-ref="77beam_log_probabilities">beam_log_probabilities</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNKSt6vector4sizeEv" title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv">size</a>());</td></tr>
<tr><th id="205">205</th><td></td></tr>
<tr><th id="206">206</th><td>    <b>for</b> (<em>int</em> <dfn class="local col7 decl" id="87i" title='i' data-type='int' data-ref="87i">i</dfn> = <var>0</var>; <a class="local col7 ref" href="#87i" title='i' data-ref="87i">i</a> &lt; <a class="local col8 ref" href="#78top_n" title='top_n' data-ref="78top_n">top_n</a>; ++<a class="local col7 ref" href="#87i" title='i' data-ref="87i">i</a>) {</td></tr>
<tr><th id="207">207</th><td>      <i>// Copy output to the correct beam + batch</i></td></tr>
<tr><th id="208">208</th><td>      (*<a class="local col4 ref" href="#74output" title='output' data-ref="74output">output</a>)<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorixEm" title='std::vector::operator[]' data-ref="_ZNSt6vectorixEm">[<a class="local col7 ref" href="#87i" title='i' data-ref="87i">i</a>]</a><a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorixEm" title='std::vector::operator[]' data-ref="_ZNSt6vectorixEm">[<a class="local col0 ref" href="#80b" title='b' data-ref="80b">b</a>]</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vector4swapERSt6vectorIT_T0_E" title='std::vector::swap' data-ref="_ZNSt6vector4swapERSt6vectorIT_T0_E">swap</a>(<span class='refarg'><a class="local col6 ref" href="#76beams" title='beams' data-ref="76beams">beams</a><a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorixEm" title='std::vector::operator[]' data-ref="_ZNSt6vectorixEm">[<a class="local col7 ref" href="#87i" title='i' data-ref="87i">i</a>]</a></span>);</td></tr>
<tr><th id="209">209</th><td>      (*<a class="local col5 ref" href="#75scores" title='scores' data-ref="75scores">scores</a>)<span class='ref' title='Eigen::DenseCoeffsBase&lt;type-parameter-0-0, 1&gt;::operator()' data-ref="_ZN5Eigen15DenseCoeffsBaseIT_Li1EEclEll">(<a class="local col0 ref" href="#80b" title='b' data-ref="80b">b</a>, <a class="local col7 ref" href="#87i" title='i' data-ref="87i">i</a>)</span> = -<a class="local col7 ref" href="#77beam_log_probabilities" title='beam_log_probabilities' data-ref="77beam_log_probabilities">beam_log_probabilities</a><a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorixEm" title='std::vector::operator[]' data-ref="_ZNSt6vectorixEm">[<a class="local col7 ref" href="#87i" title='i' data-ref="87i">i</a>]</a>;</td></tr>
<tr><th id="210">210</th><td>    }</td></tr>
<tr><th id="211">211</th><td>  }  <i>// for (int b...</i></td></tr>
<tr><th id="212">212</th><td>  <b>return</b> <a class="type" href="../../lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a>::<a class="ref" href="../../lib/core/status.h.html#_ZN10tensorflow6Status2OKEv" title='tensorflow::Status::OK' data-ref="_ZN10tensorflow6Status2OKEv">OK</a>();</td></tr>
<tr><th id="213">213</th><td>}</td></tr>
<tr><th id="214">214</th><td></td></tr>
<tr><th id="215">215</th><td><b>template</b> &lt;<b>typename</b> CTCBeamState, <b>typename</b> CTCBeamComparer&gt;</td></tr>
<tr><th id="216">216</th><td><b>template</b> &lt;<b>typename</b> Vector&gt;</td></tr>
<tr><th id="217">217</th><td><em>float</em> <a class="type" href="#tensorflow::ctc::CTCBeamSearchDecoder" title='tensorflow::ctc::CTCBeamSearchDecoder' data-ref="tensorflow::ctc::CTCBeamSearchDecoder">CTCBeamSearchDecoder</a>&lt;CTCBeamState, CTCBeamComparer&gt;::<dfn class="decl def" id="_ZN10tensorflow3ctc20CTCBeamSearchDecoder7GetTopKEiRKT_PSt6vectorIfSaIfEEPS5_IiSaIiEE" title='tensorflow::ctc::CTCBeamSearchDecoder::GetTopK' data-ref="_ZN10tensorflow3ctc20CTCBeamSearchDecoder7GetTopKEiRKT_PSt6vectorIfSaIfEEPS5_IiSaIiEE">GetTopK</dfn>(</td></tr>
<tr><th id="218">218</th><td>    <em>const</em> <em>int</em> <dfn class="local col8 decl" id="88K" title='K' data-type='const int' data-ref="88K">K</dfn>, <em>const</em> Vector&amp; <dfn class="local col9 decl" id="89input" title='input' data-type='const Vector &amp;' data-ref="89input">input</dfn>, <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<em>float</em>&gt;* <dfn class="local col0 decl" id="90top_k_logits" title='top_k_logits' data-type='std::vector&lt;float&gt; *' data-ref="90top_k_logits">top_k_logits</dfn>,</td></tr>
<tr><th id="219">219</th><td>    <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<em>int</em>&gt;* <dfn class="local col1 decl" id="91top_k_indices" title='top_k_indices' data-type='std::vector&lt;int&gt; *' data-ref="91top_k_indices">top_k_indices</dfn>) {</td></tr>
<tr><th id="220">220</th><td>  <i>// Find Top K choices, complexity nk in worst case. The array input is read</i></td></tr>
<tr><th id="221">221</th><td><i>  // just once.</i></td></tr>
<tr><th id="222">222</th><td>  <a class="macro" href="../../platform/default/logging.h.html#251" title="while (::tensorflow::internal::CheckOpString _result = ::tensorflow::internal::Check_EQImpl( ::tensorflow::internal::GetReferenceableValue(num_classes_), ::tensorflow::internal::GetReferenceableValue(input.size()), &quot;num_classes_&quot; &quot; &quot; &quot;==&quot; &quot; &quot; &quot;input.size()&quot;)) ::tensorflow::internal::LogMessageFatal(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/./tensorflow/core/util/ctc/ctc_beam_search.h&quot;, 222) &lt;&lt; *(_result.str_)" data-ref="_M/CHECK_EQ">CHECK_EQ</a>(<a class="member" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder::num_classes_" title='tensorflow::ctc::CTCDecoder::num_classes_' data-ref="tensorflow::ctc::CTCDecoder::num_classes_">num_classes_</a>, <a class="local col9 ref" href="#89input" title='input' data-ref="89input">input</a>.size());</td></tr>
<tr><th id="223">223</th><td>  <a class="local col0 ref" href="#90top_k_logits" title='top_k_logits' data-ref="90top_k_logits">top_k_logits</a>-&gt;<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vector5clearEv" title='std::vector::clear' data-ref="_ZNSt6vector5clearEv">clear</a>();</td></tr>
<tr><th id="224">224</th><td>  <a class="local col1 ref" href="#91top_k_indices" title='top_k_indices' data-ref="91top_k_indices">top_k_indices</a>-&gt;<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vector5clearEv" title='std::vector::clear' data-ref="_ZNSt6vector5clearEv">clear</a>();</td></tr>
<tr><th id="225">225</th><td>  <a class="local col0 ref" href="#90top_k_logits" title='top_k_logits' data-ref="90top_k_logits">top_k_logits</a>-&gt;<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vector6resizeEmRKT_" title='std::vector::resize' data-ref="_ZNSt6vector6resizeEmRKT_">resize</a>(<a class="local col8 ref" href="#88K" title='K' data-ref="88K">K</a>, -<a class="macro" href="../../../../../include/x86_64-linux-gnu/bits/inf.h.html#26" title="(__builtin_inff())" data-ref="_M/INFINITY">INFINITY</a>);</td></tr>
<tr><th id="226">226</th><td>  <a class="local col1 ref" href="#91top_k_indices" title='top_k_indices' data-ref="91top_k_indices">top_k_indices</a>-&gt;<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vector6resizeEmRKT_" title='std::vector::resize' data-ref="_ZNSt6vector6resizeEmRKT_">resize</a>(<a class="local col8 ref" href="#88K" title='K' data-ref="88K">K</a>, -<var>1</var>);</td></tr>
<tr><th id="227">227</th><td>  <b>for</b> (<em>int</em> <dfn class="local col2 decl" id="92j" title='j' data-type='int' data-ref="92j">j</dfn> = <var>0</var>; <a class="local col2 ref" href="#92j" title='j' data-ref="92j">j</a> &lt; <a class="member" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder::num_classes_" title='tensorflow::ctc::CTCDecoder::num_classes_' data-ref="tensorflow::ctc::CTCDecoder::num_classes_">num_classes_</a> - <var>1</var>; ++<a class="local col2 ref" href="#92j" title='j' data-ref="92j">j</a>) {</td></tr>
<tr><th id="228">228</th><td>    <em>const</em> <em>float</em> <dfn class="local col3 decl" id="93logit" title='logit' data-type='const float' data-ref="93logit">logit</dfn> = <a class="local col9 ref" href="#89input" title='input' data-ref="89input">input</a>(<a class="local col2 ref" href="#92j" title='j' data-ref="92j">j</a>);</td></tr>
<tr><th id="229">229</th><td>    <b>if</b> (<a class="local col3 ref" href="#93logit" title='logit' data-ref="93logit">logit</a> &gt; (*<a class="local col0 ref" href="#90top_k_logits" title='top_k_logits' data-ref="90top_k_logits">top_k_logits</a>)<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorixEm" title='std::vector::operator[]' data-ref="_ZNSt6vectorixEm">[<a class="local col8 ref" href="#88K" title='K' data-ref="88K">K</a> - <var>1</var>]</a>) {</td></tr>
<tr><th id="230">230</th><td>      <em>int</em> <dfn class="local col4 decl" id="94k" title='k' data-type='int' data-ref="94k">k</dfn> = <a class="local col8 ref" href="#88K" title='K' data-ref="88K">K</a> - <var>1</var>;</td></tr>
<tr><th id="231">231</th><td>      <b>while</b> (<a class="local col4 ref" href="#94k" title='k' data-ref="94k">k</a> &gt; <var>0</var> &amp;&amp; <a class="local col3 ref" href="#93logit" title='logit' data-ref="93logit">logit</a> &gt; (*<a class="local col0 ref" href="#90top_k_logits" title='top_k_logits' data-ref="90top_k_logits">top_k_logits</a>)<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorixEm" title='std::vector::operator[]' data-ref="_ZNSt6vectorixEm">[<a class="local col4 ref" href="#94k" title='k' data-ref="94k">k</a> - <var>1</var>]</a>) {</td></tr>
<tr><th id="232">232</th><td>        (*<a class="local col0 ref" href="#90top_k_logits" title='top_k_logits' data-ref="90top_k_logits">top_k_logits</a>)<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorixEm" title='std::vector::operator[]' data-ref="_ZNSt6vectorixEm">[<a class="local col4 ref" href="#94k" title='k' data-ref="94k">k</a>]</a> = (*<a class="local col0 ref" href="#90top_k_logits" title='top_k_logits' data-ref="90top_k_logits">top_k_logits</a>)<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorixEm" title='std::vector::operator[]' data-ref="_ZNSt6vectorixEm">[<a class="local col4 ref" href="#94k" title='k' data-ref="94k">k</a> - <var>1</var>]</a>;</td></tr>
<tr><th id="233">233</th><td>        (*<a class="local col1 ref" href="#91top_k_indices" title='top_k_indices' data-ref="91top_k_indices">top_k_indices</a>)<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorixEm" title='std::vector::operator[]' data-ref="_ZNSt6vectorixEm">[<a class="local col4 ref" href="#94k" title='k' data-ref="94k">k</a>]</a> = (*<a class="local col1 ref" href="#91top_k_indices" title='top_k_indices' data-ref="91top_k_indices">top_k_indices</a>)<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorixEm" title='std::vector::operator[]' data-ref="_ZNSt6vectorixEm">[<a class="local col4 ref" href="#94k" title='k' data-ref="94k">k</a> - <var>1</var>]</a>;</td></tr>
<tr><th id="234">234</th><td>        <a class="local col4 ref" href="#94k" title='k' data-ref="94k">k</a>--;</td></tr>
<tr><th id="235">235</th><td>      }</td></tr>
<tr><th id="236">236</th><td>      (*<a class="local col0 ref" href="#90top_k_logits" title='top_k_logits' data-ref="90top_k_logits">top_k_logits</a>)<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorixEm" title='std::vector::operator[]' data-ref="_ZNSt6vectorixEm">[<a class="local col4 ref" href="#94k" title='k' data-ref="94k">k</a>]</a> = <a class="local col3 ref" href="#93logit" title='logit' data-ref="93logit">logit</a>;</td></tr>
<tr><th id="237">237</th><td>      (*<a class="local col1 ref" href="#91top_k_indices" title='top_k_indices' data-ref="91top_k_indices">top_k_indices</a>)<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorixEm" title='std::vector::operator[]' data-ref="_ZNSt6vectorixEm">[<a class="local col4 ref" href="#94k" title='k' data-ref="94k">k</a>]</a> = <a class="local col2 ref" href="#92j" title='j' data-ref="92j">j</a>;</td></tr>
<tr><th id="238">238</th><td>    }</td></tr>
<tr><th id="239">239</th><td>  }</td></tr>
<tr><th id="240">240</th><td>  <i>// Return max value which is in 0th index or blank character logit</i></td></tr>
<tr><th id="241">241</th><td>  <b>return</b> <span class="namespace">std::</span>max((*<a class="local col0 ref" href="#90top_k_logits" title='top_k_logits' data-ref="90top_k_logits">top_k_logits</a>)<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorixEm" title='std::vector::operator[]' data-ref="_ZNSt6vectorixEm">[<var>0</var>]</a>, <a class="local col9 ref" href="#89input" title='input' data-ref="89input">input</a>(<a class="member" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder::num_classes_" title='tensorflow::ctc::CTCDecoder::num_classes_' data-ref="tensorflow::ctc::CTCDecoder::num_classes_">num_classes_</a> - <var>1</var>));</td></tr>
<tr><th id="242">242</th><td>}</td></tr>
<tr><th id="243">243</th><td></td></tr>
<tr><th id="244">244</th><td><b>template</b> &lt;<b>typename</b> CTCBeamState, <b>typename</b> CTCBeamComparer&gt;</td></tr>
<tr><th id="245">245</th><td><b>template</b> &lt;<b>typename</b> Vector&gt;</td></tr>
<tr><th id="246">246</th><td><em>void</em> <a class="type" href="#tensorflow::ctc::CTCBeamSearchDecoder" title='tensorflow::ctc::CTCBeamSearchDecoder' data-ref="tensorflow::ctc::CTCBeamSearchDecoder">CTCBeamSearchDecoder</a>&lt;CTCBeamState, CTCBeamComparer&gt;::<dfn class="decl def" id="_ZN10tensorflow3ctc20CTCBeamSearchDecoder4StepERKT_" title='tensorflow::ctc::CTCBeamSearchDecoder::Step' data-ref="_ZN10tensorflow3ctc20CTCBeamSearchDecoder4StepERKT_">Step</dfn>(</td></tr>
<tr><th id="247">247</th><td>    <em>const</em> Vector&amp; <dfn class="local col5 decl" id="95raw_input" title='raw_input' data-type='const Vector &amp;' data-ref="95raw_input">raw_input</dfn>) {</td></tr>
<tr><th id="248">248</th><td>  <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<em>float</em>&gt; <a class="ref fake" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorC1Ev" title='std::vector::vector&lt;_Tp, _Alloc&gt;' data-ref="_ZNSt6vectorC1Ev"></a><dfn class="local col6 decl" id="96top_k_logits" title='top_k_logits' data-type='std::vector&lt;float&gt;' data-ref="96top_k_logits">top_k_logits</dfn>;</td></tr>
<tr><th id="249">249</th><td>  <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<em>int</em>&gt; <a class="ref fake" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorC1Ev" title='std::vector::vector&lt;_Tp, _Alloc&gt;' data-ref="_ZNSt6vectorC1Ev"></a><dfn class="local col7 decl" id="97top_k_indices" title='top_k_indices' data-type='std::vector&lt;int&gt;' data-ref="97top_k_indices">top_k_indices</dfn>;</td></tr>
<tr><th id="250">250</th><td>  <em>const</em> <em>bool</em> <dfn class="local col8 decl" id="98top_k" title='top_k' data-type='const bool' data-ref="98top_k">top_k</dfn> =</td></tr>
<tr><th id="251">251</th><td>      (<a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::label_selection_size_" title='tensorflow::ctc::CTCBeamSearchDecoder::label_selection_size_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::label_selection_size_">label_selection_size_</a> &gt; <var>0</var> &amp;&amp; <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::label_selection_size_" title='tensorflow::ctc::CTCBeamSearchDecoder::label_selection_size_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::label_selection_size_">label_selection_size_</a> &lt; <a class="local col5 ref" href="#95raw_input" title='raw_input' data-ref="95raw_input">raw_input</a>.size());</td></tr>
<tr><th id="252">252</th><td>  <i>// Number of character classes to consider in each step.</i></td></tr>
<tr><th id="253">253</th><td>  <em>const</em> <em>int</em> <dfn class="local col9 decl" id="99max_classes" title='max_classes' data-type='const int' data-ref="99max_classes">max_classes</dfn> = <a class="local col8 ref" href="#98top_k" title='top_k' data-ref="98top_k">top_k</a> ? <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::label_selection_size_" title='tensorflow::ctc::CTCBeamSearchDecoder::label_selection_size_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::label_selection_size_">label_selection_size_</a> : (<a class="member" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder::num_classes_" title='tensorflow::ctc::CTCDecoder::num_classes_' data-ref="tensorflow::ctc::CTCDecoder::num_classes_">num_classes_</a> - <var>1</var>);</td></tr>
<tr><th id="254">254</th><td>  <i>// Get max coefficient and remove it from raw_input later.</i></td></tr>
<tr><th id="255">255</th><td>  <em>float</em> <dfn class="local col0 decl" id="100max_coeff" title='max_coeff' data-type='float' data-ref="100max_coeff">max_coeff</dfn>;</td></tr>
<tr><th id="256">256</th><td>  <b>if</b> (<a class="local col8 ref" href="#98top_k" title='top_k' data-ref="98top_k">top_k</a>) {</td></tr>
<tr><th id="257">257</th><td>    <a class="local col0 ref" href="#100max_coeff" title='max_coeff' data-ref="100max_coeff">max_coeff</a> = GetTopK(<a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::label_selection_size_" title='tensorflow::ctc::CTCBeamSearchDecoder::label_selection_size_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::label_selection_size_">label_selection_size_</a>, <a class="local col5 ref" href="#95raw_input" title='raw_input' data-ref="95raw_input">raw_input</a>, &amp;<a class="local col6 ref" href="#96top_k_logits" title='top_k_logits' data-ref="96top_k_logits">top_k_logits</a>,</td></tr>
<tr><th id="258">258</th><td>                        &amp;<a class="local col7 ref" href="#97top_k_indices" title='top_k_indices' data-ref="97top_k_indices">top_k_indices</a>);</td></tr>
<tr><th id="259">259</th><td>  } <b>else</b> {</td></tr>
<tr><th id="260">260</th><td>    <a class="local col0 ref" href="#100max_coeff" title='max_coeff' data-ref="100max_coeff">max_coeff</a> = <a class="local col5 ref" href="#95raw_input" title='raw_input' data-ref="95raw_input">raw_input</a>.maxCoeff();</td></tr>
<tr><th id="261">261</th><td>  }</td></tr>
<tr><th id="262">262</th><td>  <em>const</em> <em>float</em> <dfn class="local col1 decl" id="101label_selection_input_min" title='label_selection_input_min' data-type='const float' data-ref="101label_selection_input_min">label_selection_input_min</dfn> =</td></tr>
<tr><th id="263">263</th><td>      (<a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::label_selection_margin_" title='tensorflow::ctc::CTCBeamSearchDecoder::label_selection_margin_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::label_selection_margin_">label_selection_margin_</a> &gt;= <var>0</var>) ? (<a class="local col0 ref" href="#100max_coeff" title='max_coeff' data-ref="100max_coeff">max_coeff</a> - <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::label_selection_margin_" title='tensorflow::ctc::CTCBeamSearchDecoder::label_selection_margin_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::label_selection_margin_">label_selection_margin_</a>)</td></tr>
<tr><th id="264">264</th><td>                                     : -<span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/limits.html#std::numeric_limits" title='std::numeric_limits' data-ref="std::numeric_limits">numeric_limits</a>&lt;<em>float</em>&gt;::<a class="ref" href="../../../../../include/c++/5/limits.html#_ZNSt14numeric_limitsIfE8infinityEv" title='std::numeric_limits&lt;float&gt;::infinity' data-ref="_ZNSt14numeric_limitsIfE8infinityEv">infinity</a>();</td></tr>
<tr><th id="265">265</th><td></td></tr>
<tr><th id="266">266</th><td>  <i>// Extract the beams sorted in decreasing new probability</i></td></tr>
<tr><th id="267">267</th><td>  <a class="macro" href="../../platform/default/logging.h.html#251" title="while (::tensorflow::internal::CheckOpString _result = ::tensorflow::internal::Check_EQImpl( ::tensorflow::internal::GetReferenceableValue(num_classes_), ::tensorflow::internal::GetReferenceableValue(raw_input.size()), &quot;num_classes_&quot; &quot; &quot; &quot;==&quot; &quot; &quot; &quot;raw_input.size()&quot;)) ::tensorflow::internal::LogMessageFatal(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/./tensorflow/core/util/ctc/ctc_beam_search.h&quot;, 267) &lt;&lt; *(_result.str_)" data-ref="_M/CHECK_EQ">CHECK_EQ</a>(<a class="member" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder::num_classes_" title='tensorflow::ctc::CTCDecoder::num_classes_' data-ref="tensorflow::ctc::CTCDecoder::num_classes_">num_classes_</a>, <a class="local col5 ref" href="#95raw_input" title='raw_input' data-ref="95raw_input">raw_input</a>.size());</td></tr>
<tr><th id="268">268</th><td></td></tr>
<tr><th id="269">269</th><td>  <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/unique_ptr.h.html#std::unique_ptr" title='std::unique_ptr' data-ref="std::unique_ptr">unique_ptr</a>&lt;<span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<a class="typedef" href="#tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry" title='tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry' data-type='ctc_beam_search::BeamEntry&lt;CTCBeamState&gt;' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry">BeamEntry</a>*&gt;&gt; <dfn class="local col2 decl" id="102branches" title='branches' data-type='std::unique_ptr&lt;std::vector&lt;BeamEntry *&gt; &gt;' data-ref="102branches">branches</dfn>(<a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::leaves_" title='tensorflow::ctc::CTCBeamSearchDecoder::leaves_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::leaves_">leaves_</a>.Extract());</td></tr>
<tr><th id="270">270</th><td>  <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::leaves_" title='tensorflow::ctc::CTCBeamSearchDecoder::leaves_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::leaves_">leaves_</a>.Reset();</td></tr>
<tr><th id="271">271</th><td></td></tr>
<tr><th id="272">272</th><td>  <b>for</b> (<a class="typedef" href="#tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry" title='tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry' data-type='ctc_beam_search::BeamEntry&lt;CTCBeamState&gt;' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry">BeamEntry</a>* <dfn class="local col3 decl" id="103b" title='b' data-type='BeamEntry *' data-ref="103b">b</dfn> : *<a class="local col2 ref" href="#102branches" title='branches' data-ref="102branches">branches</a>) {</td></tr>
<tr><th id="273">273</th><td>    <i>// P(.. @ t) becomes the new P(.. @ t-1)</i></td></tr>
<tr><th id="274">274</th><td>    <a class="local col3 ref" href="#103b" title='b' data-ref="103b">b</a>-&gt;oldp = <a class="local col3 ref" href="#103b" title='b' data-ref="103b">b</a>-&gt;newp;</td></tr>
<tr><th id="275">275</th><td>  }</td></tr>
<tr><th id="276">276</th><td></td></tr>
<tr><th id="277">277</th><td>  <b>for</b> (<a class="typedef" href="#tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry" title='tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry' data-type='ctc_beam_search::BeamEntry&lt;CTCBeamState&gt;' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry">BeamEntry</a>* <dfn class="local col4 decl" id="104b" title='b' data-type='BeamEntry *' data-ref="104b">b</dfn> : *<a class="local col2 ref" href="#102branches" title='branches' data-ref="102branches">branches</a>) {</td></tr>
<tr><th id="278">278</th><td>    <b>if</b> (<a class="local col4 ref" href="#104b" title='b' data-ref="104b">b</a>-&gt;parent != <b>nullptr</b>) {  <i>// if not the root</i></td></tr>
<tr><th id="279">279</th><td>      <b>if</b> (<a class="local col4 ref" href="#104b" title='b' data-ref="104b">b</a>-&gt;parent-&gt;Active()) {</td></tr>
<tr><th id="280">280</th><td>        <i>// If last two sequence characters are identical:</i></td></tr>
<tr><th id="281">281</th><td><i>        //   Plabel(l=acc @ t=6) = (Plabel(l=acc @ t=5)</i></td></tr>
<tr><th id="282">282</th><td><i>        //                          + Pblank(l=ac @ t=5))</i></td></tr>
<tr><th id="283">283</th><td><i>        // else:</i></td></tr>
<tr><th id="284">284</th><td><i>        //   Plabel(l=abc @ t=6) = (Plabel(l=abc @ t=5)</i></td></tr>
<tr><th id="285">285</th><td><i>        //                          + P(l=ab @ t=5))</i></td></tr>
<tr><th id="286">286</th><td>        <em>float</em> <dfn class="local col5 decl" id="105previous" title='previous' data-type='float' data-ref="105previous">previous</dfn> = (<a class="local col4 ref" href="#104b" title='b' data-ref="104b">b</a>-&gt;label == <a class="local col4 ref" href="#104b" title='b' data-ref="104b">b</a>-&gt;parent-&gt;label) ? <a class="local col4 ref" href="#104b" title='b' data-ref="104b">b</a>-&gt;parent-&gt;oldp.blank</td></tr>
<tr><th id="287">287</th><td>                                                        : <a class="local col4 ref" href="#104b" title='b' data-ref="104b">b</a>-&gt;parent-&gt;oldp.total;</td></tr>
<tr><th id="288">288</th><td>        <a class="local col4 ref" href="#104b" title='b' data-ref="104b">b</a>-&gt;newp.label =</td></tr>
<tr><th id="289">289</th><td>            LogSumExp(<a class="local col4 ref" href="#104b" title='b' data-ref="104b">b</a>-&gt;newp.label,</td></tr>
<tr><th id="290">290</th><td>                      <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_" title='tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_">beam_scorer_</a>-&gt;GetStateExpansionScore(<a class="local col4 ref" href="#104b" title='b' data-ref="104b">b</a>-&gt;state, <a class="local col5 ref" href="#105previous" title='previous' data-ref="105previous">previous</a>));</td></tr>
<tr><th id="291">291</th><td>      }</td></tr>
<tr><th id="292">292</th><td>      <i>// Plabel(l=abc @ t=6) *= P(c @ 6)</i></td></tr>
<tr><th id="293">293</th><td>      <a class="local col4 ref" href="#104b" title='b' data-ref="104b">b</a>-&gt;newp.label += <a class="local col5 ref" href="#95raw_input" title='raw_input' data-ref="95raw_input">raw_input</a>(<a class="local col4 ref" href="#104b" title='b' data-ref="104b">b</a>-&gt;label) - <a class="local col0 ref" href="#100max_coeff" title='max_coeff' data-ref="100max_coeff">max_coeff</a>;</td></tr>
<tr><th id="294">294</th><td>    }</td></tr>
<tr><th id="295">295</th><td>    <i>// Pblank(l=abc @ t=6) = P(l=abc @ t=5) * P(- @ 6)</i></td></tr>
<tr><th id="296">296</th><td>    <a class="local col4 ref" href="#104b" title='b' data-ref="104b">b</a>-&gt;newp.blank = <a class="local col4 ref" href="#104b" title='b' data-ref="104b">b</a>-&gt;oldp.total + <a class="local col5 ref" href="#95raw_input" title='raw_input' data-ref="95raw_input">raw_input</a>(<a class="member" href="ctc_decoder.h.html#tensorflow::ctc::CTCDecoder::blank_index_" title='tensorflow::ctc::CTCDecoder::blank_index_' data-ref="tensorflow::ctc::CTCDecoder::blank_index_">blank_index_</a>) - <a class="local col0 ref" href="#100max_coeff" title='max_coeff' data-ref="100max_coeff">max_coeff</a>;</td></tr>
<tr><th id="297">297</th><td>    <i>// P(l=abc @ t=6) = Plabel(l=abc @ t=6) + Pblank(l=abc @ t=6)</i></td></tr>
<tr><th id="298">298</th><td>    <a class="local col4 ref" href="#104b" title='b' data-ref="104b">b</a>-&gt;newp.total = LogSumExp(<a class="local col4 ref" href="#104b" title='b' data-ref="104b">b</a>-&gt;newp.blank, <a class="local col4 ref" href="#104b" title='b' data-ref="104b">b</a>-&gt;newp.label);</td></tr>
<tr><th id="299">299</th><td></td></tr>
<tr><th id="300">300</th><td>    <i>// Push the entry back to the top paths list.</i></td></tr>
<tr><th id="301">301</th><td><i>    // Note, this will always fill leaves back up in sorted order.</i></td></tr>
<tr><th id="302">302</th><td>    <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::leaves_" title='tensorflow::ctc::CTCBeamSearchDecoder::leaves_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::leaves_">leaves_</a>.push(<a class="local col4 ref" href="#104b" title='b' data-ref="104b">b</a>);</td></tr>
<tr><th id="303">303</th><td>  }</td></tr>
<tr><th id="304">304</th><td></td></tr>
<tr><th id="305">305</th><td>  <i>// we need to resort branches in descending oldp order.</i></td></tr>
<tr><th id="306">306</th><td><i></i></td></tr>
<tr><th id="307">307</th><td><i>  // branches is in descending oldp order because it was</i></td></tr>
<tr><th id="308">308</th><td><i>  // originally in descending newp order and we copied newp to oldp.</i></td></tr>
<tr><th id="309">309</th><td><i></i></td></tr>
<tr><th id="310">310</th><td><i>  // Grow new leaves</i></td></tr>
<tr><th id="311">311</th><td>  <b>for</b> (<a class="typedef" href="#tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry" title='tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry' data-type='ctc_beam_search::BeamEntry&lt;CTCBeamState&gt;' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry">BeamEntry</a>* <dfn class="local col6 decl" id="106b" title='b' data-type='BeamEntry *' data-ref="106b">b</dfn> : *<a class="local col2 ref" href="#102branches" title='branches' data-ref="102branches">branches</a>) {</td></tr>
<tr><th id="312">312</th><td>    <i>// A new leaf (represented by its BeamProbability) is a candidate</i></td></tr>
<tr><th id="313">313</th><td><i>    // iff its total probability is nonzero and either the beam list</i></td></tr>
<tr><th id="314">314</th><td><i>    // isn't full, or the lowest probability entry in the beam has a</i></td></tr>
<tr><th id="315">315</th><td><i>    // lower probability than the leaf.</i></td></tr>
<tr><th id="316">316</th><td>    <em>auto</em> <dfn class="local col7 decl" id="107is_candidate" title='is_candidate' data-type='auto' data-ref="107is_candidate">is_candidate</dfn> = [<b>this</b>](<em>const</em> <a class="typedef" href="#tensorflow::ctc::CTCBeamSearchDecoder::BeamProbability" title='tensorflow::ctc::CTCBeamSearchDecoder::BeamProbability' data-type='ctc_beam_search::BeamProbability' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::BeamProbability">BeamProbability</a>&amp; <dfn class="local col8 decl" id="108prob" title='prob' data-type='const BeamProbability &amp;' data-ref="108prob">prob</dfn>) {</td></tr>
<tr><th id="317">317</th><td>      <b>return</b> (<a class="local col8 ref" href="#108prob" title='prob' data-ref="108prob">prob</a>.<a class="ref" href="ctc_beam_entry.h.html#tensorflow::ctc::ctc_beam_search::BeamProbability::total" title='tensorflow::ctc::ctc_beam_search::BeamProbability::total' data-ref="tensorflow::ctc::ctc_beam_search::BeamProbability::total">total</a> &gt; <a class="ref" href="ctc_loss_util.h.html#tensorflow::ctc::kLogZero" title='tensorflow::ctc::kLogZero' data-ref="tensorflow::ctc::kLogZero">kLogZero</a> &amp;&amp;</td></tr>
<tr><th id="318">318</th><td>              (<a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::leaves_" title='tensorflow::ctc::CTCBeamSearchDecoder::leaves_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::leaves_">leaves_</a>.size() &lt; <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::beam_width_" title='tensorflow::ctc::CTCBeamSearchDecoder::beam_width_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::beam_width_">beam_width_</a> ||</td></tr>
<tr><th id="319">319</th><td>               <a class="local col8 ref" href="#108prob" title='prob' data-ref="108prob">prob</a>.<a class="ref" href="ctc_beam_entry.h.html#tensorflow::ctc::ctc_beam_search::BeamProbability::total" title='tensorflow::ctc::ctc_beam_search::BeamProbability::total' data-ref="tensorflow::ctc::ctc_beam_search::BeamProbability::total">total</a> &gt; <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::leaves_" title='tensorflow::ctc::CTCBeamSearchDecoder::leaves_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::leaves_">leaves_</a>.peek_bottom()-&gt;newp.total));</td></tr>
<tr><th id="320">320</th><td>    };</td></tr>
<tr><th id="321">321</th><td></td></tr>
<tr><th id="322">322</th><td>    <b>if</b> (!<a class="local col7 ref" href="#107is_candidate" title='is_candidate' data-ref="107is_candidate">is_candidate</a>(<a class="local col6 ref" href="#106b" title='b' data-ref="106b">b</a>-&gt;oldp)) {</td></tr>
<tr><th id="323">323</th><td>      <b>continue</b>;</td></tr>
<tr><th id="324">324</th><td>    }</td></tr>
<tr><th id="325">325</th><td></td></tr>
<tr><th id="326">326</th><td>    <b>for</b> (<em>int</em> <dfn class="local col9 decl" id="109ind" title='ind' data-type='int' data-ref="109ind">ind</dfn> = <var>0</var>; <a class="local col9 ref" href="#109ind" title='ind' data-ref="109ind">ind</a> &lt; <a class="local col9 ref" href="#99max_classes" title='max_classes' data-ref="99max_classes">max_classes</a>; <a class="local col9 ref" href="#109ind" title='ind' data-ref="109ind">ind</a>++) {</td></tr>
<tr><th id="327">327</th><td>      <em>const</em> <em>int</em> <dfn class="local col0 decl" id="110label" title='label' data-type='const int' data-ref="110label">label</dfn> = <a class="local col8 ref" href="#98top_k" title='top_k' data-ref="98top_k">top_k</a> ? <a class="local col7 ref" href="#97top_k_indices" title='top_k_indices' data-ref="97top_k_indices">top_k_indices</a><a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorixEm" title='std::vector::operator[]' data-ref="_ZNSt6vectorixEm">[<a class="local col9 ref" href="#109ind" title='ind' data-ref="109ind">ind</a>]</a> : <a class="local col9 ref" href="#109ind" title='ind' data-ref="109ind">ind</a>;</td></tr>
<tr><th id="328">328</th><td>      <em>const</em> <em>float</em> <dfn class="local col1 decl" id="111logit" title='logit' data-type='const float' data-ref="111logit">logit</dfn> = <a class="local col8 ref" href="#98top_k" title='top_k' data-ref="98top_k">top_k</a> ? <a class="local col6 ref" href="#96top_k_logits" title='top_k_logits' data-ref="96top_k_logits">top_k_logits</a><a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorixEm" title='std::vector::operator[]' data-ref="_ZNSt6vectorixEm">[<a class="local col9 ref" href="#109ind" title='ind' data-ref="109ind">ind</a>]</a> : <a class="local col5 ref" href="#95raw_input" title='raw_input' data-ref="95raw_input">raw_input</a>(<a class="local col9 ref" href="#109ind" title='ind' data-ref="109ind">ind</a>);</td></tr>
<tr><th id="329">329</th><td>      <i>// Perform label selection: if input for this label looks very</i></td></tr>
<tr><th id="330">330</th><td><i>      // unpromising, never evaluate it with a scorer.</i></td></tr>
<tr><th id="331">331</th><td>      <b>if</b> (<a class="local col1 ref" href="#111logit" title='logit' data-ref="111logit">logit</a> &lt; <a class="local col1 ref" href="#101label_selection_input_min" title='label_selection_input_min' data-ref="101label_selection_input_min">label_selection_input_min</a>) {</td></tr>
<tr><th id="332">332</th><td>        <b>continue</b>;</td></tr>
<tr><th id="333">333</th><td>      }</td></tr>
<tr><th id="334">334</th><td>      <a class="typedef" href="#tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry" title='tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry' data-type='ctc_beam_search::BeamEntry&lt;CTCBeamState&gt;' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry">BeamEntry</a>&amp; <dfn class="local col2 decl" id="112c" title='c' data-type='BeamEntry &amp;' data-ref="112c">c</dfn> = <a class="local col6 ref" href="#106b" title='b' data-ref="106b">b</a>-&gt;GetChild(<a class="local col0 ref" href="#110label" title='label' data-ref="110label">label</a>);</td></tr>
<tr><th id="335">335</th><td>      <b>if</b> (!<a class="local col2 ref" href="#112c" title='c' data-ref="112c">c</a>.Active()) {</td></tr>
<tr><th id="336">336</th><td>        <i>//   Pblank(l=abcd @ t=6) = 0</i></td></tr>
<tr><th id="337">337</th><td>        <a class="local col2 ref" href="#112c" title='c' data-ref="112c">c</a>.newp.blank = <a class="ref" href="ctc_loss_util.h.html#tensorflow::ctc::kLogZero" title='tensorflow::ctc::kLogZero' data-ref="tensorflow::ctc::kLogZero">kLogZero</a>;</td></tr>
<tr><th id="338">338</th><td>        <i>// If new child label is identical to beam label:</i></td></tr>
<tr><th id="339">339</th><td><i>        //   Plabel(l=abcc @ t=6) = Pblank(l=abc @ t=5) * P(c @ 6)</i></td></tr>
<tr><th id="340">340</th><td><i>        // Otherwise:</i></td></tr>
<tr><th id="341">341</th><td><i>        //   Plabel(l=abcd @ t=6) = P(l=abc @ t=5) * P(d @ 6)</i></td></tr>
<tr><th id="342">342</th><td>        <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_" title='tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_">beam_scorer_</a>-&gt;ExpandState(<a class="local col6 ref" href="#106b" title='b' data-ref="106b">b</a>-&gt;state, <a class="local col6 ref" href="#106b" title='b' data-ref="106b">b</a>-&gt;label, &amp;<a class="local col2 ref" href="#112c" title='c' data-ref="112c">c</a>.state, <a class="local col2 ref" href="#112c" title='c' data-ref="112c">c</a>.label);</td></tr>
<tr><th id="343">343</th><td>        <em>float</em> <dfn class="local col3 decl" id="113previous" title='previous' data-type='float' data-ref="113previous">previous</dfn> = (<a class="local col2 ref" href="#112c" title='c' data-ref="112c">c</a>.label == <a class="local col6 ref" href="#106b" title='b' data-ref="106b">b</a>-&gt;label) ? <a class="local col6 ref" href="#106b" title='b' data-ref="106b">b</a>-&gt;oldp.blank : <a class="local col6 ref" href="#106b" title='b' data-ref="106b">b</a>-&gt;oldp.total;</td></tr>
<tr><th id="344">344</th><td>        <a class="local col2 ref" href="#112c" title='c' data-ref="112c">c</a>.newp.label = <a class="local col1 ref" href="#111logit" title='logit' data-ref="111logit">logit</a> - <a class="local col0 ref" href="#100max_coeff" title='max_coeff' data-ref="100max_coeff">max_coeff</a> +</td></tr>
<tr><th id="345">345</th><td>                       <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_" title='tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_">beam_scorer_</a>-&gt;GetStateExpansionScore(<a class="local col2 ref" href="#112c" title='c' data-ref="112c">c</a>.state, <a class="local col3 ref" href="#113previous" title='previous' data-ref="113previous">previous</a>);</td></tr>
<tr><th id="346">346</th><td>        <i>// P(l=abcd @ t=6) = Plabel(l=abcd @ t=6)</i></td></tr>
<tr><th id="347">347</th><td>        <a class="local col2 ref" href="#112c" title='c' data-ref="112c">c</a>.newp.total = <a class="local col2 ref" href="#112c" title='c' data-ref="112c">c</a>.newp.label;</td></tr>
<tr><th id="348">348</th><td></td></tr>
<tr><th id="349">349</th><td>        <b>if</b> (<a class="local col7 ref" href="#107is_candidate" title='is_candidate' data-ref="107is_candidate">is_candidate</a>(<a class="local col2 ref" href="#112c" title='c' data-ref="112c">c</a>.newp)) {</td></tr>
<tr><th id="350">350</th><td>          <i>// Before adding the new node to the beam, check if the beam</i></td></tr>
<tr><th id="351">351</th><td><i>          // is already at maximum width.</i></td></tr>
<tr><th id="352">352</th><td>          <b>if</b> (<a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::leaves_" title='tensorflow::ctc::CTCBeamSearchDecoder::leaves_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::leaves_">leaves_</a>.size() == <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::beam_width_" title='tensorflow::ctc::CTCBeamSearchDecoder::beam_width_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::beam_width_">beam_width_</a>) {</td></tr>
<tr><th id="353">353</th><td>            <i>// Bottom is no longer in the beam search.  Reset</i></td></tr>
<tr><th id="354">354</th><td><i>            // its probability; signal it's no longer in the beam search.</i></td></tr>
<tr><th id="355">355</th><td>            <a class="typedef" href="#tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry" title='tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry' data-type='ctc_beam_search::BeamEntry&lt;CTCBeamState&gt;' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry">BeamEntry</a>* <dfn class="local col4 decl" id="114bottom" title='bottom' data-type='BeamEntry *' data-ref="114bottom">bottom</dfn> = <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::leaves_" title='tensorflow::ctc::CTCBeamSearchDecoder::leaves_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::leaves_">leaves_</a>.peek_bottom();</td></tr>
<tr><th id="356">356</th><td>            <a class="local col4 ref" href="#114bottom" title='bottom' data-ref="114bottom">bottom</a>-&gt;newp.Reset();</td></tr>
<tr><th id="357">357</th><td>          }</td></tr>
<tr><th id="358">358</th><td>          <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::leaves_" title='tensorflow::ctc::CTCBeamSearchDecoder::leaves_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::leaves_">leaves_</a>.push(&amp;<a class="local col2 ref" href="#112c" title='c' data-ref="112c">c</a>);</td></tr>
<tr><th id="359">359</th><td>        } <b>else</b> {</td></tr>
<tr><th id="360">360</th><td>          <i>// Deactivate child.</i></td></tr>
<tr><th id="361">361</th><td>          <a class="local col2 ref" href="#112c" title='c' data-ref="112c">c</a>.oldp.Reset();</td></tr>
<tr><th id="362">362</th><td>          <a class="local col2 ref" href="#112c" title='c' data-ref="112c">c</a>.newp.Reset();</td></tr>
<tr><th id="363">363</th><td>        }</td></tr>
<tr><th id="364">364</th><td>      }</td></tr>
<tr><th id="365">365</th><td>    }</td></tr>
<tr><th id="366">366</th><td>  }  <i>// for (BeamEntry* b...</i></td></tr>
<tr><th id="367">367</th><td>}</td></tr>
<tr><th id="368">368</th><td></td></tr>
<tr><th id="369">369</th><td><b>template</b> &lt;<b>typename</b> CTCBeamState, <b>typename</b> CTCBeamComparer&gt;</td></tr>
<tr><th id="370">370</th><td><em>void</em> <a class="type" href="#tensorflow::ctc::CTCBeamSearchDecoder" title='tensorflow::ctc::CTCBeamSearchDecoder' data-ref="tensorflow::ctc::CTCBeamSearchDecoder">CTCBeamSearchDecoder</a>&lt;CTCBeamState, CTCBeamComparer&gt;::<dfn class="decl def" id="_ZN10tensorflow3ctc20CTCBeamSearchDecoder5ResetEv" title='tensorflow::ctc::CTCBeamSearchDecoder::Reset' data-ref="_ZN10tensorflow3ctc20CTCBeamSearchDecoder5ResetEv">Reset</dfn>() {</td></tr>
<tr><th id="371">371</th><td>  <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::leaves_" title='tensorflow::ctc::CTCBeamSearchDecoder::leaves_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::leaves_">leaves_</a>.Reset();</td></tr>
<tr><th id="372">372</th><td></td></tr>
<tr><th id="373">373</th><td>  <i>// This beam root, and all of its children, will be in memory until</i></td></tr>
<tr><th id="374">374</th><td><i>  // the next reset.</i></td></tr>
<tr><th id="375">375</th><td>  <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::beam_root_" title='tensorflow::ctc::CTCBeamSearchDecoder::beam_root_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::beam_root_">beam_root_</a>.reset(<b>new</b> <a class="typedef" href="#tensorflow::ctc::CTCBeamSearchDecoder::BeamRoot" title='tensorflow::ctc::CTCBeamSearchDecoder::BeamRoot' data-type='ctc_beam_search::BeamRoot&lt;CTCBeamState&gt;' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::BeamRoot">BeamRoot</a>(<b>nullptr</b>, -<var>1</var>));</td></tr>
<tr><th id="376">376</th><td>  <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::beam_root_" title='tensorflow::ctc::CTCBeamSearchDecoder::beam_root_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::beam_root_">beam_root_</a>-&gt;RootEntry()-&gt;newp.total = <var>0.0</var>;  <i>// ln(1)</i></td></tr>
<tr><th id="377">377</th><td>  <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::beam_root_" title='tensorflow::ctc::CTCBeamSearchDecoder::beam_root_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::beam_root_">beam_root_</a>-&gt;RootEntry()-&gt;newp.blank = <var>0.0</var>;  <i>// ln(1)</i></td></tr>
<tr><th id="378">378</th><td></td></tr>
<tr><th id="379">379</th><td>  <i>// Add the root as the initial leaf.</i></td></tr>
<tr><th id="380">380</th><td>  <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::leaves_" title='tensorflow::ctc::CTCBeamSearchDecoder::leaves_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::leaves_">leaves_</a>.push(<a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::beam_root_" title='tensorflow::ctc::CTCBeamSearchDecoder::beam_root_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::beam_root_">beam_root_</a>-&gt;RootEntry());</td></tr>
<tr><th id="381">381</th><td></td></tr>
<tr><th id="382">382</th><td>  <i>// Call initialize state on the root object.</i></td></tr>
<tr><th id="383">383</th><td>  <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_" title='tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::beam_scorer_">beam_scorer_</a>-&gt;InitializeState(&amp;<a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::beam_root_" title='tensorflow::ctc::CTCBeamSearchDecoder::beam_root_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::beam_root_">beam_root_</a>-&gt;RootEntry()-&gt;state);</td></tr>
<tr><th id="384">384</th><td>}</td></tr>
<tr><th id="385">385</th><td></td></tr>
<tr><th id="386">386</th><td><b>template</b> &lt;<b>typename</b> CTCBeamState, <b>typename</b> CTCBeamComparer&gt;</td></tr>
<tr><th id="387">387</th><td><a class="type" href="../../lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a> <a class="type" href="#tensorflow::ctc::CTCBeamSearchDecoder" title='tensorflow::ctc::CTCBeamSearchDecoder' data-ref="tensorflow::ctc::CTCBeamSearchDecoder">CTCBeamSearchDecoder</a>&lt;CTCBeamState, CTCBeamComparer&gt;::<dfn class="decl def" id="_ZNK10tensorflow3ctc20CTCBeamSearchDecoder8TopPathsEiPSt6vectorIS2_IiSaIiEESaIS4_EEPS2_IfSaIfEEb" title='tensorflow::ctc::CTCBeamSearchDecoder::TopPaths' data-ref="_ZNK10tensorflow3ctc20CTCBeamSearchDecoder8TopPathsEiPSt6vectorIS2_IiSaIiEESaIS4_EEPS2_IfSaIfEEb">TopPaths</dfn>(</td></tr>
<tr><th id="388">388</th><td>    <em>int</em> <dfn class="local col5 decl" id="115n" title='n' data-type='int' data-ref="115n">n</dfn>, <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<em>int</em>&gt;&gt;* <dfn class="local col6 decl" id="116paths" title='paths' data-type='std::vector&lt;std::vector&lt;int&gt; &gt; *' data-ref="116paths">paths</dfn>, <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<em>float</em>&gt;* <dfn class="local col7 decl" id="117log_probs" title='log_probs' data-type='std::vector&lt;float&gt; *' data-ref="117log_probs">log_probs</dfn>,</td></tr>
<tr><th id="389">389</th><td>    <em>bool</em> <dfn class="local col8 decl" id="118merge_repeated" title='merge_repeated' data-type='bool' data-ref="118merge_repeated">merge_repeated</dfn>) <em>const</em> {</td></tr>
<tr><th id="390">390</th><td>  <a class="macro" href="../../platform/default/logging.h.html#257" title="::tensorflow::internal::CheckNotNull(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/./tensorflow/core/util/ctc/ctc_beam_search.h&quot;, 390, &quot;&apos;&quot; &quot;paths&quot; &quot;&apos; Must be non NULL&quot;, (paths))" data-ref="_M/CHECK_NOTNULL">CHECK_NOTNULL</a>(<a class="local col6 ref" href="#116paths" title='paths' data-ref="116paths">paths</a>)-&gt;<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vector5clearEv" title='std::vector::clear' data-ref="_ZNSt6vector5clearEv">clear</a>();</td></tr>
<tr><th id="391">391</th><td>  <a class="macro" href="../../platform/default/logging.h.html#257" title="::tensorflow::internal::CheckNotNull(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/./tensorflow/core/util/ctc/ctc_beam_search.h&quot;, 391, &quot;&apos;&quot; &quot;log_probs&quot; &quot;&apos; Must be non NULL&quot;, (log_probs))" data-ref="_M/CHECK_NOTNULL">CHECK_NOTNULL</a>(<a class="local col7 ref" href="#117log_probs" title='log_probs' data-ref="117log_probs">log_probs</a>)-&gt;<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vector5clearEv" title='std::vector::clear' data-ref="_ZNSt6vector5clearEv">clear</a>();</td></tr>
<tr><th id="392">392</th><td>  <b>if</b> (<a class="local col5 ref" href="#115n" title='n' data-ref="115n">n</a> &gt; <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::beam_width_" title='tensorflow::ctc::CTCBeamSearchDecoder::beam_width_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::beam_width_">beam_width_</a>) {</td></tr>
<tr><th id="393">393</th><td>    <b>return</b> <span class="namespace">errors::</span><a class="ref" href="../../lib/core/errors.h.html#103" title='tensorflow::errors::InvalidArgument' data-ref="_ZN10tensorflow6errors15InvalidArgumentEDpT_">InvalidArgument</a>(<q>"requested more paths than the beam width."</q>);</td></tr>
<tr><th id="394">394</th><td>  }</td></tr>
<tr><th id="395">395</th><td>  <b>if</b> (<a class="local col5 ref" href="#115n" title='n' data-ref="115n">n</a> &gt; <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::leaves_" title='tensorflow::ctc::CTCBeamSearchDecoder::leaves_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::leaves_">leaves_</a>.size()) {</td></tr>
<tr><th id="396">396</th><td>    <b>return</b> <span class="namespace">errors::</span><a class="ref" href="../../lib/core/errors.h.html#103" title='tensorflow::errors::InvalidArgument' data-ref="_ZN10tensorflow6errors15InvalidArgumentEDpT_">InvalidArgument</a>(</td></tr>
<tr><th id="397">397</th><td>        <q>"Less leaves in the beam search than requested."</q>);</td></tr>
<tr><th id="398">398</th><td>  }</td></tr>
<tr><th id="399">399</th><td></td></tr>
<tr><th id="400">400</th><td>  <span class="namespace">gtl::</span><a class="type" href="../../lib/gtl/top_n.h.html#tensorflow::gtl::TopN" title='tensorflow::gtl::TopN' data-ref="tensorflow::gtl::TopN">TopN</a>&lt;<a class="typedef" href="#tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry" title='tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry' data-type='ctc_beam_search::BeamEntry&lt;CTCBeamState&gt;' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry">BeamEntry</a>*, CTCBeamComparer&gt; <dfn class="local col9 decl" id="119top_branches" title='top_branches' data-type='gtl::TopN&lt;BeamEntry *, CTCBeamComparer&gt;' data-ref="119top_branches">top_branches</dfn>(<a class="local col5 ref" href="#115n" title='n' data-ref="115n">n</a>);</td></tr>
<tr><th id="401">401</th><td></td></tr>
<tr><th id="402">402</th><td>  <i>// O(beam_width_ * log(n)), space complexity is O(n)</i></td></tr>
<tr><th id="403">403</th><td>  <b>for</b> (<em>auto</em> <dfn class="local col0 decl" id="120it" title='it' data-type='auto' data-ref="120it">it</dfn> = <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::leaves_" title='tensorflow::ctc::CTCBeamSearchDecoder::leaves_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::leaves_">leaves_</a>.unsorted_begin(); <a class="local col0 ref" href="#120it" title='it' data-ref="120it">it</a> != <a class="member" href="#tensorflow::ctc::CTCBeamSearchDecoder::leaves_" title='tensorflow::ctc::CTCBeamSearchDecoder::leaves_' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::leaves_">leaves_</a>.unsorted_end(); ++<a class="local col0 ref" href="#120it" title='it' data-ref="120it">it</a>) {</td></tr>
<tr><th id="404">404</th><td>    <a class="local col9 ref" href="#119top_branches" title='top_branches' data-ref="119top_branches">top_branches</a>.push(*<a class="local col0 ref" href="#120it" title='it' data-ref="120it">it</a>);</td></tr>
<tr><th id="405">405</th><td>  }</td></tr>
<tr><th id="406">406</th><td>  <i>// O(n * log(n))</i></td></tr>
<tr><th id="407">407</th><td>  <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/unique_ptr.h.html#std::unique_ptr" title='std::unique_ptr' data-ref="std::unique_ptr">unique_ptr</a>&lt;<span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<a class="typedef" href="#tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry" title='tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry' data-type='ctc_beam_search::BeamEntry&lt;CTCBeamState&gt;' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry">BeamEntry</a>*&gt;&gt; <dfn class="local col1 decl" id="121branches" title='branches' data-type='std::unique_ptr&lt;std::vector&lt;BeamEntry *&gt; &gt;' data-ref="121branches">branches</dfn>(<a class="local col9 ref" href="#119top_branches" title='top_branches' data-ref="119top_branches">top_branches</a>.Extract());</td></tr>
<tr><th id="408">408</th><td></td></tr>
<tr><th id="409">409</th><td>  <b>for</b> (<em>int</em> <dfn class="local col2 decl" id="122i" title='i' data-type='int' data-ref="122i">i</dfn> = <var>0</var>; <a class="local col2 ref" href="#122i" title='i' data-ref="122i">i</a> &lt; <a class="local col5 ref" href="#115n" title='n' data-ref="115n">n</a>; ++<a class="local col2 ref" href="#122i" title='i' data-ref="122i">i</a>) {</td></tr>
<tr><th id="410">410</th><td>    <a class="typedef" href="#tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry" title='tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry' data-type='ctc_beam_search::BeamEntry&lt;CTCBeamState&gt;' data-ref="tensorflow::ctc::CTCBeamSearchDecoder::BeamEntry">BeamEntry</a>* <dfn class="local col3 decl" id="123e" title='e' data-type='BeamEntry *' data-ref="123e">e</dfn>((*<a class="local col1 ref" href="#121branches" title='branches' data-ref="121branches">branches</a>)[<a class="local col2 ref" href="#122i" title='i' data-ref="122i">i</a>]);</td></tr>
<tr><th id="411">411</th><td>    <a class="local col6 ref" href="#116paths" title='paths' data-ref="116paths">paths</a>-&gt;push_back(<a class="local col3 ref" href="#123e" title='e' data-ref="123e">e</a>-&gt;LabelSeq(<a class="local col8 ref" href="#118merge_repeated" title='merge_repeated' data-ref="118merge_repeated">merge_repeated</a>));</td></tr>
<tr><th id="412">412</th><td>    <a class="local col7 ref" href="#117log_probs" title='log_probs' data-ref="117log_probs">log_probs</a>-&gt;push_back(<a class="local col3 ref" href="#123e" title='e' data-ref="123e">e</a>-&gt;newp.total);</td></tr>
<tr><th id="413">413</th><td>  }</td></tr>
<tr><th id="414">414</th><td>  <b>return</b> <a class="type" href="../../lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a>::<a class="ref" href="../../lib/core/status.h.html#_ZN10tensorflow6Status2OKEv" title='tensorflow::Status::OK' data-ref="_ZN10tensorflow6Status2OKEv">OK</a>();</td></tr>
<tr><th id="415">415</th><td>}</td></tr>
<tr><th id="416">416</th><td></td></tr>
<tr><th id="417">417</th><td>}  <i>// namespace ctc</i></td></tr>
<tr><th id="418">418</th><td>}  <i>// namespace tensorflow</i></td></tr>
<tr><th id="419">419</th><td></td></tr>
<tr><th id="420">420</th><td><u>#<span data-ppcond="16">endif</span>  // TENSORFLOW_CORE_UTIL_CTC_CTC_BEAM_SEARCH_H_</u></td></tr>
<tr><th id="421">421</th><td></td></tr>
</table><hr/><p id='footer'>
Generated while processing <a href='../../kernels/ctc_decoder_ops.cc.html'>tensorflow/tensorflow/core/kernels/ctc_decoder_ops.cc</a><br/>Generated on <em>2018-Aug-09</em> from project tensorflow revision <em>v1.8</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
