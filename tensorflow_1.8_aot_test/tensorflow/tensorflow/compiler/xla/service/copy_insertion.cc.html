<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0"><title>copy_insertion.cc source code [tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc] - Woboq Code Browser</title>
<link rel="stylesheet" href="https://code.woboq.org/data/qtcreator.css" title="QtCreator"/>
<link rel="alternate stylesheet" href="https://code.woboq.org/data/kdevelop.css" title="KDevelop"/>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery.min.js"></script>
<script type="text/javascript" src="https://code.woboq.org/data/jquery/jquery-ui.min.js"></script>
<script>var file = 'tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc'; var root_path = '../../../../..'; var data_path = 'https://code.woboq.org/data';</script>
<script src='https://code.woboq.org/data/codebrowser.js'></script>
</head>
<body><div id='header'><h1 id='breadcrumb'><span>Browse the source code of </span><a href='../../../..'>tensorflow</a>/<a href='../../..'>tensorflow</a>/<a href='../..'>compiler</a>/<a href='..'>xla</a>/<a href='./'>service</a>/<a href='copy_insertion.cc.html'>copy_insertion.cc</a></h1></div>
<hr/><div id='content'><table class="code">
<tr><th id="1">1</th><td><i>/* Copyright 2017 The TensorFlow Authors. All Rights Reserved.</i></td></tr>
<tr><th id="2">2</th><td><i></i></td></tr>
<tr><th id="3">3</th><td><i>Licensed under the Apache License, Version 2.0 (the "License");</i></td></tr>
<tr><th id="4">4</th><td><i>you may not use this file except in compliance with the License.</i></td></tr>
<tr><th id="5">5</th><td><i>You may obtain a copy of the License at</i></td></tr>
<tr><th id="6">6</th><td><i></i></td></tr>
<tr><th id="7">7</th><td><i>    <a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></i></td></tr>
<tr><th id="8">8</th><td><i></i></td></tr>
<tr><th id="9">9</th><td><i>Unless required by applicable law or agreed to in writing, software</i></td></tr>
<tr><th id="10">10</th><td><i>distributed under the License is distributed on an "AS IS" BASIS,</i></td></tr>
<tr><th id="11">11</th><td><i>WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</i></td></tr>
<tr><th id="12">12</th><td><i>See the License for the specific language governing permissions and</i></td></tr>
<tr><th id="13">13</th><td><i>limitations under the License.</i></td></tr>
<tr><th id="14">14</th><td><i>==============================================================================*/</i></td></tr>
<tr><th id="15">15</th><td></td></tr>
<tr><th id="16">16</th><td><u>#include <a href="copy_insertion.h.html">"tensorflow/compiler/xla/service/copy_insertion.h"</a></u></td></tr>
<tr><th id="17">17</th><td></td></tr>
<tr><th id="18">18</th><td><u>#include <a href="hlo_alias_analysis.h.html">"tensorflow/compiler/xla/service/hlo_alias_analysis.h"</a></u></td></tr>
<tr><th id="19">19</th><td><u>#include <a href="hlo_computation.h.html">"tensorflow/compiler/xla/service/hlo_computation.h"</a></u></td></tr>
<tr><th id="20">20</th><td><u>#include <a href="hlo_dce.h.html">"tensorflow/compiler/xla/service/hlo_dce.h"</a></u></td></tr>
<tr><th id="21">21</th><td><u>#include <a href="hlo_graph_dumper.h.html">"tensorflow/compiler/xla/service/hlo_graph_dumper.h"</a></u></td></tr>
<tr><th id="22">22</th><td><u>#include <a href="hlo_instruction.h.html">"tensorflow/compiler/xla/service/hlo_instruction.h"</a></u></td></tr>
<tr><th id="23">23</th><td><u>#include <a href="hlo_module.h.html">"tensorflow/compiler/xla/service/hlo_module.h"</a></u></td></tr>
<tr><th id="24">24</th><td><u>#include <a href="hlo_opcode.h.html">"tensorflow/compiler/xla/service/hlo_opcode.h"</a></u></td></tr>
<tr><th id="25">25</th><td><u>#include <a href="hlo_ordering.h.html">"tensorflow/compiler/xla/service/hlo_ordering.h"</a></u></td></tr>
<tr><th id="26">26</th><td><u>#include <a href="liveness_util.h.html">"tensorflow/compiler/xla/service/liveness_util.h"</a></u></td></tr>
<tr><th id="27">27</th><td><u>#include <a href="logical_buffer.h.html">"tensorflow/compiler/xla/service/logical_buffer.h"</a></u></td></tr>
<tr><th id="28">28</th><td><u>#include <a href="tuple_simplifier.h.html">"tensorflow/compiler/xla/service/tuple_simplifier.h"</a></u></td></tr>
<tr><th id="29">29</th><td><u>#include <a href="../status_macros.h.html">"tensorflow/compiler/xla/status_macros.h"</a></u></td></tr>
<tr><th id="30">30</th><td><u>#include <a href="../statusor.h.html">"tensorflow/compiler/xla/statusor.h"</a></u></td></tr>
<tr><th id="31">31</th><td><u>#include <a href="../types.h.html">"tensorflow/compiler/xla/types.h"</a></u></td></tr>
<tr><th id="32">32</th><td><u>#include <a href="../util.h.html">"tensorflow/compiler/xla/util.h"</a></u></td></tr>
<tr><th id="33">33</th><td><u>#include <a href="../../../core/lib/gtl/flatmap.h.html">"tensorflow/core/lib/gtl/flatmap.h"</a></u></td></tr>
<tr><th id="34">34</th><td><u>#include <a href="../../../core/lib/gtl/flatset.h.html">"tensorflow/core/lib/gtl/flatset.h"</a></u></td></tr>
<tr><th id="35">35</th><td><u>#include <a href="../../../core/lib/strings/str_util.h.html">"tensorflow/core/lib/strings/str_util.h"</a></u></td></tr>
<tr><th id="36">36</th><td><u>#include <a href="../../../core/lib/strings/strcat.h.html">"tensorflow/core/lib/strings/strcat.h"</a></u></td></tr>
<tr><th id="37">37</th><td><u>#include <a href="../../../core/platform/logging.h.html">"tensorflow/core/platform/logging.h"</a></u></td></tr>
<tr><th id="38">38</th><td></td></tr>
<tr><th id="39">39</th><td><b>namespace</b> <span class="namespace">xla</span> {</td></tr>
<tr><th id="40">40</th><td></td></tr>
<tr><th id="41">41</th><td><b>using</b> <span class="namespace">::tensorflow::str_util::</span>Join;</td></tr>
<tr><th id="42">42</th><td><b>using</b> <span class="namespace">::tensorflow::strings::</span>StrAppend;</td></tr>
<tr><th id="43">43</th><td><b>using</b> <span class="namespace">::tensorflow::strings::</span>StrCat;</td></tr>
<tr><th id="44">44</th><td></td></tr>
<tr><th id="45">45</th><td><b>namespace</b> {</td></tr>
<tr><th id="46">46</th><td></td></tr>
<tr><th id="47">47</th><td><em>bool</em> <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_121IsEntryParameterValueERKNS_8HloValueE" title='xla::(anonymous namespace)::IsEntryParameterValue' data-type='bool xla::(anonymous namespace)::IsEntryParameterValue(const xla::HloValue &amp; value)' data-ref="_ZN3xla12_GLOBAL__N_121IsEntryParameterValueERKNS_8HloValueE">IsEntryParameterValue</dfn>(<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValue" title='xla::HloValue' data-ref="xla::HloValue">HloValue</a>&amp; <dfn class="local col0 decl" id="30value" title='value' data-type='const xla::HloValue &amp;' data-ref="30value">value</dfn>) {</td></tr>
<tr><th id="48">48</th><td>  <em>const</em> <a class="type" href="hlo_computation.h.html#xla::HloComputation" title='xla::HloComputation' data-ref="xla::HloComputation">HloComputation</a>* <dfn class="local col1 decl" id="31computation" title='computation' data-type='const xla::HloComputation *' data-ref="31computation">computation</dfn> = <a class="local col0 ref" href="#30value" title='value' data-ref="30value">value</a>.<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue20defining_instructionEv" title='xla::HloValue::defining_instruction' data-ref="_ZNK3xla8HloValue20defining_instructionEv">defining_instruction</a>()-&gt;<a class="ref" href="hlo_instruction.h.html#_ZN3xla14HloInstruction6parentEv" title='xla::HloInstruction::parent' data-ref="_ZN3xla14HloInstruction6parentEv">parent</a>();</td></tr>
<tr><th id="49">49</th><td>  <b>return</b> <a class="local col0 ref" href="#30value" title='value' data-ref="30value">value</a>.<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue20defining_instructionEv" title='xla::HloValue::defining_instruction' data-ref="_ZNK3xla8HloValue20defining_instructionEv">defining_instruction</a>()-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction6opcodeEv" title='xla::HloInstruction::opcode' data-ref="_ZNK3xla14HloInstruction6opcodeEv">opcode</a>() == <a class="type" href="hlo_opcode.h.html#xla::HloOpcode" title='xla::HloOpcode' data-ref="xla::HloOpcode">HloOpcode</a>::<a class="enum" href="hlo_opcode.h.html#135" title='xla::HloOpcode::kParameter' data-ref="xla::HloOpcode::kParameter">kParameter</a> &amp;&amp;</td></tr>
<tr><th id="50">50</th><td>         <a class="local col1 ref" href="#31computation" title='computation' data-ref="31computation">computation</a> == <a class="local col1 ref" href="#31computation" title='computation' data-ref="31computation">computation</a>-&gt;<a class="ref" href="hlo_computation.h.html#_ZNK3xla14HloComputation6parentEv" title='xla::HloComputation::parent' data-ref="_ZNK3xla14HloComputation6parentEv">parent</a>()-&gt;<a class="ref" href="hlo_module.h.html#_ZNK3xla9HloModule17entry_computationEv" title='xla::HloModule::entry_computation' data-ref="_ZNK3xla9HloModule17entry_computationEv">entry_computation</a>();</td></tr>
<tr><th id="51">51</th><td>}</td></tr>
<tr><th id="52">52</th><td></td></tr>
<tr><th id="53">53</th><td><em>bool</em> <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_115IsConstantValueERKNS_8HloValueE" title='xla::(anonymous namespace)::IsConstantValue' data-type='bool xla::(anonymous namespace)::IsConstantValue(const xla::HloValue &amp; value)' data-ref="_ZN3xla12_GLOBAL__N_115IsConstantValueERKNS_8HloValueE">IsConstantValue</dfn>(<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValue" title='xla::HloValue' data-ref="xla::HloValue">HloValue</a>&amp; <dfn class="local col2 decl" id="32value" title='value' data-type='const xla::HloValue &amp;' data-ref="32value">value</dfn>) {</td></tr>
<tr><th id="54">54</th><td>  <b>return</b> <a class="local col2 ref" href="#32value" title='value' data-ref="32value">value</a>.<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue20defining_instructionEv" title='xla::HloValue::defining_instruction' data-ref="_ZNK3xla8HloValue20defining_instructionEv">defining_instruction</a>()-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction6opcodeEv" title='xla::HloInstruction::opcode' data-ref="_ZNK3xla14HloInstruction6opcodeEv">opcode</a>() == <a class="type" href="hlo_opcode.h.html#xla::HloOpcode" title='xla::HloOpcode' data-ref="xla::HloOpcode">HloOpcode</a>::<a class="enum" href="hlo_opcode.h.html#135" title='xla::HloOpcode::kConstant' data-ref="xla::HloOpcode::kConstant">kConstant</a>;</td></tr>
<tr><th id="55">55</th><td>}</td></tr>
<tr><th id="56">56</th><td></td></tr>
<tr><th id="57">57</th><td><em>bool</em> <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_115ValueIsReadOnlyERKNS_8HloValueE" title='xla::(anonymous namespace)::ValueIsReadOnly' data-type='bool xla::(anonymous namespace)::ValueIsReadOnly(const xla::HloValue &amp; value)' data-ref="_ZN3xla12_GLOBAL__N_115ValueIsReadOnlyERKNS_8HloValueE">ValueIsReadOnly</dfn>(<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValue" title='xla::HloValue' data-ref="xla::HloValue">HloValue</a>&amp; <dfn class="local col3 decl" id="33value" title='value' data-type='const xla::HloValue &amp;' data-ref="33value">value</dfn>) {</td></tr>
<tr><th id="58">58</th><td>  <b>return</b> <a class="tu ref" href="#_ZN3xla12_GLOBAL__N_115IsConstantValueERKNS_8HloValueE" title='xla::(anonymous namespace)::IsConstantValue' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_115IsConstantValueERKNS_8HloValueE">IsConstantValue</a>(<a class="local col3 ref" href="#33value" title='value' data-ref="33value">value</a>) || <a class="tu ref" href="#_ZN3xla12_GLOBAL__N_121IsEntryParameterValueERKNS_8HloValueE" title='xla::(anonymous namespace)::IsEntryParameterValue' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_121IsEntryParameterValueERKNS_8HloValueE">IsEntryParameterValue</a>(<a class="local col3 ref" href="#33value" title='value' data-ref="33value">value</a>);</td></tr>
<tr><th id="59">59</th><td>}</td></tr>
<tr><th id="60">60</th><td></td></tr>
<tr><th id="61">61</th><td><i  data-doc="xla::(anonymousnamespace)::SpecialCaseCopyPolicy">// Data structure describing the action which should be taken on parts of a</i></td></tr>
<tr><th id="62">62</th><td><i  data-doc="xla::(anonymousnamespace)::SpecialCaseCopyPolicy">// computation buffers, with respect to the adding of special case copies.</i></td></tr>
<tr><th id="63">63</th><td><b>struct</b> <dfn class="tu type def" id="xla::(anonymousnamespace)::SpecialCaseCopyPolicy" title='xla::(anonymous namespace)::SpecialCaseCopyPolicy' data-ref="xla::(anonymousnamespace)::SpecialCaseCopyPolicy">SpecialCaseCopyPolicy</dfn> {</td></tr>
<tr><th id="64">64</th><td>  <i  data-doc="xla::(anonymousnamespace)::SpecialCaseCopyPolicy::copy_root_replicated_buffers">// Insert a copy if the same buffer is found at multiple indices within the</i></td></tr>
<tr><th id="65">65</th><td><i  data-doc="xla::(anonymousnamespace)::SpecialCaseCopyPolicy::copy_root_replicated_buffers">  // output tuple.</i></td></tr>
<tr><th id="66">66</th><td>  <em>bool</em> <dfn class="tu decl" id="xla::(anonymousnamespace)::SpecialCaseCopyPolicy::copy_root_replicated_buffers" title='xla::(anonymous namespace)::SpecialCaseCopyPolicy::copy_root_replicated_buffers' data-type='bool' data-ref="xla::(anonymousnamespace)::SpecialCaseCopyPolicy::copy_root_replicated_buffers">copy_root_replicated_buffers</dfn> = <b>false</b>;</td></tr>
<tr><th id="67">67</th><td>  <i  data-doc="xla::(anonymousnamespace)::SpecialCaseCopyPolicy::copy_parameters_and_constants">// If true, insert a copy if a buffer coming from a constant or a parameter</i></td></tr>
<tr><th id="68">68</th><td><i  data-doc="xla::(anonymousnamespace)::SpecialCaseCopyPolicy::copy_parameters_and_constants">  // is found wihtin the output tuple.</i></td></tr>
<tr><th id="69">69</th><td>  <em>bool</em> <dfn class="tu decl" id="xla::(anonymousnamespace)::SpecialCaseCopyPolicy::copy_parameters_and_constants" title='xla::(anonymous namespace)::SpecialCaseCopyPolicy::copy_parameters_and_constants' data-type='bool' data-ref="xla::(anonymousnamespace)::SpecialCaseCopyPolicy::copy_parameters_and_constants">copy_parameters_and_constants</dfn> = <b>false</b>;</td></tr>
<tr><th id="70">70</th><td>};</td></tr>
<tr><th id="71">71</th><td></td></tr>
<tr><th id="72">72</th><td><a class="tu type" href="#xla::(anonymousnamespace)::SpecialCaseCopyPolicy" title='xla::(anonymous namespace)::SpecialCaseCopyPolicy' data-ref="xla::(anonymousnamespace)::SpecialCaseCopyPolicy">SpecialCaseCopyPolicy</a> <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_124GetSpecialCaseCopyPolicyERKNS_13CallGraphNodeEPNS_9HloModuleEPNS_14HloComputationE" title='xla::(anonymous namespace)::GetSpecialCaseCopyPolicy' data-type='xla::(anonymous namespace)::SpecialCaseCopyPolicy xla::(anonymous namespace)::GetSpecialCaseCopyPolicy(const xla::CallGraphNode &amp; node, xla::HloModule * module, xla::HloComputation * computation)' data-ref="_ZN3xla12_GLOBAL__N_124GetSpecialCaseCopyPolicyERKNS_13CallGraphNodeEPNS_9HloModuleEPNS_14HloComputationE">GetSpecialCaseCopyPolicy</dfn>(<em>const</em> <a class="type" href="call_graph.h.html#xla::CallGraphNode" title='xla::CallGraphNode' data-ref="xla::CallGraphNode">CallGraphNode</a>&amp; <dfn class="local col4 decl" id="34node" title='node' data-type='const xla::CallGraphNode &amp;' data-ref="34node">node</dfn>,</td></tr>
<tr><th id="73">73</th><td>                                               <a class="type" href="hlo_module.h.html#xla::HloModule" title='xla::HloModule' data-ref="xla::HloModule">HloModule</a>* <dfn class="local col5 decl" id="35module" title='module' data-type='xla::HloModule *' data-ref="35module">module</dfn>,</td></tr>
<tr><th id="74">74</th><td>                                               <a class="type" href="hlo_computation.h.html#xla::HloComputation" title='xla::HloComputation' data-ref="xla::HloComputation">HloComputation</a>* <dfn class="local col6 decl" id="36computation" title='computation' data-type='xla::HloComputation *' data-ref="36computation">computation</dfn>) {</td></tr>
<tr><th id="75">75</th><td>  <a class="tu type" href="#xla::(anonymousnamespace)::SpecialCaseCopyPolicy" title='xla::(anonymous namespace)::SpecialCaseCopyPolicy' data-ref="xla::(anonymousnamespace)::SpecialCaseCopyPolicy">SpecialCaseCopyPolicy</a> <a class="tu ref fake" href="#63" title='xla::(anonymous namespace)::SpecialCaseCopyPolicy::SpecialCaseCopyPolicy' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_121SpecialCaseCopyPolicyC1Ev"></a><dfn class="local col7 decl" id="37policy" title='policy' data-type='xla::(anonymous namespace)::SpecialCaseCopyPolicy' data-ref="37policy">policy</dfn>;</td></tr>
<tr><th id="76">76</th><td>  <b>if</b> (<a class="local col6 ref" href="#36computation" title='computation' data-ref="36computation">computation</a> == <a class="local col5 ref" href="#35module" title='module' data-ref="35module">module</a>-&gt;<a class="ref" href="hlo_module.h.html#_ZN3xla9HloModule17entry_computationEv" title='xla::HloModule::entry_computation' data-ref="_ZN3xla9HloModule17entry_computationEv">entry_computation</a>()) {</td></tr>
<tr><th id="77">77</th><td>    <a class="local col7 ref" href="#37policy" title='policy' data-ref="37policy">policy</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::SpecialCaseCopyPolicy::copy_parameters_and_constants" title='xla::(anonymous namespace)::SpecialCaseCopyPolicy::copy_parameters_and_constants' data-use='w' data-ref="xla::(anonymousnamespace)::SpecialCaseCopyPolicy::copy_parameters_and_constants">copy_parameters_and_constants</a> = <b>true</b>;</td></tr>
<tr><th id="78">78</th><td>    <a class="local col7 ref" href="#37policy" title='policy' data-ref="37policy">policy</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::SpecialCaseCopyPolicy::copy_root_replicated_buffers" title='xla::(anonymous namespace)::SpecialCaseCopyPolicy::copy_root_replicated_buffers' data-use='w' data-ref="xla::(anonymousnamespace)::SpecialCaseCopyPolicy::copy_root_replicated_buffers">copy_root_replicated_buffers</a> = <b>true</b>;</td></tr>
<tr><th id="79">79</th><td>  }</td></tr>
<tr><th id="80">80</th><td>  <b>for</b> (<em>const</em> <a class="type" href="call_graph.h.html#xla::CallSite" title='xla::CallSite' data-ref="xla::CallSite">CallSite</a>&amp; <dfn class="local col8 decl" id="38site" title='site' data-type='const xla::CallSite &amp;' data-ref="38site">site</dfn> : <a class="local col4 ref" href="#34node" title='node' data-ref="34node">node</a>.<a class="ref" href="call_graph.h.html#_ZNK3xla13CallGraphNode16caller_callsitesEv" title='xla::CallGraphNode::caller_callsites' data-ref="_ZNK3xla13CallGraphNode16caller_callsitesEv">caller_callsites</a>()) {</td></tr>
<tr><th id="81">81</th><td>    <i>// The AddCopiesForConditional() already adds copies, but the copy remover</i></td></tr>
<tr><th id="82">82</th><td><i>    // removes them, so we re-add them by returning the policy here. But really</i></td></tr>
<tr><th id="83">83</th><td><i>    // the copy remover should not be removing them.</i></td></tr>
<tr><th id="84">84</th><td>    <b>if</b> (<a class="local col8 ref" href="#38site" title='site' data-ref="38site">site</a>.<a class="ref" href="call_graph.h.html#_ZNK3xla8CallSite11instructionEv" title='xla::CallSite::instruction' data-ref="_ZNK3xla8CallSite11instructionEv">instruction</a>()-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction6opcodeEv" title='xla::HloInstruction::opcode' data-ref="_ZNK3xla14HloInstruction6opcodeEv">opcode</a>() == <a class="type" href="hlo_opcode.h.html#xla::HloOpcode" title='xla::HloOpcode' data-ref="xla::HloOpcode">HloOpcode</a>::<a class="enum" href="hlo_opcode.h.html#135" title='xla::HloOpcode::kConditional' data-ref="xla::HloOpcode::kConditional">kConditional</a>) {</td></tr>
<tr><th id="85">85</th><td>      <a class="local col7 ref" href="#37policy" title='policy' data-ref="37policy">policy</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::SpecialCaseCopyPolicy::copy_parameters_and_constants" title='xla::(anonymous namespace)::SpecialCaseCopyPolicy::copy_parameters_and_constants' data-use='w' data-ref="xla::(anonymousnamespace)::SpecialCaseCopyPolicy::copy_parameters_and_constants">copy_parameters_and_constants</a> = <b>true</b>;</td></tr>
<tr><th id="86">86</th><td>      <a class="local col7 ref" href="#37policy" title='policy' data-ref="37policy">policy</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::SpecialCaseCopyPolicy::copy_root_replicated_buffers" title='xla::(anonymous namespace)::SpecialCaseCopyPolicy::copy_root_replicated_buffers' data-use='w' data-ref="xla::(anonymousnamespace)::SpecialCaseCopyPolicy::copy_root_replicated_buffers">copy_root_replicated_buffers</a> = <b>true</b>;</td></tr>
<tr><th id="87">87</th><td>    }</td></tr>
<tr><th id="88">88</th><td>  }</td></tr>
<tr><th id="89">89</th><td>  <b>return</b> <a class="local col7 ref" href="#37policy" title='policy' data-ref="37policy">policy</a>;</td></tr>
<tr><th id="90">90</th><td>}</td></tr>
<tr><th id="91">91</th><td></td></tr>
<tr><th id="92">92</th><td><em>bool</em> <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_119ShouldCopyRootValueERKNS_8HloValueERKNS0_21SpecialCaseCopyPolicyE" title='xla::(anonymous namespace)::ShouldCopyRootValue' data-type='bool xla::(anonymous namespace)::ShouldCopyRootValue(const xla::HloValue &amp; value, const xla::(anonymous namespace)::SpecialCaseCopyPolicy &amp; policy)' data-ref="_ZN3xla12_GLOBAL__N_119ShouldCopyRootValueERKNS_8HloValueERKNS0_21SpecialCaseCopyPolicyE">ShouldCopyRootValue</dfn>(<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValue" title='xla::HloValue' data-ref="xla::HloValue">HloValue</a>&amp; <dfn class="local col9 decl" id="39value" title='value' data-type='const xla::HloValue &amp;' data-ref="39value">value</dfn>,</td></tr>
<tr><th id="93">93</th><td>                         <em>const</em> <a class="tu type" href="#xla::(anonymousnamespace)::SpecialCaseCopyPolicy" title='xla::(anonymous namespace)::SpecialCaseCopyPolicy' data-ref="xla::(anonymousnamespace)::SpecialCaseCopyPolicy">SpecialCaseCopyPolicy</a>&amp; <dfn class="local col0 decl" id="40policy" title='policy' data-type='const xla::(anonymous namespace)::SpecialCaseCopyPolicy &amp;' data-ref="40policy">policy</dfn>) {</td></tr>
<tr><th id="94">94</th><td>  <b>if</b> (<a class="local col0 ref" href="#40policy" title='policy' data-ref="40policy">policy</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::SpecialCaseCopyPolicy::copy_parameters_and_constants" title='xla::(anonymous namespace)::SpecialCaseCopyPolicy::copy_parameters_and_constants' data-use='r' data-ref="xla::(anonymousnamespace)::SpecialCaseCopyPolicy::copy_parameters_and_constants">copy_parameters_and_constants</a>) {</td></tr>
<tr><th id="95">95</th><td>    <b>return</b> <a class="tu ref" href="#_ZN3xla12_GLOBAL__N_115IsConstantValueERKNS_8HloValueE" title='xla::(anonymous namespace)::IsConstantValue' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_115IsConstantValueERKNS_8HloValueE">IsConstantValue</a>(<a class="local col9 ref" href="#39value" title='value' data-ref="39value">value</a>) ||</td></tr>
<tr><th id="96">96</th><td>           <a class="local col9 ref" href="#39value" title='value' data-ref="39value">value</a>.<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue20defining_instructionEv" title='xla::HloValue::defining_instruction' data-ref="_ZNK3xla8HloValue20defining_instructionEv">defining_instruction</a>()-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction6opcodeEv" title='xla::HloInstruction::opcode' data-ref="_ZNK3xla14HloInstruction6opcodeEv">opcode</a>() == <a class="type" href="hlo_opcode.h.html#xla::HloOpcode" title='xla::HloOpcode' data-ref="xla::HloOpcode">HloOpcode</a>::<a class="enum" href="hlo_opcode.h.html#135" title='xla::HloOpcode::kParameter' data-ref="xla::HloOpcode::kParameter">kParameter</a>;</td></tr>
<tr><th id="97">97</th><td>  }</td></tr>
<tr><th id="98">98</th><td>  <b>return</b> <b>false</b>;</td></tr>
<tr><th id="99">99</th><td>}</td></tr>
<tr><th id="100">100</th><td></td></tr>
<tr><th id="101">101</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">// Deep copy the given instructions 'from' and 'to' at the ShapeIndexes given in</i></td></tr>
<tr><th id="102">102</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">// 'indices_to_copy'. Add control edges from the respective kCopy instructions</i></td></tr>
<tr><th id="103">103</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">// in deep copy of 'from' to the respective kCopy instruction in the deep copy</i></td></tr>
<tr><th id="104">104</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">// of 'to'.</i></td></tr>
<tr><th id="105">105</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//</i></td></tr>
<tr><th id="106">106</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">// Requirements: 'from' and 'to' must have compatible shapes.</i></td></tr>
<tr><th id="107">107</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//</i></td></tr>
<tr><th id="108">108</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">// For example, suppose 'from' and 'to' are two-element tuples where index 0 is</i></td></tr>
<tr><th id="109">109</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">// the only index to copy. Prior to deep-copying we have:</i></td></tr>
<tr><th id="110">110</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//</i></td></tr>
<tr><th id="111">111</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//</i></td></tr>
<tr><th id="112">112</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//      'from'</i></td></tr>
<tr><th id="113">113</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//         |</i></td></tr>
<tr><th id="114">114</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//        ...</i></td></tr>
<tr><th id="115">115</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//         |</i></td></tr>
<tr><th id="116">116</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//       'to'</i></td></tr>
<tr><th id="117">117</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//</i></td></tr>
<tr><th id="118">118</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">// DeepCopyAndAddControlEdges produces:</i></td></tr>
<tr><th id="119">119</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//</i></td></tr>
<tr><th id="120">120</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//       'from'</i></td></tr>
<tr><th id="121">121</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//        /   \</i></td></tr>
<tr><th id="122">122</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//      GTE   GTE</i></td></tr>
<tr><th id="123">123</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//       |     |</i></td></tr>
<tr><th id="124">124</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//     Copy    |</i></td></tr>
<tr><th id="125">125</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//    /   \   /</i></td></tr>
<tr><th id="126">126</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//   |    Tuple</i></td></tr>
<tr><th id="127">127</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//   |      |</i></td></tr>
<tr><th id="128">128</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//  ctrl   ...</i></td></tr>
<tr><th id="129">129</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//  edge    |</i></td></tr>
<tr><th id="130">130</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//   |      |</i></td></tr>
<tr><th id="131">131</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//   |    'to'</i></td></tr>
<tr><th id="132">132</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//   |    /   \</i></td></tr>
<tr><th id="133">133</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//   |  GTE   GTE</i></td></tr>
<tr><th id="134">134</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//    \  |     |</i></td></tr>
<tr><th id="135">135</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//     Copy    |</i></td></tr>
<tr><th id="136">136</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//        \   /</i></td></tr>
<tr><th id="137">137</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//        Tuple</i></td></tr>
<tr><th id="138">138</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">//</i></td></tr>
<tr><th id="139">139</th><td><a class="type" href="../statusor.h.html#xla::StatusOr" title='xla::StatusOr' data-ref="xla::StatusOr">StatusOr</a>&lt;<span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_pair.h.html#std::pair" title='std::pair' data-ref="std::pair">pair</a>&lt;<a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>*, <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>*&gt;&gt;</td></tr>
<tr><th id="140">140</th><td><dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE" title='xla::(anonymous namespace)::DeepCopyAndAddControlEdges' data-type='StatusOr&lt;std::pair&lt;HloInstruction *, HloInstruction *&gt; &gt; xla::(anonymous namespace)::DeepCopyAndAddControlEdges(xla::HloInstruction * from, xla::HloInstruction * to, const ShapeTree&lt;bool&gt; &amp; indices_to_copy)' data-ref="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">DeepCopyAndAddControlEdges</dfn>(<a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col1 decl" id="41from" title='from' data-type='xla::HloInstruction *' data-ref="41from">from</dfn>, <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col2 decl" id="42to" title='to' data-type='xla::HloInstruction *' data-ref="42to">to</dfn>,</td></tr>
<tr><th id="141">141</th><td>                           <em>const</em> <a class="type" href="../shape_tree.h.html#xla::ShapeTree" title='xla::ShapeTree' data-ref="xla::ShapeTree">ShapeTree</a>&lt;<em>bool</em>&gt;&amp; <dfn class="local col3 decl" id="43indices_to_copy" title='indices_to_copy' data-type='const ShapeTree&lt;bool&gt; &amp;' data-ref="43indices_to_copy">indices_to_copy</dfn>) {</td></tr>
<tr><th id="142">142</th><td>  <a class="macro" href="../../../core/platform/default/logging.h.html#273" title="while (false &amp;&amp; (ShapeUtil::Compatible(from-&gt;shape(), to-&gt;shape()))) ::tensorflow::internal::LogMessageFatal(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 142)" data-ref="_M/DCHECK">DCHECK</a>(<a class="type" href="../shape_util.h.html#xla::ShapeUtil" title='xla::ShapeUtil' data-ref="xla::ShapeUtil">ShapeUtil</a>::<a class="ref" href="../shape_util.h.html#_ZN3xla9ShapeUtil10CompatibleERKNS_5ShapeES3_" title='xla::ShapeUtil::Compatible' data-ref="_ZN3xla9ShapeUtil10CompatibleERKNS_5ShapeES3_">Compatible</a>(<a class="local col1 ref" href="#41from" title='from' data-ref="41from">from</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction5shapeEv" title='xla::HloInstruction::shape' data-ref="_ZNK3xla14HloInstruction5shapeEv">shape</a>(), <a class="local col2 ref" href="#42to" title='to' data-ref="42to">to</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction5shapeEv" title='xla::HloInstruction::shape' data-ref="_ZNK3xla14HloInstruction5shapeEv">shape</a>()));</td></tr>
<tr><th id="143">143</th><td>  <i>// to/from_copy_tree hold the kCopy instruction produces by the deep</i></td></tr>
<tr><th id="144">144</th><td><i>  // copies. Elements which are not copied (indices_to_copy.element(index) ==</i></td></tr>
<tr><th id="145">145</th><td><i>  // false) have nullptr at that index.</i></td></tr>
<tr><th id="146">146</th><td>  <a class="type" href="../shape_tree.h.html#xla::ShapeTree" title='xla::ShapeTree' data-ref="xla::ShapeTree">ShapeTree</a>&lt;<a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>*&gt; <dfn class="local col4 decl" id="44from_copy_tree" title='from_copy_tree' data-type='ShapeTree&lt;xla::HloInstruction *&gt;' data-ref="44from_copy_tree">from_copy_tree</dfn><a class="ref" href="../shape_tree.h.html#_ZN3xla9ShapeTreeC1ENS_5ShapeERKT_" title='xla::ShapeTree::ShapeTree&lt;T&gt;' data-ref="_ZN3xla9ShapeTreeC1ENS_5ShapeERKT_">(</a><span class='ref fake' title='xla::Shape::Shape' data-ref="_ZN3xla5ShapeC1ERKS0_"></span><a class="local col1 ref" href="#41from" title='from' data-ref="41from">from</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction5shapeEv" title='xla::HloInstruction::shape' data-ref="_ZNK3xla14HloInstruction5shapeEv">shape</a>(),</td></tr>
<tr><th id="147">147</th><td>                                            <i>/*init_value=*/</i><b>nullptr</b>);</td></tr>
<tr><th id="148">148</th><td>  <a class="macro" href="../status_macros.h.html#199" title="auto _status_or_value1 = (from-&gt;parent()-&gt;DeepCopyInstruction( from, &amp;indices_to_copy, &amp;from_copy_tree)); if ((__builtin_expect(!_status_or_value1.ok(), 0))) { return _status_or_value1.status(); } HloInstruction * from_deep_copy = std::move(_status_or_value1.ValueOrDie())" data-ref="_M/TF_ASSIGN_OR_RETURN">TF_ASSIGN_OR_RETURN</a>(<a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a> * <dfn class="local col5 decl" id="45from_deep_copy" title='from_deep_copy' data-type='xla::HloInstruction *' data-ref="45from_deep_copy">from_deep_copy</dfn>,</td></tr>
<tr><th id="149">149</th><td>                      <a class="local col1 ref" href="#41from" title='from' data-ref="41from">from</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZN3xla14HloInstruction6parentEv" title='xla::HloInstruction::parent' data-ref="_ZN3xla14HloInstruction6parentEv">parent</a>()-&gt;<a class="ref" href="hlo_computation.h.html#_ZN3xla14HloComputation19DeepCopyInstructionEPNS_14HloInstructionEPKNS_9ShapeTreeIbEEPNS3_IS2_EE" title='xla::HloComputation::DeepCopyInstruction' data-ref="_ZN3xla14HloComputation19DeepCopyInstructionEPNS_14HloInstructionEPKNS_9ShapeTreeIbEEPNS3_IS2_EE">DeepCopyInstruction</a>(</td></tr>
<tr><th id="150">150</th><td>                          <a class="local col1 ref" href="#41from" title='from' data-ref="41from">from</a>, &amp;<a class="local col3 ref" href="#43indices_to_copy" title='indices_to_copy' data-ref="43indices_to_copy">indices_to_copy</a>, &amp;<a class="local col4 ref" href="#44from_copy_tree" title='from_copy_tree' data-ref="44from_copy_tree">from_copy_tree</a>));</td></tr>
<tr><th id="151">151</th><td></td></tr>
<tr><th id="152">152</th><td>  <a class="type" href="../shape_tree.h.html#xla::ShapeTree" title='xla::ShapeTree' data-ref="xla::ShapeTree">ShapeTree</a>&lt;<a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>*&gt; <dfn class="local col6 decl" id="46to_copy_tree" title='to_copy_tree' data-type='ShapeTree&lt;xla::HloInstruction *&gt;' data-ref="46to_copy_tree">to_copy_tree</dfn><a class="ref" href="../shape_tree.h.html#_ZN3xla9ShapeTreeC1ENS_5ShapeERKT_" title='xla::ShapeTree::ShapeTree&lt;T&gt;' data-ref="_ZN3xla9ShapeTreeC1ENS_5ShapeERKT_">(</a><span class='ref fake' title='xla::Shape::Shape' data-ref="_ZN3xla5ShapeC1ERKS0_"></span><a class="local col2 ref" href="#42to" title='to' data-ref="42to">to</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction5shapeEv" title='xla::HloInstruction::shape' data-ref="_ZNK3xla14HloInstruction5shapeEv">shape</a>(), <i>/*init_value=*/</i><b>nullptr</b>);</td></tr>
<tr><th id="153">153</th><td>  <a class="macro" href="../status_macros.h.html#199" title="auto _status_or_value3 = (to-&gt;parent()-&gt;DeepCopyInstruction(to, &amp;indices_to_copy, &amp;to_copy_tree)); if ((__builtin_expect(!_status_or_value3.ok(), 0))) { return _status_or_value3.status(); } HloInstruction * to_deep_copy = std::move(_status_or_value3.ValueOrDie())" data-ref="_M/TF_ASSIGN_OR_RETURN">TF_ASSIGN_OR_RETURN</a>(</td></tr>
<tr><th id="154">154</th><td>      <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a> * <dfn class="local col7 decl" id="47to_deep_copy" title='to_deep_copy' data-type='xla::HloInstruction *' data-ref="47to_deep_copy">to_deep_copy</dfn>,</td></tr>
<tr><th id="155">155</th><td>      <a class="local col2 ref" href="#42to" title='to' data-ref="42to">to</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZN3xla14HloInstruction6parentEv" title='xla::HloInstruction::parent' data-ref="_ZN3xla14HloInstruction6parentEv">parent</a>()-&gt;<a class="ref" href="hlo_computation.h.html#_ZN3xla14HloComputation19DeepCopyInstructionEPNS_14HloInstructionEPKNS_9ShapeTreeIbEEPNS3_IS2_EE" title='xla::HloComputation::DeepCopyInstruction' data-ref="_ZN3xla14HloComputation19DeepCopyInstructionEPNS_14HloInstructionEPKNS_9ShapeTreeIbEEPNS3_IS2_EE">DeepCopyInstruction</a>(<a class="local col2 ref" href="#42to" title='to' data-ref="42to">to</a>, &amp;<a class="local col3 ref" href="#43indices_to_copy" title='indices_to_copy' data-ref="43indices_to_copy">indices_to_copy</a>, &amp;<a class="local col6 ref" href="#46to_copy_tree" title='to_copy_tree' data-ref="46to_copy_tree">to_copy_tree</a>));</td></tr>
<tr><th id="156">156</th><td></td></tr>
<tr><th id="157">157</th><td>  <i>// Add control edges between the respective kCopy instructions.</i></td></tr>
<tr><th id="158">158</th><td>  <b>for</b> (<em>const</em> <em>auto</em>&amp; <dfn class="local col8 decl" id="48pair" title='pair' data-type='const std::pair&lt;xla::ShapeIndex, xla::HloInstruction *&amp;&gt; &amp;' data-ref="48pair">pair</dfn> : <a class="local col4 ref" href="#44from_copy_tree" title='from_copy_tree' data-ref="44from_copy_tree">from_copy_tree</a>) {</td></tr>
<tr><th id="159">159</th><td>    <em>const</em> <a class="type" href="../shape_util.h.html#xla::ShapeIndex" title='xla::ShapeIndex' data-ref="xla::ShapeIndex">ShapeIndex</a>&amp; <dfn class="local col9 decl" id="49index" title='index' data-type='const xla::ShapeIndex &amp;' data-ref="49index">index</dfn> = <a class="local col8 ref" href="#48pair" title='pair' data-ref="48pair">pair</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_pair.h.html#std::pair::first" title='std::pair&lt;xla::ShapeIndex, xla::HloInstruction *&amp;&gt;::first' data-ref="std::pair::first">first</a>;</td></tr>
<tr><th id="160">160</th><td>    <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col0 decl" id="50from_copy" title='from_copy' data-type='xla::HloInstruction *' data-ref="50from_copy">from_copy</dfn> = <a class="local col8 ref" href="#48pair" title='pair' data-ref="48pair">pair</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_pair.h.html#std::pair::second" title='std::pair&lt;xla::ShapeIndex, xla::HloInstruction *&amp;&gt;::second' data-ref="std::pair::second">second</a>;</td></tr>
<tr><th id="161">161</th><td>    <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col1 decl" id="51to_copy" title='to_copy' data-type='xla::HloInstruction *' data-ref="51to_copy">to_copy</dfn> = <a class="local col6 ref" href="#46to_copy_tree" title='to_copy_tree' data-ref="46to_copy_tree">to_copy_tree</a>.<a class="ref" href="../shape_tree.h.html#_ZNK3xla9ShapeTree7elementERKNS_10ShapeIndexE" title='xla::ShapeTree::element' data-ref="_ZNK3xla9ShapeTree7elementERKNS_10ShapeIndexE">element</a>(<a class="local col9 ref" href="#49index" title='index' data-ref="49index">index</a>);</td></tr>
<tr><th id="162">162</th><td>    <b>if</b> (<a class="local col0 ref" href="#50from_copy" title='from_copy' data-ref="50from_copy">from_copy</a> == <b>nullptr</b>) {</td></tr>
<tr><th id="163">163</th><td>      <a class="macro" href="../status_macros.h.html#179" title="while ((__builtin_expect(!(to_copy == nullptr), 0))) return xla::status_macros::MakeErrorStream(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 163, tensorflow::error::INTERNAL) .with_log_stack_trace() .add_ret_check_failure(&quot;to_copy == nullptr&quot;)" data-ref="_M/TF_RET_CHECK">TF_RET_CHECK</a>(<a class="local col1 ref" href="#51to_copy" title='to_copy' data-ref="51to_copy">to_copy</a> == <b>nullptr</b>);</td></tr>
<tr><th id="164">164</th><td>      <b>continue</b>;</td></tr>
<tr><th id="165">165</th><td>    }</td></tr>
<tr><th id="166">166</th><td>    <a class="macro" href="../status_macros.h.html#179" title="while ((__builtin_expect(!(to_copy != nullptr), 0))) return xla::status_macros::MakeErrorStream(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 166, tensorflow::error::INTERNAL) .with_log_stack_trace() .add_ret_check_failure(&quot;to_copy != nullptr&quot;)" data-ref="_M/TF_RET_CHECK">TF_RET_CHECK</a>(<a class="local col1 ref" href="#51to_copy" title='to_copy' data-ref="51to_copy">to_copy</a> != <b>nullptr</b>);</td></tr>
<tr><th id="167">167</th><td>    <a class="macro" href="../../../core/lib/core/errors.h.html#69" title="do { const ::tensorflow::Status _status = (from_copy-&gt;AddControlDependencyTo(to_copy)); if ((__builtin_expect(!_status.ok(), 0))) return _status; } while (0)" data-ref="_M/TF_RETURN_IF_ERROR">TF_RETURN_IF_ERROR</a>(<a class="local col0 ref" href="#50from_copy" title='from_copy' data-ref="50from_copy">from_copy</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZN3xla14HloInstruction22AddControlDependencyToEPS0_" title='xla::HloInstruction::AddControlDependencyTo' data-ref="_ZN3xla14HloInstruction22AddControlDependencyToEPS0_">AddControlDependencyTo</a>(<a class="local col1 ref" href="#51to_copy" title='to_copy' data-ref="51to_copy">to_copy</a>));</td></tr>
<tr><th id="168">168</th><td>  }</td></tr>
<tr><th id="169">169</th><td></td></tr>
<tr><th id="170">170</th><td>  <b>return</b> <a class="ref fake" href="../statusor.h.html#_ZN3xla8StatusOrC1EOT_" title='xla::StatusOr::StatusOr&lt;T&gt;' data-ref="_ZN3xla8StatusOrC1EOT_"></a><span class="namespace">std::</span><a class="ref" href="../../../../../include/c++/5/bits/stl_pair.h.html#_ZSt9make_pairOT_OT0_" title='std::make_pair' data-ref="_ZSt9make_pairOT_OT0_">make_pair</a>(<span class='refarg'><a class="local col5 ref" href="#148" title='from_deep_copy' data-ref="45from_deep_copy">from_deep_copy</a></span>, <span class='refarg'><a class="local col7 ref" href="#153" title='to_deep_copy' data-ref="47to_deep_copy">to_deep_copy</a></span>);</td></tr>
<tr><th id="171">171</th><td>}</td></tr>
<tr><th id="172">172</th><td></td></tr>
<tr><th id="173">173</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_121IndicesToCopyForWhileERKNS_19HloDataflowAnalysisEPKNS_14HloInstructionEPNS_9ShapeTreeIbEE">// Compute the indices of the loop state which need copies in order to avoid</i></td></tr>
<tr><th id="174">174</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_121IndicesToCopyForWhileERKNS_19HloDataflowAnalysisEPKNS_14HloInstructionEPNS_9ShapeTreeIbEE">// live range interference. Generally, an element in the loop state does not</i></td></tr>
<tr><th id="175">175</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_121IndicesToCopyForWhileERKNS_19HloDataflowAnalysisEPKNS_14HloInstructionEPNS_9ShapeTreeIbEE">// need to be copied if the element is passed through transparently through the</i></td></tr>
<tr><th id="176">176</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_121IndicesToCopyForWhileERKNS_19HloDataflowAnalysisEPKNS_14HloInstructionEPNS_9ShapeTreeIbEE">// body.</i></td></tr>
<tr><th id="177">177</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_121IndicesToCopyForWhileERKNS_19HloDataflowAnalysisEPKNS_14HloInstructionEPNS_9ShapeTreeIbEE">//</i></td></tr>
<tr><th id="178">178</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_121IndicesToCopyForWhileERKNS_19HloDataflowAnalysisEPKNS_14HloInstructionEPNS_9ShapeTreeIbEE">// Returns whether any indices need to be copied.</i></td></tr>
<tr><th id="179">179</th><td><em>bool</em> <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_121IndicesToCopyForWhileERKNS_19HloDataflowAnalysisEPKNS_14HloInstructionEPNS_9ShapeTreeIbEE" title='xla::(anonymous namespace)::IndicesToCopyForWhile' data-type='bool xla::(anonymous namespace)::IndicesToCopyForWhile(const xla::HloDataflowAnalysis &amp; dataflow, const xla::HloInstruction * xla_while, ShapeTree&lt;bool&gt; * indices_to_copy)' data-ref="_ZN3xla12_GLOBAL__N_121IndicesToCopyForWhileERKNS_19HloDataflowAnalysisEPKNS_14HloInstructionEPNS_9ShapeTreeIbEE">IndicesToCopyForWhile</dfn>(<em>const</em> <a class="type" href="hlo_dataflow_analysis.h.html#xla::HloDataflowAnalysis" title='xla::HloDataflowAnalysis' data-ref="xla::HloDataflowAnalysis">HloDataflowAnalysis</a>&amp; <dfn class="local col2 decl" id="52dataflow" title='dataflow' data-type='const xla::HloDataflowAnalysis &amp;' data-ref="52dataflow">dataflow</dfn>,</td></tr>
<tr><th id="180">180</th><td>                           <em>const</em> <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col3 decl" id="53xla_while" title='xla_while' data-type='const xla::HloInstruction *' data-ref="53xla_while">xla_while</dfn>,</td></tr>
<tr><th id="181">181</th><td>                           <a class="type" href="../shape_tree.h.html#xla::ShapeTree" title='xla::ShapeTree' data-ref="xla::ShapeTree">ShapeTree</a>&lt;<em>bool</em>&gt;* <dfn class="local col4 decl" id="54indices_to_copy" title='indices_to_copy' data-type='ShapeTree&lt;bool&gt; *' data-ref="54indices_to_copy">indices_to_copy</dfn>) {</td></tr>
<tr><th id="182">182</th><td>  <a class="macro" href="../../../core/platform/default/logging.h.html#273" title="while (false &amp;&amp; (ShapeUtil::Compatible(indices_to_copy-&gt;shape(), xla_while-&gt;shape()))) ::tensorflow::internal::LogMessageFatal(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 182)" data-ref="_M/DCHECK">DCHECK</a>(<a class="type" href="../shape_util.h.html#xla::ShapeUtil" title='xla::ShapeUtil' data-ref="xla::ShapeUtil">ShapeUtil</a>::<a class="ref" href="../shape_util.h.html#_ZN3xla9ShapeUtil10CompatibleERKNS_5ShapeES3_" title='xla::ShapeUtil::Compatible' data-ref="_ZN3xla9ShapeUtil10CompatibleERKNS_5ShapeES3_">Compatible</a>(<a class="local col4 ref" href="#54indices_to_copy" title='indices_to_copy' data-ref="54indices_to_copy">indices_to_copy</a>-&gt;<a class="ref" href="../shape_tree.h.html#_ZNK3xla9ShapeTree5shapeEv" title='xla::ShapeTree::shape' data-ref="_ZNK3xla9ShapeTree5shapeEv">shape</a>(), <a class="local col3 ref" href="#53xla_while" title='xla_while' data-ref="53xla_while">xla_while</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction5shapeEv" title='xla::HloInstruction::shape' data-ref="_ZNK3xla14HloInstruction5shapeEv">shape</a>()));</td></tr>
<tr><th id="183">183</th><td></td></tr>
<tr><th id="184">184</th><td>  <em>bool</em> <dfn class="local col5 decl" id="55any_copies" title='any_copies' data-type='bool' data-ref="55any_copies">any_copies</dfn> = <b>false</b>;</td></tr>
<tr><th id="185">185</th><td>  <em>const</em> <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col6 decl" id="56init" title='init' data-type='const xla::HloInstruction *' data-ref="56init">init</dfn> = <a class="local col3 ref" href="#53xla_while" title='xla_while' data-ref="53xla_while">xla_while</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction7operandEx" title='xla::HloInstruction::operand' data-ref="_ZNK3xla14HloInstruction7operandEx">operand</a>(<var>0</var>);</td></tr>
<tr><th id="186">186</th><td>  <b>for</b> (<em>auto</em>&amp; <dfn class="local col7 decl" id="57pair" title='pair' data-type='std::pair&lt;xla::ShapeIndex, bool &amp;&gt; &amp;' data-ref="57pair">pair</dfn> : *<a class="local col4 ref" href="#54indices_to_copy" title='indices_to_copy' data-ref="54indices_to_copy">indices_to_copy</a>) {</td></tr>
<tr><th id="187">187</th><td>    <em>const</em> <a class="type" href="../shape_util.h.html#xla::ShapeIndex" title='xla::ShapeIndex' data-ref="xla::ShapeIndex">ShapeIndex</a>&amp; <dfn class="local col8 decl" id="58index" title='index' data-type='const xla::ShapeIndex &amp;' data-ref="58index">index</dfn> = <a class="local col7 ref" href="#57pair" title='pair' data-ref="57pair">pair</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_pair.h.html#std::pair::first" title='std::pair&lt;xla::ShapeIndex, bool &amp;&gt;::first' data-ref="std::pair::first">first</a>;</td></tr>
<tr><th id="188">188</th><td>    <em>bool</em>&amp; <dfn class="local col9 decl" id="59should_copy" title='should_copy' data-type='bool &amp;' data-ref="59should_copy">should_copy</dfn> = <a class="local col7 ref" href="#57pair" title='pair' data-ref="57pair">pair</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_pair.h.html#std::pair::second" title='std::pair&lt;xla::ShapeIndex, bool &amp;&gt;::second' data-ref="std::pair::second">second</a>;</td></tr>
<tr><th id="189">189</th><td>    <i>// If there is any ambiguity, then loop state must be copied.</i></td></tr>
<tr><th id="190">190</th><td>    <b>if</b> (<a class="local col2 ref" href="#52dataflow" title='dataflow' data-ref="52dataflow">dataflow</a>.<a class="ref" href="hlo_dataflow_analysis.h.html#_ZNK3xla19HloDataflowAnalysis11GetValueSetEPKNS_14HloInstructionERKNS_10ShapeIndexE" title='xla::HloDataflowAnalysis::GetValueSet' data-ref="_ZNK3xla19HloDataflowAnalysis11GetValueSetEPKNS_14HloInstructionERKNS_10ShapeIndexE">GetValueSet</a>(<a class="local col6 ref" href="#56init" title='init' data-ref="56init">init</a>, <a class="local col8 ref" href="#58index" title='index' data-ref="58index">index</a>).<a class="ref" href="hlo_value.h.html#_ZNK3xla11HloValueSet6valuesEv" title='xla::HloValueSet::values' data-ref="_ZNK3xla11HloValueSet6valuesEv">values</a>().<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNKSt6vector4sizeEv" title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv">size</a>() &gt; <var>1</var> ||</td></tr>
<tr><th id="191">191</th><td>        <a class="local col2 ref" href="#52dataflow" title='dataflow' data-ref="52dataflow">dataflow</a>.<a class="ref" href="hlo_dataflow_analysis.h.html#_ZNK3xla19HloDataflowAnalysis11GetValueSetEPKNS_14HloInstructionERKNS_10ShapeIndexE" title='xla::HloDataflowAnalysis::GetValueSet' data-ref="_ZNK3xla19HloDataflowAnalysis11GetValueSetEPKNS_14HloInstructionERKNS_10ShapeIndexE">GetValueSet</a>(<a class="local col3 ref" href="#53xla_while" title='xla_while' data-ref="53xla_while">xla_while</a>, <a class="local col8 ref" href="#58index" title='index' data-ref="58index">index</a>).<a class="ref" href="hlo_value.h.html#_ZNK3xla11HloValueSet6valuesEv" title='xla::HloValueSet::values' data-ref="_ZNK3xla11HloValueSet6valuesEv">values</a>().<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNKSt6vector4sizeEv" title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv">size</a>() &gt; <var>1</var>) {</td></tr>
<tr><th id="192">192</th><td>      <a class="local col9 ref" href="#59should_copy" title='should_copy' data-ref="59should_copy">should_copy</a> = <b>true</b>;</td></tr>
<tr><th id="193">193</th><td>    } <b>else</b> {</td></tr>
<tr><th id="194">194</th><td>      <i>// If the output of the while instruction is not the same as the init</i></td></tr>
<tr><th id="195">195</th><td><i>      // value of the while, then this element is not passed through the body</i></td></tr>
<tr><th id="196">196</th><td><i>      // transparently and must be copied.</i></td></tr>
<tr><th id="197">197</th><td>      <a class="local col9 ref" href="#59should_copy" title='should_copy' data-ref="59should_copy">should_copy</a> = <a class="local col2 ref" href="#52dataflow" title='dataflow' data-ref="52dataflow">dataflow</a>.<a class="ref" href="hlo_dataflow_analysis.h.html#_ZNK3xla19HloDataflowAnalysis16GetUniqueValueAtEPKNS_14HloInstructionERKNS_10ShapeIndexE" title='xla::HloDataflowAnalysis::GetUniqueValueAt' data-ref="_ZNK3xla19HloDataflowAnalysis16GetUniqueValueAtEPKNS_14HloInstructionERKNS_10ShapeIndexE">GetUniqueValueAt</a>(<a class="local col3 ref" href="#53xla_while" title='xla_while' data-ref="53xla_while">xla_while</a>, <a class="local col8 ref" href="#58index" title='index' data-ref="58index">index</a>) <a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValueneERKS0_" title='xla::HloValue::operator!=' data-ref="_ZNK3xla8HloValueneERKS0_">!=</a></td></tr>
<tr><th id="198">198</th><td>                    <a class="local col2 ref" href="#52dataflow" title='dataflow' data-ref="52dataflow">dataflow</a>.<a class="ref" href="hlo_dataflow_analysis.h.html#_ZNK3xla19HloDataflowAnalysis16GetUniqueValueAtEPKNS_14HloInstructionERKNS_10ShapeIndexE" title='xla::HloDataflowAnalysis::GetUniqueValueAt' data-ref="_ZNK3xla19HloDataflowAnalysis16GetUniqueValueAtEPKNS_14HloInstructionERKNS_10ShapeIndexE">GetUniqueValueAt</a>(<a class="local col6 ref" href="#56init" title='init' data-ref="56init">init</a>, <a class="local col8 ref" href="#58index" title='index' data-ref="58index">index</a>);</td></tr>
<tr><th id="199">199</th><td>    }</td></tr>
<tr><th id="200">200</th><td>    <a class="local col5 ref" href="#55any_copies" title='any_copies' data-ref="55any_copies">any_copies</a> |= <a class="local col9 ref" href="#59should_copy" title='should_copy' data-ref="59should_copy">should_copy</a>;</td></tr>
<tr><th id="201">201</th><td>  }</td></tr>
<tr><th id="202">202</th><td>  <b>return</b> <a class="local col5 ref" href="#55any_copies" title='any_copies' data-ref="55any_copies">any_copies</a>;</td></tr>
<tr><th id="203">203</th><td>}</td></tr>
<tr><th id="204">204</th><td></td></tr>
<tr><th id="205">205</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">// Add kCopy instructions around the given kWhile instruction to eliminate any</i></td></tr>
<tr><th id="206">206</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">// possible live range interference of HLO values assuming a dependency-based</i></td></tr>
<tr><th id="207">207</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">// ordering (HloDependencyOrdering). Copies are added conservatively. There</i></td></tr>
<tr><th id="208">208</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">// likely are copies which are not strictly necessary, but there are removed</i></td></tr>
<tr><th id="209">209</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">// later in the pass via CopyRemover.</i></td></tr>
<tr><th id="210">210</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//</i></td></tr>
<tr><th id="211">211</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//</i></td></tr>
<tr><th id="212">212</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">// Elements (each ShapeIndex) in the loop state are considered independently.  A</i></td></tr>
<tr><th id="213">213</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">// copy is added to each element of the loop state which is modified in the</i></td></tr>
<tr><th id="214">214</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">// while body. For each such element, a total of three kCopy instructions are</i></td></tr>
<tr><th id="215">215</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">// added at following locations:</i></td></tr>
<tr><th id="216">216</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//</i></td></tr>
<tr><th id="217">217</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//   (1) The init value is copied before the kWhile instruction. Before:</i></td></tr>
<tr><th id="218">218</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//</i></td></tr>
<tr><th id="219">219</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//           (Init)</i></td></tr>
<tr><th id="220">220</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//             |</i></td></tr>
<tr><th id="221">221</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//           kWhile</i></td></tr>
<tr><th id="222">222</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//             |</i></td></tr>
<tr><th id="223">223</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//            ...</i></td></tr>
<tr><th id="224">224</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//</i></td></tr>
<tr><th id="225">225</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//       After:</i></td></tr>
<tr><th id="226">226</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//</i></td></tr>
<tr><th id="227">227</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//           (Init)</i></td></tr>
<tr><th id="228">228</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//             |</i></td></tr>
<tr><th id="229">229</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//           kCopy</i></td></tr>
<tr><th id="230">230</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//             |</i></td></tr>
<tr><th id="231">231</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//           kWhile</i></td></tr>
<tr><th id="232">232</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//             |</i></td></tr>
<tr><th id="233">233</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//            ...</i></td></tr>
<tr><th id="234">234</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//</i></td></tr>
<tr><th id="235">235</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//       This copy is necessary in case the init value is simultaneously live</i></td></tr>
<tr><th id="236">236</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//       with the kWhile.</i></td></tr>
<tr><th id="237">237</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//</i></td></tr>
<tr><th id="238">238</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//   (2) Copies are added to the parameter and root of the while body</i></td></tr>
<tr><th id="239">239</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//       computation. Before:</i></td></tr>
<tr><th id="240">240</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//</i></td></tr>
<tr><th id="241">241</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//           kParameter</i></td></tr>
<tr><th id="242">242</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//               |</i></td></tr>
<tr><th id="243">243</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//              ...</i></td></tr>
<tr><th id="244">244</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//               |</i></td></tr>
<tr><th id="245">245</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//           (body root)</i></td></tr>
<tr><th id="246">246</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//</i></td></tr>
<tr><th id="247">247</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//       After:</i></td></tr>
<tr><th id="248">248</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//</i></td></tr>
<tr><th id="249">249</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//           kParameter</i></td></tr>
<tr><th id="250">250</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//               |</i></td></tr>
<tr><th id="251">251</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//             kCopy ----------+</i></td></tr>
<tr><th id="252">252</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//               |             |</i></td></tr>
<tr><th id="253">253</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//              ...           ctrl</i></td></tr>
<tr><th id="254">254</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//               |            edge</i></td></tr>
<tr><th id="255">255</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//           (body root)       |</i></td></tr>
<tr><th id="256">256</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//               |             |</i></td></tr>
<tr><th id="257">257</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//             kCopy &lt;---------+</i></td></tr>
<tr><th id="258">258</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//</i></td></tr>
<tr><th id="259">259</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//       The root kCopy becomes the new root of the computation. Both copies are</i></td></tr>
<tr><th id="260">260</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//       necessary to any potential interference between the parameter value and</i></td></tr>
<tr><th id="261">261</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//       the root value. The control edge prevents potential interference</i></td></tr>
<tr><th id="262">262</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//       between the copies themselves.</i></td></tr>
<tr><th id="263">263</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">//</i></td></tr>
<tr><th id="264">264</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">// If the loop state is a tuple then the above kCopy instructions are a deep</i></td></tr>
<tr><th id="265">265</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">// copy constructed of kCopy, KGetTupleElement, and kTuple instruction as</i></td></tr>
<tr><th id="266">266</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">// constructed by HloInstruction::DeepCopyInstruction.</i></td></tr>
<tr><th id="267">267</th><td><a class="type" href="../../../core/lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a> <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE" title='xla::(anonymous namespace)::AddCopiesForWhile' data-type='tensorflow::Status xla::(anonymous namespace)::AddCopiesForWhile(const xla::HloAliasAnalysis &amp; alias_analysis, xla::HloInstruction * xla_while)' data-ref="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">AddCopiesForWhile</dfn>(<em>const</em> <a class="type" href="hlo_alias_analysis.h.html#xla::HloAliasAnalysis" title='xla::HloAliasAnalysis' data-ref="xla::HloAliasAnalysis">HloAliasAnalysis</a>&amp; <dfn class="local col0 decl" id="60alias_analysis" title='alias_analysis' data-type='const xla::HloAliasAnalysis &amp;' data-ref="60alias_analysis">alias_analysis</dfn>,</td></tr>
<tr><th id="268">268</th><td>                         <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col1 decl" id="61xla_while" title='xla_while' data-type='xla::HloInstruction *' data-ref="61xla_while">xla_while</dfn>) {</td></tr>
<tr><th id="269">269</th><td>  <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((2) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 269, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>2</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <q>"Adding copies for kWhile instruction "</q> <a class="ref" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E">&lt;&lt;</a> <a class="local col1 ref" href="#61xla_while" title='xla_while' data-ref="61xla_while">xla_while</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction4nameEv" title='xla::HloInstruction::name' data-ref="_ZNK3xla14HloInstruction4nameEv">name</a>();</td></tr>
<tr><th id="270">270</th><td>  <a class="macro" href="../status_macros.h.html#179" title="while ((__builtin_expect(!(xla_while-&gt;opcode() == HloOpcode::kWhile), 0))) return xla::status_macros::MakeErrorStream(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 270, tensorflow::error::INTERNAL) .with_log_stack_trace() .add_ret_check_failure(&quot;xla_while-&gt;opcode() == HloOpcode::kWhile&quot;)" data-ref="_M/TF_RET_CHECK">TF_RET_CHECK</a>(<a class="local col1 ref" href="#61xla_while" title='xla_while' data-ref="61xla_while">xla_while</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction6opcodeEv" title='xla::HloInstruction::opcode' data-ref="_ZNK3xla14HloInstruction6opcodeEv">opcode</a>() == <a class="type" href="hlo_opcode.h.html#xla::HloOpcode" title='xla::HloOpcode' data-ref="xla::HloOpcode">HloOpcode</a>::<a class="enum" href="hlo_opcode.h.html#135" title='xla::HloOpcode::kWhile' data-ref="xla::HloOpcode::kWhile">kWhile</a>);</td></tr>
<tr><th id="271">271</th><td></td></tr>
<tr><th id="272">272</th><td>  <a class="type" href="../shape_tree.h.html#xla::ShapeTree" title='xla::ShapeTree' data-ref="xla::ShapeTree">ShapeTree</a>&lt;<em>bool</em>&gt; <dfn class="local col2 decl" id="62indices_to_copy" title='indices_to_copy' data-type='ShapeTree&lt;bool&gt;' data-ref="62indices_to_copy">indices_to_copy</dfn><a class="ref" href="../shape_tree.h.html#_ZN3xla9ShapeTreeC1ENS_5ShapeE" title='xla::ShapeTree::ShapeTree&lt;T&gt;' data-ref="_ZN3xla9ShapeTreeC1ENS_5ShapeE">(</a><span class='ref fake' title='xla::Shape::Shape' data-ref="_ZN3xla5ShapeC1ERKS0_"></span><a class="local col1 ref" href="#61xla_while" title='xla_while' data-ref="61xla_while">xla_while</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction5shapeEv" title='xla::HloInstruction::shape' data-ref="_ZNK3xla14HloInstruction5shapeEv">shape</a>());</td></tr>
<tr><th id="273">273</th><td>  <b>if</b> (!<a class="tu ref" href="#_ZN3xla12_GLOBAL__N_121IndicesToCopyForWhileERKNS_19HloDataflowAnalysisEPKNS_14HloInstructionEPNS_9ShapeTreeIbEE" title='xla::(anonymous namespace)::IndicesToCopyForWhile' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_121IndicesToCopyForWhileERKNS_19HloDataflowAnalysisEPKNS_14HloInstructionEPNS_9ShapeTreeIbEE">IndicesToCopyForWhile</a>(<a class="local col0 ref" href="#60alias_analysis" title='alias_analysis' data-ref="60alias_analysis">alias_analysis</a>.<a class="ref" href="hlo_alias_analysis.h.html#_ZNK3xla16HloAliasAnalysis17dataflow_analysisEv" title='xla::HloAliasAnalysis::dataflow_analysis' data-ref="_ZNK3xla16HloAliasAnalysis17dataflow_analysisEv">dataflow_analysis</a>(), <a class="local col1 ref" href="#61xla_while" title='xla_while' data-ref="61xla_while">xla_while</a>,</td></tr>
<tr><th id="274">274</th><td>                             &amp;<a class="local col2 ref" href="#62indices_to_copy" title='indices_to_copy' data-ref="62indices_to_copy">indices_to_copy</a>)) {</td></tr>
<tr><th id="275">275</th><td>    <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((2) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 275, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>2</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <q>"No copies necessary for kWhile instruction "</q></td></tr>
<tr><th id="276">276</th><td>            <a class="ref" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E">&lt;&lt;</a> <a class="local col1 ref" href="#61xla_while" title='xla_while' data-ref="61xla_while">xla_while</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction4nameEv" title='xla::HloInstruction::name' data-ref="_ZNK3xla14HloInstruction4nameEv">name</a>();</td></tr>
<tr><th id="277">277</th><td>    <b>return</b> <a class="type" href="../../../core/lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a>::<a class="ref" href="../../../core/lib/core/status.h.html#_ZN10tensorflow6Status2OKEv" title='tensorflow::Status::OK' data-ref="_ZN10tensorflow6Status2OKEv">OK</a>();</td></tr>
<tr><th id="278">278</th><td>  }</td></tr>
<tr><th id="279">279</th><td></td></tr>
<tr><th id="280">280</th><td>  <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((2) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 280, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>2</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <q>"Adding copies for "</q> <a class="ref" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E">&lt;&lt;</a> <a class="local col1 ref" href="#61xla_while" title='xla_while' data-ref="61xla_while">xla_while</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction4nameEv" title='xla::HloInstruction::name' data-ref="_ZNK3xla14HloInstruction4nameEv">name</a>() <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsRSt13basic_ostreamIcT_EPKc" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIcT_EPKc">&lt;&lt;</a> <q>" at indices:"</q>;</td></tr>
<tr><th id="281">281</th><td>  <b>for</b> (<em>auto</em>&amp; <dfn class="local col3 decl" id="63pair" title='pair' data-type='std::pair&lt;xla::ShapeIndex, bool &amp;&gt; &amp;' data-ref="63pair">pair</dfn> : <a class="local col2 ref" href="#62indices_to_copy" title='indices_to_copy' data-ref="62indices_to_copy">indices_to_copy</a>) {</td></tr>
<tr><th id="282">282</th><td>    <b>if</b> (<a class="local col3 ref" href="#63pair" title='pair' data-ref="63pair">pair</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_pair.h.html#std::pair::second" title='std::pair&lt;xla::ShapeIndex, bool &amp;&gt;::second' data-ref="std::pair::second">second</a>) {</td></tr>
<tr><th id="283">283</th><td>      <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((2) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 283, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>2</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <q>"  "</q> <a class="ref" href="../shape_util.h.html#_ZN3xlalsERSoRKNS_10ShapeIndexE" title='xla::operator&lt;&lt;' data-ref="_ZN3xlalsERSoRKNS_10ShapeIndexE">&lt;&lt;</a> <a class="local col3 ref" href="#63pair" title='pair' data-ref="63pair">pair</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_pair.h.html#std::pair::first" title='std::pair&lt;xla::ShapeIndex, bool &amp;&gt;::first' data-ref="std::pair::first">first</a>;</td></tr>
<tr><th id="284">284</th><td>    }</td></tr>
<tr><th id="285">285</th><td>  }</td></tr>
<tr><th id="286">286</th><td></td></tr>
<tr><th id="287">287</th><td>  <i>// Deep copy init.</i></td></tr>
<tr><th id="288">288</th><td>  <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col4 decl" id="64while_init" title='while_init' data-type='xla::HloInstruction *' data-ref="64while_init">while_init</dfn> = <a class="local col1 ref" href="#61xla_while" title='xla_while' data-ref="61xla_while">xla_while</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZN3xla14HloInstruction15mutable_operandEx" title='xla::HloInstruction::mutable_operand' data-ref="_ZN3xla14HloInstruction15mutable_operandEx">mutable_operand</a>(<var>0</var>);</td></tr>
<tr><th id="289">289</th><td>  <a class="macro" href="../status_macros.h.html#199" title="auto _status_or_value5 = (xla_while-&gt;parent()-&gt;DeepCopyInstruction(while_init, &amp;indices_to_copy)); if ((__builtin_expect(!_status_or_value5.ok(), 0))) { return _status_or_value5.status(); } HloInstruction * while_init_copy = std::move(_status_or_value5.ValueOrDie())" data-ref="_M/TF_ASSIGN_OR_RETURN">TF_ASSIGN_OR_RETURN</a>(</td></tr>
<tr><th id="290">290</th><td>      <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a> * <dfn class="local col5 decl" id="65while_init_copy" title='while_init_copy' data-type='xla::HloInstruction *' data-ref="65while_init_copy">while_init_copy</dfn>,</td></tr>
<tr><th id="291">291</th><td>      <a class="local col1 ref" href="#61xla_while" title='xla_while' data-ref="61xla_while">xla_while</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZN3xla14HloInstruction6parentEv" title='xla::HloInstruction::parent' data-ref="_ZN3xla14HloInstruction6parentEv">parent</a>()-&gt;<a class="ref" href="hlo_computation.h.html#_ZN3xla14HloComputation19DeepCopyInstructionEPNS_14HloInstructionEPKNS_9ShapeTreeIbEEPNS3_IS2_EE" title='xla::HloComputation::DeepCopyInstruction' data-ref="_ZN3xla14HloComputation19DeepCopyInstructionEPNS_14HloInstructionEPKNS_9ShapeTreeIbEEPNS3_IS2_EE">DeepCopyInstruction</a>(<a class="local col4 ref" href="#64while_init" title='while_init' data-ref="64while_init">while_init</a>, &amp;<a class="local col2 ref" href="#62indices_to_copy" title='indices_to_copy' data-ref="62indices_to_copy">indices_to_copy</a>));</td></tr>
<tr><th id="292">292</th><td>  <a class="macro" href="../../../core/lib/core/errors.h.html#69" title="do { const ::tensorflow::Status _status = (while_init-&gt;ReplaceUseWith(xla_while, while_init_copy)); if ((__builtin_expect(!_status.ok(), 0))) return _status; } while (0)" data-ref="_M/TF_RETURN_IF_ERROR">TF_RETURN_IF_ERROR</a>(<a class="local col4 ref" href="#64while_init" title='while_init' data-ref="64while_init">while_init</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZN3xla14HloInstruction14ReplaceUseWithEPS0_S1_" title='xla::HloInstruction::ReplaceUseWith' data-ref="_ZN3xla14HloInstruction14ReplaceUseWithEPS0_S1_">ReplaceUseWith</a>(<a class="local col1 ref" href="#61xla_while" title='xla_while' data-ref="61xla_while">xla_while</a>, <a class="local col5 ref" href="#289" title='while_init_copy' data-ref="65while_init_copy">while_init_copy</a>));</td></tr>
<tr><th id="293">293</th><td></td></tr>
<tr><th id="294">294</th><td>  <i>// Deep copy the parameter and the root. Extend a control edge from the copy</i></td></tr>
<tr><th id="295">295</th><td><i>  // of the parameter value to the corresponding copy value of the root.</i></td></tr>
<tr><th id="296">296</th><td>  <a class="type" href="hlo_computation.h.html#xla::HloComputation" title='xla::HloComputation' data-ref="xla::HloComputation">HloComputation</a>* <dfn class="local col6 decl" id="66body" title='body' data-type='xla::HloComputation *' data-ref="66body">body</dfn> = <a class="local col1 ref" href="#61xla_while" title='xla_while' data-ref="61xla_while">xla_while</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction10while_bodyEv" title='xla::HloInstruction::while_body' data-ref="_ZNK3xla14HloInstruction10while_bodyEv">while_body</a>();</td></tr>
<tr><th id="297">297</th><td>  <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col7 decl" id="67param" title='param' data-type='xla::HloInstruction *' data-ref="67param">param</dfn> = <a class="local col6 ref" href="#66body" title='body' data-ref="66body">body</a>-&gt;<a class="ref" href="hlo_computation.h.html#_ZNK3xla14HloComputation21parameter_instructionEx" title='xla::HloComputation::parameter_instruction' data-ref="_ZNK3xla14HloComputation21parameter_instructionEx">parameter_instruction</a>(<var>0</var>);</td></tr>
<tr><th id="298">298</th><td>  <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col8 decl" id="68root" title='root' data-type='xla::HloInstruction *' data-ref="68root">root</dfn> = <a class="local col6 ref" href="#66body" title='body' data-ref="66body">body</a>-&gt;<a class="ref" href="hlo_computation.h.html#_ZNK3xla14HloComputation16root_instructionEv" title='xla::HloComputation::root_instruction' data-ref="_ZNK3xla14HloComputation16root_instructionEv">root_instruction</a>();</td></tr>
<tr><th id="299">299</th><td></td></tr>
<tr><th id="300">300</th><td>  <i>// If param is the root then all indices should have been passed through the</i></td></tr>
<tr><th id="301">301</th><td><i>  // while body and we should have returned early above.</i></td></tr>
<tr><th id="302">302</th><td>  <a class="macro" href="../status_macros.h.html#179" title="while ((__builtin_expect(!(param != root), 0))) return xla::status_macros::MakeErrorStream(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 302, tensorflow::error::INTERNAL) .with_log_stack_trace() .add_ret_check_failure(&quot;param != root&quot;)" data-ref="_M/TF_RET_CHECK">TF_RET_CHECK</a>(<a class="local col7 ref" href="#67param" title='param' data-ref="67param">param</a> != <a class="local col8 ref" href="#68root" title='root' data-ref="68root">root</a>);</td></tr>
<tr><th id="303">303</th><td></td></tr>
<tr><th id="304">304</th><td>  <i>// Copy users before making a deep copy of the parameter as the deep copy</i></td></tr>
<tr><th id="305">305</th><td><i>  // will create new users of the parameter (eg, the GTE instructions of the</i></td></tr>
<tr><th id="306">306</th><td><i>  // deep copy).</i></td></tr>
<tr><th id="307">307</th><td>  <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>*&gt; <dfn class="local col9 decl" id="69param_users" title='param_users' data-type='std::vector&lt;HloInstruction *&gt;' data-ref="69param_users">param_users</dfn> = <a class="ref fake" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorC1ERKSt6vectorIT_T0_E" title='std::vector::vector&lt;_Tp, _Alloc&gt;' data-ref="_ZNSt6vectorC1ERKSt6vectorIT_T0_E"></a><a class="local col7 ref" href="#67param" title='param' data-ref="67param">param</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction5usersEv" title='xla::HloInstruction::users' data-ref="_ZNK3xla14HloInstruction5usersEv">users</a>();</td></tr>
<tr><th id="308">308</th><td></td></tr>
<tr><th id="309">309</th><td>  <a class="type" href="../shape_util.h.html#xla::ShapeIndex" title='xla::ShapeIndex' data-ref="xla::ShapeIndex">ShapeIndex</a> <a class="ref fake" href="../shape_util.h.html#_ZN3xla10ShapeIndexC1Ev" title='xla::ShapeIndex::ShapeIndex' data-ref="_ZN3xla10ShapeIndexC1Ev"></a><dfn class="local col0 decl" id="70current_index" title='current_index' data-type='xla::ShapeIndex' data-ref="70current_index">current_index</dfn>;</td></tr>
<tr><th id="310">310</th><td>  <a class="macro" href="../status_macros.h.html#199" title="auto _status_or_value7 = (DeepCopyAndAddControlEdges(param, root, indices_to_copy)); if ((__builtin_expect(!_status_or_value7.ok(), 0))) { return _status_or_value7.status(); } auto pair = std::move(_status_or_value7.ValueOrDie())" data-ref="_M/TF_ASSIGN_OR_RETURN">TF_ASSIGN_OR_RETURN</a>(<em>auto</em> <dfn class="local col1 decl" id="71pair" title='pair' data-type='std::pair&lt;xla::HloInstruction *, xla::HloInstruction *&gt;' data-ref="71pair">pair</dfn>,</td></tr>
<tr><th id="311">311</th><td>                      <a class="tu ref" href="#_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE" title='xla::(anonymous namespace)::DeepCopyAndAddControlEdges' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_126DeepCopyAndAddControlEdgesEPNS_14HloInstructionES2_RKNS_9ShapeTreeIbEE">DeepCopyAndAddControlEdges</a>(<a class="local col7 ref" href="#67param" title='param' data-ref="67param">param</a>, <a class="local col8 ref" href="#68root" title='root' data-ref="68root">root</a>, <a class="local col2 ref" href="#62indices_to_copy" title='indices_to_copy' data-ref="62indices_to_copy">indices_to_copy</a>));</td></tr>
<tr><th id="312">312</th><td></td></tr>
<tr><th id="313">313</th><td>  <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col2 decl" id="72param_copy" title='param_copy' data-type='xla::HloInstruction *' data-ref="72param_copy">param_copy</dfn> = <a class="local col1 ref" href="#310" title='pair' data-ref="71pair">pair</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_pair.h.html#std::pair::first" title='std::pair&lt;xla::HloInstruction *, xla::HloInstruction *&gt;::first' data-ref="std::pair::first">first</a>;</td></tr>
<tr><th id="314">314</th><td>  <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col3 decl" id="73root_copy" title='root_copy' data-type='xla::HloInstruction *' data-ref="73root_copy">root_copy</dfn> = <a class="local col1 ref" href="#310" title='pair' data-ref="71pair">pair</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_pair.h.html#std::pair::second" title='std::pair&lt;xla::HloInstruction *, xla::HloInstruction *&gt;::second' data-ref="std::pair::second">second</a>;</td></tr>
<tr><th id="315">315</th><td></td></tr>
<tr><th id="316">316</th><td>  <b>for</b> (<a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col4 decl" id="74user" title='user' data-type='xla::HloInstruction *' data-ref="74user">user</dfn> : <a class="local col9 ref" href="#69param_users" title='param_users' data-ref="69param_users">param_users</a>) {</td></tr>
<tr><th id="317">317</th><td>    <a class="macro" href="../../../core/lib/core/errors.h.html#69" title="do { const ::tensorflow::Status _status = (param-&gt;ReplaceUseWith(user, param_copy)); if ((__builtin_expect(!_status.ok(), 0))) return _status; } while (0)" data-ref="_M/TF_RETURN_IF_ERROR">TF_RETURN_IF_ERROR</a>(<a class="local col7 ref" href="#67param" title='param' data-ref="67param">param</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZN3xla14HloInstruction14ReplaceUseWithEPS0_S1_" title='xla::HloInstruction::ReplaceUseWith' data-ref="_ZN3xla14HloInstruction14ReplaceUseWithEPS0_S1_">ReplaceUseWith</a>(<a class="local col4 ref" href="#74user" title='user' data-ref="74user">user</a>, <a class="local col2 ref" href="#72param_copy" title='param_copy' data-ref="72param_copy">param_copy</a>));</td></tr>
<tr><th id="318">318</th><td>  }</td></tr>
<tr><th id="319">319</th><td></td></tr>
<tr><th id="320">320</th><td>  <a class="local col6 ref" href="#66body" title='body' data-ref="66body">body</a>-&gt;<a class="ref" href="hlo_computation.h.html#_ZN3xla14HloComputation20set_root_instructionEPNS_14HloInstructionE" title='xla::HloComputation::set_root_instruction' data-ref="_ZN3xla14HloComputation20set_root_instructionEPNS_14HloInstructionE">set_root_instruction</a>(<a class="local col3 ref" href="#73root_copy" title='root_copy' data-ref="73root_copy">root_copy</a>);</td></tr>
<tr><th id="321">321</th><td></td></tr>
<tr><th id="322">322</th><td>  <b>return</b> <a class="type" href="../../../core/lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a>::<a class="ref" href="../../../core/lib/core/status.h.html#_ZN10tensorflow6Status2OKEv" title='tensorflow::Status::OK' data-ref="_ZN10tensorflow6Status2OKEv">OK</a>();</td></tr>
<tr><th id="323">323</th><td>}</td></tr>
<tr><th id="324">324</th><td></td></tr>
<tr><th id="325">325</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_123AddCopiesForConditionalERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">// We add copies for all the indices of the true and false computaiton roots,</i></td></tr>
<tr><th id="326">326</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_123AddCopiesForConditionalERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">// in order to resolve interference. We later rely on the CopyRemover to drop</i></td></tr>
<tr><th id="327">327</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_123AddCopiesForConditionalERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">// the unnecessary ones.</i></td></tr>
<tr><th id="328">328</th><td><a class="type" href="../../../core/lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a> <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_123AddCopiesForConditionalERKNS_16HloAliasAnalysisEPNS_14HloInstructionE" title='xla::(anonymous namespace)::AddCopiesForConditional' data-type='tensorflow::Status xla::(anonymous namespace)::AddCopiesForConditional(const xla::HloAliasAnalysis &amp; alias_analysis, xla::HloInstruction * conditional)' data-ref="_ZN3xla12_GLOBAL__N_123AddCopiesForConditionalERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">AddCopiesForConditional</dfn>(<em>const</em> <a class="type" href="hlo_alias_analysis.h.html#xla::HloAliasAnalysis" title='xla::HloAliasAnalysis' data-ref="xla::HloAliasAnalysis">HloAliasAnalysis</a>&amp; <dfn class="local col5 decl" id="75alias_analysis" title='alias_analysis' data-type='const xla::HloAliasAnalysis &amp;' data-ref="75alias_analysis">alias_analysis</dfn>,</td></tr>
<tr><th id="329">329</th><td>                               <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col6 decl" id="76conditional" title='conditional' data-type='xla::HloInstruction *' data-ref="76conditional">conditional</dfn>) {</td></tr>
<tr><th id="330">330</th><td>  <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((2) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 330, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>2</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <q>"Adding copies for kConditional instruction "</q></td></tr>
<tr><th id="331">331</th><td>          <a class="ref" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E">&lt;&lt;</a> <a class="local col6 ref" href="#76conditional" title='conditional' data-ref="76conditional">conditional</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction4nameEv" title='xla::HloInstruction::name' data-ref="_ZNK3xla14HloInstruction4nameEv">name</a>();</td></tr>
<tr><th id="332">332</th><td>  <a class="macro" href="../status_macros.h.html#179" title="while ((__builtin_expect(!(conditional-&gt;opcode() == HloOpcode::kConditional), 0))) return xla::status_macros::MakeErrorStream(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 332, tensorflow::error::INTERNAL) .with_log_stack_trace() .add_ret_check_failure(&quot;conditional-&gt;opcode() == HloOpcode::kConditional&quot;)" data-ref="_M/TF_RET_CHECK">TF_RET_CHECK</a>(<a class="local col6 ref" href="#76conditional" title='conditional' data-ref="76conditional">conditional</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction6opcodeEv" title='xla::HloInstruction::opcode' data-ref="_ZNK3xla14HloInstruction6opcodeEv">opcode</a>() == <a class="type" href="hlo_opcode.h.html#xla::HloOpcode" title='xla::HloOpcode' data-ref="xla::HloOpcode">HloOpcode</a>::<a class="enum" href="hlo_opcode.h.html#135" title='xla::HloOpcode::kConditional' data-ref="xla::HloOpcode::kConditional">kConditional</a>);</td></tr>
<tr><th id="333">333</th><td></td></tr>
<tr><th id="334">334</th><td>  <b>for</b> (<a class="type" href="hlo_computation.h.html#xla::HloComputation" title='xla::HloComputation' data-ref="xla::HloComputation">HloComputation</a>* <dfn class="local col7 decl" id="77computation" title='computation' data-type='xla::HloComputation *' data-ref="77computation">computation</dfn> :</td></tr>
<tr><th id="335">335</th><td>       {<a class="local col6 ref" href="#76conditional" title='conditional' data-ref="76conditional">conditional</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction16true_computationEv" title='xla::HloInstruction::true_computation' data-ref="_ZNK3xla14HloInstruction16true_computationEv">true_computation</a>(), <a class="local col6 ref" href="#76conditional" title='conditional' data-ref="76conditional">conditional</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction17false_computationEv" title='xla::HloInstruction::false_computation' data-ref="_ZNK3xla14HloInstruction17false_computationEv">false_computation</a>()}) {</td></tr>
<tr><th id="336">336</th><td>    <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col8 decl" id="78root" title='root' data-type='xla::HloInstruction *' data-ref="78root">root</dfn> = <a class="local col7 ref" href="#77computation" title='computation' data-ref="77computation">computation</a>-&gt;<a class="ref" href="hlo_computation.h.html#_ZNK3xla14HloComputation16root_instructionEv" title='xla::HloComputation::root_instruction' data-ref="_ZNK3xla14HloComputation16root_instructionEv">root_instruction</a>();</td></tr>
<tr><th id="337">337</th><td>    <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>*&gt; <dfn class="local col9 decl" id="79users" title='users' data-type='std::vector&lt;HloInstruction *&gt;' data-ref="79users">users</dfn> = <a class="ref fake" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorC1ERKSt6vectorIT_T0_E" title='std::vector::vector&lt;_Tp, _Alloc&gt;' data-ref="_ZNSt6vectorC1ERKSt6vectorIT_T0_E"></a><a class="local col8 ref" href="#78root" title='root' data-ref="78root">root</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction5usersEv" title='xla::HloInstruction::users' data-ref="_ZNK3xla14HloInstruction5usersEv">users</a>();</td></tr>
<tr><th id="338">338</th><td>    <a class="macro" href="../status_macros.h.html#199" title="auto _status_or_value9 = (computation-&gt;DeepCopyInstruction(root)); if ((__builtin_expect(!_status_or_value9.ok(), 0))) { return _status_or_value9.status(); } HloInstruction * deep_copy = std::move(_status_or_value9.ValueOrDie())" data-ref="_M/TF_ASSIGN_OR_RETURN">TF_ASSIGN_OR_RETURN</a>(<a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a> * <dfn class="local col0 decl" id="80deep_copy" title='deep_copy' data-type='xla::HloInstruction *' data-ref="80deep_copy">deep_copy</dfn>,</td></tr>
<tr><th id="339">339</th><td>                        <a class="local col7 ref" href="#77computation" title='computation' data-ref="77computation">computation</a>-&gt;<a class="ref" href="hlo_computation.h.html#_ZN3xla14HloComputation19DeepCopyInstructionEPNS_14HloInstructionEPKNS_9ShapeTreeIbEEPNS3_IS2_EE" title='xla::HloComputation::DeepCopyInstruction' data-ref="_ZN3xla14HloComputation19DeepCopyInstructionEPNS_14HloInstructionEPKNS_9ShapeTreeIbEEPNS3_IS2_EE">DeepCopyInstruction</a>(<a class="local col8 ref" href="#78root" title='root' data-ref="78root">root</a>));</td></tr>
<tr><th id="340">340</th><td>    <b>for</b> (<a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col1 decl" id="81user" title='user' data-type='xla::HloInstruction *' data-ref="81user">user</dfn> : <a class="local col9 ref" href="#79users" title='users' data-ref="79users">users</a>) {</td></tr>
<tr><th id="341">341</th><td>      <a class="macro" href="../../../core/lib/core/errors.h.html#69" title="do { const ::tensorflow::Status _status = (root-&gt;ReplaceUseWith(user, deep_copy)); if ((__builtin_expect(!_status.ok(), 0))) return _status; } while (0)" data-ref="_M/TF_RETURN_IF_ERROR">TF_RETURN_IF_ERROR</a>(<a class="local col8 ref" href="#78root" title='root' data-ref="78root">root</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZN3xla14HloInstruction14ReplaceUseWithEPS0_S1_" title='xla::HloInstruction::ReplaceUseWith' data-ref="_ZN3xla14HloInstruction14ReplaceUseWithEPS0_S1_">ReplaceUseWith</a>(<a class="local col1 ref" href="#81user" title='user' data-ref="81user">user</a>, <a class="local col0 ref" href="#338" title='deep_copy' data-ref="80deep_copy">deep_copy</a>));</td></tr>
<tr><th id="342">342</th><td>    }</td></tr>
<tr><th id="343">343</th><td>    <a class="local col7 ref" href="#77computation" title='computation' data-ref="77computation">computation</a>-&gt;<a class="ref" href="hlo_computation.h.html#_ZN3xla14HloComputation20set_root_instructionEPNS_14HloInstructionE" title='xla::HloComputation::set_root_instruction' data-ref="_ZN3xla14HloComputation20set_root_instructionEPNS_14HloInstructionE">set_root_instruction</a>(<a class="local col0 ref" href="#338" title='deep_copy' data-ref="80deep_copy">deep_copy</a>);</td></tr>
<tr><th id="344">344</th><td>  }</td></tr>
<tr><th id="345">345</th><td>  <b>return</b> <a class="type" href="../../../core/lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a>::<a class="ref" href="../../../core/lib/core/status.h.html#_ZN10tensorflow6Status2OKEv" title='tensorflow::Status::OK' data-ref="_ZN10tensorflow6Status2OKEv">OK</a>();</td></tr>
<tr><th id="346">346</th><td>}</td></tr>
<tr><th id="347">347</th><td></td></tr>
<tr><th id="348">348</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_128StripControlDependenciesFromEPNS_14HloInstructionE">// Removes any control dependencies to or from the given instruction.</i></td></tr>
<tr><th id="349">349</th><td><a class="type" href="../../../core/lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a> <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_128StripControlDependenciesFromEPNS_14HloInstructionE" title='xla::(anonymous namespace)::StripControlDependenciesFrom' data-type='tensorflow::Status xla::(anonymous namespace)::StripControlDependenciesFrom(xla::HloInstruction * instruction)' data-ref="_ZN3xla12_GLOBAL__N_128StripControlDependenciesFromEPNS_14HloInstructionE">StripControlDependenciesFrom</dfn>(<a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col2 decl" id="82instruction" title='instruction' data-type='xla::HloInstruction *' data-ref="82instruction">instruction</dfn>) {</td></tr>
<tr><th id="350">350</th><td>  <b>while</b> (!<a class="local col2 ref" href="#82instruction" title='instruction' data-ref="82instruction">instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction18control_successorsEv" title='xla::HloInstruction::control_successors' data-ref="_ZNK3xla14HloInstruction18control_successorsEv">control_successors</a>().<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNKSt6vector5emptyEv" title='std::vector::empty' data-ref="_ZNKSt6vector5emptyEv">empty</a>()) {</td></tr>
<tr><th id="351">351</th><td>    <a class="macro" href="../../../core/lib/core/errors.h.html#69" title="do { const ::tensorflow::Status _status = (instruction-&gt;RemoveControlDependencyTo( instruction-&gt;control_successors().front())); if ((__builtin_expect(!_status.ok(), 0))) return _status; } while (0)" data-ref="_M/TF_RETURN_IF_ERROR">TF_RETURN_IF_ERROR</a>(<a class="local col2 ref" href="#82instruction" title='instruction' data-ref="82instruction">instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZN3xla14HloInstruction25RemoveControlDependencyToEPS0_" title='xla::HloInstruction::RemoveControlDependencyTo' data-ref="_ZN3xla14HloInstruction25RemoveControlDependencyToEPS0_">RemoveControlDependencyTo</a>(</td></tr>
<tr><th id="352">352</th><td>        <a class="local col2 ref" href="#82instruction" title='instruction' data-ref="82instruction">instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction18control_successorsEv" title='xla::HloInstruction::control_successors' data-ref="_ZNK3xla14HloInstruction18control_successorsEv">control_successors</a>().<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNKSt6vector5frontEv" title='std::vector::front' data-ref="_ZNKSt6vector5frontEv">front</a>()));</td></tr>
<tr><th id="353">353</th><td>  }</td></tr>
<tr><th id="354">354</th><td></td></tr>
<tr><th id="355">355</th><td>  <b>while</b> (!<a class="local col2 ref" href="#82instruction" title='instruction' data-ref="82instruction">instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction20control_predecessorsEv" title='xla::HloInstruction::control_predecessors' data-ref="_ZNK3xla14HloInstruction20control_predecessorsEv">control_predecessors</a>().<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNKSt6vector5emptyEv" title='std::vector::empty' data-ref="_ZNKSt6vector5emptyEv">empty</a>()) {</td></tr>
<tr><th id="356">356</th><td>    <a class="macro" href="../../../core/lib/core/errors.h.html#69" title="do { const ::tensorflow::Status _status = (instruction-&gt;control_predecessors().front()-&gt;RemoveControlDependencyTo( instruction)); if ((__builtin_expect(!_status.ok(), 0))) return _status; } while (0)" data-ref="_M/TF_RETURN_IF_ERROR">TF_RETURN_IF_ERROR</a>(</td></tr>
<tr><th id="357">357</th><td>        <a class="local col2 ref" href="#82instruction" title='instruction' data-ref="82instruction">instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction20control_predecessorsEv" title='xla::HloInstruction::control_predecessors' data-ref="_ZNK3xla14HloInstruction20control_predecessorsEv">control_predecessors</a>().<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNKSt6vector5frontEv" title='std::vector::front' data-ref="_ZNKSt6vector5frontEv">front</a>()-&gt;<a class="ref" href="hlo_instruction.h.html#_ZN3xla14HloInstruction25RemoveControlDependencyToEPS0_" title='xla::HloInstruction::RemoveControlDependencyTo' data-ref="_ZN3xla14HloInstruction25RemoveControlDependencyToEPS0_">RemoveControlDependencyTo</a>(</td></tr>
<tr><th id="358">358</th><td>            <a class="local col2 ref" href="#82instruction" title='instruction' data-ref="82instruction">instruction</a>));</td></tr>
<tr><th id="359">359</th><td>  }</td></tr>
<tr><th id="360">360</th><td></td></tr>
<tr><th id="361">361</th><td>  <b>return</b> <a class="type" href="../../../core/lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a>::<a class="ref" href="../../../core/lib/core/status.h.html#_ZN10tensorflow6Status2OKEv" title='tensorflow::Status::OK' data-ref="_ZN10tensorflow6Status2OKEv">OK</a>();</td></tr>
<tr><th id="362">362</th><td>}</td></tr>
<tr><th id="363">363</th><td></td></tr>
<tr><th id="364">364</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_130AddCopiesToResolveInterferenceEPNS_9HloModuleE">// Add kCopy instructions to the given module to guarantee there is no</i></td></tr>
<tr><th id="365">365</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_130AddCopiesToResolveInterferenceEPNS_9HloModuleE">// live-range interference. Generally interference can only occur around kWhile</i></td></tr>
<tr><th id="366">366</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_130AddCopiesToResolveInterferenceEPNS_9HloModuleE">// instructions which have update-in-place semantics.</i></td></tr>
<tr><th id="367">367</th><td><a class="type" href="../../../core/lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a> <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_130AddCopiesToResolveInterferenceEPNS_9HloModuleE" title='xla::(anonymous namespace)::AddCopiesToResolveInterference' data-type='tensorflow::Status xla::(anonymous namespace)::AddCopiesToResolveInterference(xla::HloModule * module)' data-ref="_ZN3xla12_GLOBAL__N_130AddCopiesToResolveInterferenceEPNS_9HloModuleE">AddCopiesToResolveInterference</dfn>(<a class="type" href="hlo_module.h.html#xla::HloModule" title='xla::HloModule' data-ref="xla::HloModule">HloModule</a>* <dfn class="local col3 decl" id="83module" title='module' data-type='xla::HloModule *' data-ref="83module">module</dfn>) {</td></tr>
<tr><th id="368">368</th><td>  <a class="macro" href="../status_macros.h.html#199" title="auto _status_or_value11 = (HloAliasAnalysis::Run(module)); if ((__builtin_expect(!_status_or_value11.ok(), 0))) { return _status_or_value11.status(); } std::unique_ptr&lt;HloAliasAnalysis&gt; alias_analysis = std::move(_status_or_value11.ValueOrDie())" data-ref="_M/TF_ASSIGN_OR_RETURN">TF_ASSIGN_OR_RETURN</a>(std::<a class="type" href="../../../../../include/c++/5/bits/unique_ptr.h.html#std::unique_ptr" title='std::unique_ptr' data-ref="std::unique_ptr">unique_ptr</a>&lt;<a class="type" href="hlo_alias_analysis.h.html#xla::HloAliasAnalysis" title='xla::HloAliasAnalysis' data-ref="xla::HloAliasAnalysis">HloAliasAnalysis</a>&gt; <dfn class="local col4 decl" id="84alias_analysis" title='alias_analysis' data-type='std::unique_ptr&lt;HloAliasAnalysis&gt;' data-ref="84alias_analysis">alias_analysis</dfn>,</td></tr>
<tr><th id="369">369</th><td>                      <a class="type" href="hlo_alias_analysis.h.html#xla::HloAliasAnalysis" title='xla::HloAliasAnalysis' data-ref="xla::HloAliasAnalysis">HloAliasAnalysis</a>::<a class="ref" href="hlo_alias_analysis.h.html#_ZN3xla16HloAliasAnalysis3RunEPNS_9HloModuleE" title='xla::HloAliasAnalysis::Run' data-ref="_ZN3xla16HloAliasAnalysis3RunEPNS_9HloModuleE">Run</a>(<a class="local col3 ref" href="#83module" title='module' data-ref="83module">module</a>));</td></tr>
<tr><th id="370">370</th><td></td></tr>
<tr><th id="371">371</th><td>  <b>for</b> (<a class="type" href="hlo_computation.h.html#xla::HloComputation" title='xla::HloComputation' data-ref="xla::HloComputation">HloComputation</a>* <dfn class="local col5 decl" id="85computation" title='computation' data-type='xla::HloComputation *' data-ref="85computation">computation</dfn> : <a class="local col3 ref" href="#83module" title='module' data-ref="83module">module</a>-&gt;<a class="ref" href="hlo_module.h.html#_ZN3xla9HloModule12computationsEv" title='xla::HloModule::computations' data-ref="_ZN3xla9HloModule12computationsEv">computations</a>()) {</td></tr>
<tr><th id="372">372</th><td>    <b>for</b> (<a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col6 decl" id="86instruction" title='instruction' data-type='xla::HloInstruction *' data-ref="86instruction">instruction</dfn> : <a class="local col5 ref" href="#85computation" title='computation' data-ref="85computation">computation</a>-&gt;<a class="ref" href="hlo_computation.h.html#_ZN3xla14HloComputation12instructionsEv" title='xla::HloComputation::instructions' data-ref="_ZN3xla14HloComputation12instructionsEv">instructions</a>()) {</td></tr>
<tr><th id="373">373</th><td>      <b>if</b> (<a class="local col6 ref" href="#86instruction" title='instruction' data-ref="86instruction">instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction6opcodeEv" title='xla::HloInstruction::opcode' data-ref="_ZNK3xla14HloInstruction6opcodeEv">opcode</a>() == <a class="type" href="hlo_opcode.h.html#xla::HloOpcode" title='xla::HloOpcode' data-ref="xla::HloOpcode">HloOpcode</a>::<a class="enum" href="hlo_opcode.h.html#135" title='xla::HloOpcode::kWhile' data-ref="xla::HloOpcode::kWhile">kWhile</a>) {</td></tr>
<tr><th id="374">374</th><td>        <a class="macro" href="../../../core/lib/core/errors.h.html#69" title="do { const ::tensorflow::Status _status = (AddCopiesForWhile(*alias_analysis, instruction)); if ((__builtin_expect(!_status.ok(), 0))) return _status; } while (0)" data-ref="_M/TF_RETURN_IF_ERROR">TF_RETURN_IF_ERROR</a>(<a class="tu ref" href="#_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE" title='xla::(anonymous namespace)::AddCopiesForWhile' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_117AddCopiesForWhileERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">AddCopiesForWhile</a>(<a class="ref" href="../../../../../include/c++/5/bits/unique_ptr.h.html#_ZNKSt10unique_ptrdeEv" title='std::unique_ptr::operator*' data-ref="_ZNKSt10unique_ptrdeEv">*</a><a class="local col4 ref" href="#368" title='alias_analysis' data-ref="84alias_analysis">alias_analysis</a>, <a class="local col6 ref" href="#86instruction" title='instruction' data-ref="86instruction">instruction</a>));</td></tr>
<tr><th id="375">375</th><td>      } <b>else</b> <b>if</b> (<a class="local col6 ref" href="#86instruction" title='instruction' data-ref="86instruction">instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction6opcodeEv" title='xla::HloInstruction::opcode' data-ref="_ZNK3xla14HloInstruction6opcodeEv">opcode</a>() == <a class="type" href="hlo_opcode.h.html#xla::HloOpcode" title='xla::HloOpcode' data-ref="xla::HloOpcode">HloOpcode</a>::<a class="enum" href="hlo_opcode.h.html#135" title='xla::HloOpcode::kConditional' data-ref="xla::HloOpcode::kConditional">kConditional</a>) {</td></tr>
<tr><th id="376">376</th><td>        <a class="macro" href="../../../core/lib/core/errors.h.html#69" title="do { const ::tensorflow::Status _status = (AddCopiesForConditional(*alias_analysis, instruction)); if ((__builtin_expect(!_status.ok(), 0))) return _status; } while (0)" data-ref="_M/TF_RETURN_IF_ERROR">TF_RETURN_IF_ERROR</a>(</td></tr>
<tr><th id="377">377</th><td>            <a class="tu ref" href="#_ZN3xla12_GLOBAL__N_123AddCopiesForConditionalERKNS_16HloAliasAnalysisEPNS_14HloInstructionE" title='xla::(anonymous namespace)::AddCopiesForConditional' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_123AddCopiesForConditionalERKNS_16HloAliasAnalysisEPNS_14HloInstructionE">AddCopiesForConditional</a>(<a class="ref" href="../../../../../include/c++/5/bits/unique_ptr.h.html#_ZNKSt10unique_ptrdeEv" title='std::unique_ptr::operator*' data-ref="_ZNKSt10unique_ptrdeEv">*</a><a class="local col4 ref" href="#368" title='alias_analysis' data-ref="84alias_analysis">alias_analysis</a>, <a class="local col6 ref" href="#86instruction" title='instruction' data-ref="86instruction">instruction</a>));</td></tr>
<tr><th id="378">378</th><td>      }</td></tr>
<tr><th id="379">379</th><td>    }</td></tr>
<tr><th id="380">380</th><td>  }</td></tr>
<tr><th id="381">381</th><td>  <b>return</b> <a class="type" href="../../../core/lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a>::<a class="ref" href="../../../core/lib/core/status.h.html#_ZN10tensorflow6Status2OKEv" title='tensorflow::Status::OK' data-ref="_ZN10tensorflow6Status2OKEv">OK</a>();</td></tr>
<tr><th id="382">382</th><td>}</td></tr>
<tr><th id="383">383</th><td></td></tr>
<tr><th id="384">384</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover">// Class for removing unnecessary copies from the module.</i></td></tr>
<tr><th id="385">385</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover">//</i></td></tr>
<tr><th id="386">386</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover">// kCopy instructions are added conservatively to guarantee no live range</i></td></tr>
<tr><th id="387">387</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover">// interference between HLO values. This class uses a more fine-grained analysis</i></td></tr>
<tr><th id="388">388</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover">// to remove some of these added copies which are not strictly necessary.</i></td></tr>
<tr><th id="389">389</th><td><b>class</b> <dfn class="tu type def" id="xla::(anonymousnamespace)::CopyRemover" title='xla::(anonymous namespace)::CopyRemover' data-ref="xla::(anonymousnamespace)::CopyRemover">CopyRemover</dfn> {</td></tr>
<tr><th id="390">390</th><td> <b>public</b>:</td></tr>
<tr><th id="391">391</th><td>  <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_111CopyRemoverC1ERKNS_16HloAliasAnalysisERKNS_11HloOrderingEPNS_9HloModuleE" title='xla::(anonymous namespace)::CopyRemover::CopyRemover' data-type='void xla::(anonymous namespace)::CopyRemover::CopyRemover(const xla::HloAliasAnalysis &amp; alias_analysis, const xla::HloOrdering &amp; ordering, xla::HloModule * module)' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemoverC1ERKNS_16HloAliasAnalysisERKNS_11HloOrderingEPNS_9HloModuleE">CopyRemover</dfn>(<em>const</em> <a class="type" href="hlo_alias_analysis.h.html#xla::HloAliasAnalysis" title='xla::HloAliasAnalysis' data-ref="xla::HloAliasAnalysis">HloAliasAnalysis</a>&amp; <dfn class="local col7 decl" id="87alias_analysis" title='alias_analysis' data-type='const xla::HloAliasAnalysis &amp;' data-ref="87alias_analysis">alias_analysis</dfn>,</td></tr>
<tr><th id="392">392</th><td>              <em>const</em> <a class="type" href="hlo_ordering.h.html#xla::HloOrdering" title='xla::HloOrdering' data-ref="xla::HloOrdering">HloOrdering</a>&amp; <dfn class="local col8 decl" id="88ordering" title='ordering' data-type='const xla::HloOrdering &amp;' data-ref="88ordering">ordering</dfn>, <a class="type" href="hlo_module.h.html#xla::HloModule" title='xla::HloModule' data-ref="xla::HloModule">HloModule</a>* <dfn class="local col9 decl" id="89module" title='module' data-type='xla::HloModule *' data-ref="89module">module</dfn>)</td></tr>
<tr><th id="393">393</th><td>      : <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::module_" title='xla::(anonymous namespace)::CopyRemover::module_' data-use='w' data-ref="xla::(anonymousnamespace)::CopyRemover::module_">module_</a>(<a class="local col9 ref" href="#89module" title='module' data-ref="89module">module</a>),</td></tr>
<tr><th id="394">394</th><td>        <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::alias_analysis_" title='xla::(anonymous namespace)::CopyRemover::alias_analysis_' data-use='w' data-ref="xla::(anonymousnamespace)::CopyRemover::alias_analysis_">alias_analysis_</a>(<a class="local col7 ref" href="#87alias_analysis" title='alias_analysis' data-ref="87alias_analysis">alias_analysis</a>),</td></tr>
<tr><th id="395">395</th><td>        <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::ordering_" title='xla::(anonymous namespace)::CopyRemover::ordering_' data-use='w' data-ref="xla::(anonymousnamespace)::CopyRemover::ordering_">ordering_</a>(<a class="local col8 ref" href="#88ordering" title='ordering' data-ref="88ordering">ordering</a>),</td></tr>
<tr><th id="396">396</th><td>        <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::buffer_value_tracker_" title='xla::(anonymous namespace)::CopyRemover::buffer_value_tracker_' data-use='w' data-ref="xla::(anonymousnamespace)::CopyRemover::buffer_value_tracker_">buffer_value_tracker_</a><a class="tu ref" href="#_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTrackerC1ERKNS_9HloModuleERKNS_16HloAliasAnalysisERKNS_11HloOrderingE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::BufferValueTracker' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTrackerC1ERKNS_9HloModuleERKNS_16HloAliasAnalysisERKNS_11HloOrderingE">(</a>*<a class="local col9 ref" href="#89module" title='module' data-ref="89module">module</a>, <a class="local col7 ref" href="#87alias_analysis" title='alias_analysis' data-ref="87alias_analysis">alias_analysis</a>, <a class="local col8 ref" href="#88ordering" title='ordering' data-ref="88ordering">ordering</a>) {}</td></tr>
<tr><th id="397">397</th><td></td></tr>
<tr><th id="398">398</th><td>  <i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover12TryElideCopyEPNS_14HloInstructionE">// Try to elide the given copy. The copy is elided if the instruction is not</i></td></tr>
<tr><th id="399">399</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover12TryElideCopyEPNS_14HloInstructionE">  // necessary to prevent live-range interference of HLO values. Returns true if</i></td></tr>
<tr><th id="400">400</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover12TryElideCopyEPNS_14HloInstructionE">  // copy was elided.</i></td></tr>
<tr><th id="401">401</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover12TryElideCopyEPNS_14HloInstructionE">  //</i></td></tr>
<tr><th id="402">402</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover12TryElideCopyEPNS_14HloInstructionE">  // The copy instruction is not actually removed here. Instead it is left for</i></td></tr>
<tr><th id="403">403</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover12TryElideCopyEPNS_14HloInstructionE">  // dead in the graph. Later calls to DCE will remove the instruction.</i></td></tr>
<tr><th id="404">404</th><td>  <a class="type" href="../statusor.h.html#xla::StatusOr" title='xla::StatusOr' data-ref="xla::StatusOr">StatusOr</a>&lt;<em>bool</em>&gt; <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_111CopyRemover12TryElideCopyEPNS_14HloInstructionE" title='xla::(anonymous namespace)::CopyRemover::TryElideCopy' data-type='StatusOr&lt;bool&gt; xla::(anonymous namespace)::CopyRemover::TryElideCopy(xla::HloInstruction * copy)' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemover12TryElideCopyEPNS_14HloInstructionE">TryElideCopy</dfn>(<a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col0 decl" id="90copy" title='copy' data-type='xla::HloInstruction *' data-ref="90copy">copy</dfn>) {</td></tr>
<tr><th id="405">405</th><td>    <b>if</b> (<a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::buffer_value_tracker_" title='xla::(anonymous namespace)::CopyRemover::buffer_value_tracker_' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::buffer_value_tracker_">buffer_value_tracker_</a>.<a class="tu ref" href="#_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12TryElideCopyEPKNS_14HloInstructionE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::TryElideCopy' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12TryElideCopyEPKNS_14HloInstructionE">TryElideCopy</a>(<a class="local col0 ref" href="#90copy" title='copy' data-ref="90copy">copy</a>)) {</td></tr>
<tr><th id="406">406</th><td>      <a class="macro" href="../../../core/lib/core/errors.h.html#69" title="do { const ::tensorflow::Status _status = (StripControlDependenciesFrom(copy)); if ((__builtin_expect(!_status.ok(), 0))) return _status; } while (0)" data-ref="_M/TF_RETURN_IF_ERROR">TF_RETURN_IF_ERROR</a>(<a class="tu ref" href="#_ZN3xla12_GLOBAL__N_128StripControlDependenciesFromEPNS_14HloInstructionE" title='xla::(anonymous namespace)::StripControlDependenciesFrom' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_128StripControlDependenciesFromEPNS_14HloInstructionE">StripControlDependenciesFrom</a>(<a class="local col0 ref" href="#90copy" title='copy' data-ref="90copy">copy</a>));</td></tr>
<tr><th id="407">407</th><td>      <a class="macro" href="../../../core/lib/core/errors.h.html#69" title="do { const ::tensorflow::Status _status = (copy-&gt;ReplaceAllUsesWith(copy-&gt;mutable_operand(0))); if ((__builtin_expect(!_status.ok(), 0))) return _status; } while (0)" data-ref="_M/TF_RETURN_IF_ERROR">TF_RETURN_IF_ERROR</a>(<a class="local col0 ref" href="#90copy" title='copy' data-ref="90copy">copy</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZN3xla14HloInstruction18ReplaceAllUsesWithEPS0_" title='xla::HloInstruction::ReplaceAllUsesWith' data-ref="_ZN3xla14HloInstruction18ReplaceAllUsesWithEPS0_">ReplaceAllUsesWith</a>(<a class="local col0 ref" href="#90copy" title='copy' data-ref="90copy">copy</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZN3xla14HloInstruction15mutable_operandEx" title='xla::HloInstruction::mutable_operand' data-ref="_ZN3xla14HloInstruction15mutable_operandEx">mutable_operand</a>(<var>0</var>)));</td></tr>
<tr><th id="408">408</th><td>      <b>return</b> <a class="ref fake" href="../statusor.h.html#_ZN3xla8StatusOrC1EOT_" title='xla::StatusOr::StatusOr&lt;T&gt;' data-ref="_ZN3xla8StatusOrC1EOT_"></a><b>true</b>;</td></tr>
<tr><th id="409">409</th><td>    }</td></tr>
<tr><th id="410">410</th><td>    <b>return</b> <a class="ref fake" href="../statusor.h.html#_ZN3xla8StatusOrC1EOT_" title='xla::StatusOr::StatusOr&lt;T&gt;' data-ref="_ZN3xla8StatusOrC1EOT_"></a><b>false</b>;</td></tr>
<tr><th id="411">411</th><td>  }</td></tr>
<tr><th id="412">412</th><td></td></tr>
<tr><th id="413">413</th><td>  <a class="typedef" href="../../../../../include/c++/5/bits/stringfwd.h.html#std::string" title='std::string' data-type='basic_string&lt;char&gt;' data-ref="std::string">string</a> <dfn class="tu decl def" id="_ZNK3xla12_GLOBAL__N_111CopyRemover8ToStringEv" title='xla::(anonymous namespace)::CopyRemover::ToString' data-type='string xla::(anonymous namespace)::CopyRemover::ToString() const' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover8ToStringEv">ToString</dfn>() <em>const</em> {</td></tr>
<tr><th id="414">414</th><td>    <a class="typedef" href="../../../../../include/c++/5/bits/stringfwd.h.html#std::string" title='std::string' data-type='basic_string&lt;char&gt;' data-ref="std::string">string</a> <dfn class="local col1 decl" id="91out" title='out' data-type='string' data-ref="91out">out</dfn> = <a class="ref" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings6StrCatERKNS0_8AlphaNumES3_S3_" title='tensorflow::strings::StrCat' data-ref="_ZN10tensorflow7strings6StrCatERKNS0_8AlphaNumES3_S3_">StrCat</a>(<a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1EPKc" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1EPKc"></a><q>"CopyRemover, module "</q>, <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1ERKSs" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1ERKSs"></a><a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::module_" title='xla::(anonymous namespace)::CopyRemover::module_' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::module_">module_</a>-&gt;<a class="ref" href="hlo_module.h.html#_ZNK3xla9HloModule4nameEv" title='xla::HloModule::name' data-ref="_ZNK3xla9HloModule4nameEv">name</a>(), <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1EPKc" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1EPKc"></a><q>"\n"</q>);</td></tr>
<tr><th id="415">415</th><td>    <a class="ref" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings9StrAppendEPSsRKNS0_8AlphaNumE" title='tensorflow::strings::StrAppend' data-ref="_ZN10tensorflow7strings9StrAppendEPSsRKNS0_8AlphaNumE">StrAppend</a>(&amp;<a class="local col1 ref" href="#91out" title='out' data-ref="91out">out</a>, <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1EPKc" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1EPKc"></a><q>"  Buffer values, in dependency order:\n"</q>);</td></tr>
<tr><th id="416">416</th><td>    <b>for</b> (<em>const</em> <a class="type" href="hlo_buffer.h.html#xla::HloBuffer" title='xla::HloBuffer' data-ref="xla::HloBuffer">HloBuffer</a>&amp; <dfn class="local col2 decl" id="92buffer" title='buffer' data-type='const xla::HloBuffer &amp;' data-ref="92buffer">buffer</dfn> : <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::alias_analysis_" title='xla::(anonymous namespace)::CopyRemover::alias_analysis_' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::alias_analysis_">alias_analysis_</a>.<a class="ref" href="hlo_alias_analysis.h.html#_ZNK3xla16HloAliasAnalysis7buffersEv" title='xla::HloAliasAnalysis::buffers' data-ref="_ZNK3xla16HloAliasAnalysis7buffersEv">buffers</a>()) {</td></tr>
<tr><th id="417">417</th><td>      <a class="ref" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings9StrAppendEPSsRKNS0_8AlphaNumES4_S4_" title='tensorflow::strings::StrAppend' data-ref="_ZN10tensorflow7strings9StrAppendEPSsRKNS0_8AlphaNumES4_S4_">StrAppend</a>(&amp;<a class="local col1 ref" href="#91out" title='out' data-ref="91out">out</a>, <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1EPKc" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1EPKc"></a><q>"    HloBuffer "</q>, <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1Ex" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1Ex"></a><a class="local col2 ref" href="#92buffer" title='buffer' data-ref="92buffer">buffer</a>.<a class="ref" href="hlo_buffer.h.html#_ZNK3xla9HloBuffer2idEv" title='xla::HloBuffer::id' data-ref="_ZNK3xla9HloBuffer2idEv">id</a>(), <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1EPKc" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1EPKc"></a><q>":\n"</q>);</td></tr>
<tr><th id="418">418</th><td>    }</td></tr>
<tr><th id="419">419</th><td>    <b>return</b> <a class="local col1 ref" href="#91out" title='out' data-ref="91out">out</a>;</td></tr>
<tr><th id="420">420</th><td>  }</td></tr>
<tr><th id="421">421</th><td></td></tr>
<tr><th id="422">422</th><td> <b>private</b>:</td></tr>
<tr><th id="423">423</th><td>  <i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker">// Class which tracks the HLO values within each HLO buffer in the module</i></td></tr>
<tr><th id="424">424</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker">  // during copy removal.</i></td></tr>
<tr><th id="425">425</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker">  //</i></td></tr>
<tr><th id="426">426</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker">  // The values are held in a linked list where there is one list for each</i></td></tr>
<tr><th id="427">427</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker">  // buffer. Removing a copy instruction merges together the values in the</i></td></tr>
<tr><th id="428">428</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker">  // source buffer of the copy to the destination buffer of the copy. This class</i></td></tr>
<tr><th id="429">429</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker">  // tracks these value lists as copies are removed from the graph (and value</i></td></tr>
<tr><th id="430">430</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker">  // lists are merged).</i></td></tr>
<tr><th id="431">431</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker">  //</i></td></tr>
<tr><th id="432">432</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker">  // The BufferValueTracker object is initialized to match the state of</i></td></tr>
<tr><th id="433">433</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker">  // HloAliasAnalysis. However, as copies are removed this state diverges. The</i></td></tr>
<tr><th id="434">434</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker">  // values-to-buffer mapping is maintained outside of HloAliasAnalysis because</i></td></tr>
<tr><th id="435">435</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker">  // a fully updatable alias analysis is very slow.</i></td></tr>
<tr><th id="436">436</th><td>  <b>class</b> <dfn class="tu type def" id="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker">BufferValueTracker</dfn> {</td></tr>
<tr><th id="437">437</th><td>   <b>public</b>:</td></tr>
<tr><th id="438">438</th><td>    <i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">// The values held in a single HLO buffer are represented using a linked</i></td></tr>
<tr><th id="439">439</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">    // list. An element type in this list is ValueNode.</i></td></tr>
<tr><th id="440">440</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">    //</i></td></tr>
<tr><th id="441">441</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">    // This linked list is hand-rolled to enable efficient splicing of lists</i></td></tr>
<tr><th id="442">442</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">    // using only references to list elements without knowing which lists are</i></td></tr>
<tr><th id="443">443</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">    // being spliced. std::list requires a reference to the list object to</i></td></tr>
<tr><th id="444">444</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">    // splice.</i></td></tr>
<tr><th id="445">445</th><td>    <b>struct</b> <dfn class="tu type def" id="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</dfn> {</td></tr>
<tr><th id="446">446</th><td>      <b>explicit</b> <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker9ValueNodeC1EPKNS_8HloValueE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::ValueNode' data-type='void xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::ValueNode(const xla::HloValue * v)' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker9ValueNodeC1EPKNS_8HloValueE">ValueNode</dfn>(<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValue" title='xla::HloValue' data-ref="xla::HloValue">HloValue</a>* <dfn class="local col3 decl" id="93v" title='v' data-type='const xla::HloValue *' data-ref="93v">v</dfn>) : <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='w' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>(<a class="local col3 ref" href="#93v" title='v' data-ref="93v">v</a>) {}</td></tr>
<tr><th id="447">447</th><td></td></tr>
<tr><th id="448">448</th><td>      <em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValue" title='xla::HloValue' data-ref="xla::HloValue">HloValue</a>* <dfn class="tu decl" id="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-type='const xla::HloValue *' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</dfn>;</td></tr>
<tr><th id="449">449</th><td></td></tr>
<tr><th id="450">450</th><td>      <i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses">// The uses are maintained outside of HloValue::uses() because</i></td></tr>
<tr><th id="451">451</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses">      // HloValue::uses() is not updatable (a fully updatable dataflow analysis</i></td></tr>
<tr><th id="452">452</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses">      // is slow).</i></td></tr>
<tr><th id="453">453</th><td>      <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloUse" title='xla::HloUse' data-ref="xla::HloUse">HloUse</a>*&gt; <dfn class="tu decl" id="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::uses' data-type='std::vector&lt;const HloUse *&gt;' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses">uses</dfn>;</td></tr>
<tr><th id="454">454</th><td></td></tr>
<tr><th id="455">455</th><td>      <i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev">// next/prev elements in the linked list. The list is circularly linked so</i></td></tr>
<tr><th id="456">456</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev">      // these values are never null for elements in the list.</i></td></tr>
<tr><th id="457">457</th><td>      <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="tu decl" id="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::prev' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev">prev</dfn> = <b>nullptr</b>;</td></tr>
<tr><th id="458">458</th><td>      <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="tu decl" id="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::next' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next">next</dfn> = <b>nullptr</b>;</td></tr>
<tr><th id="459">459</th><td>    };</td></tr>
<tr><th id="460">460</th><td></td></tr>
<tr><th id="461">461</th><td>    <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTrackerC1ERKNS_9HloModuleERKNS_16HloAliasAnalysisERKNS_11HloOrderingE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::BufferValueTracker' data-type='void xla::(anonymous namespace)::CopyRemover::BufferValueTracker::BufferValueTracker(const xla::HloModule &amp; module, const xla::HloAliasAnalysis &amp; alias_analysis, const xla::HloOrdering &amp; ordering)' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTrackerC1ERKNS_9HloModuleERKNS_16HloAliasAnalysisERKNS_11HloOrderingE">BufferValueTracker</dfn>(<em>const</em> <a class="type" href="hlo_module.h.html#xla::HloModule" title='xla::HloModule' data-ref="xla::HloModule">HloModule</a>&amp; <dfn class="local col4 decl" id="94module" title='module' data-type='const xla::HloModule &amp;' data-ref="94module">module</dfn>,</td></tr>
<tr><th id="462">462</th><td>                       <em>const</em> <a class="type" href="hlo_alias_analysis.h.html#xla::HloAliasAnalysis" title='xla::HloAliasAnalysis' data-ref="xla::HloAliasAnalysis">HloAliasAnalysis</a>&amp; <dfn class="local col5 decl" id="95alias_analysis" title='alias_analysis' data-type='const xla::HloAliasAnalysis &amp;' data-ref="95alias_analysis">alias_analysis</dfn>,</td></tr>
<tr><th id="463">463</th><td>                       <em>const</em> <a class="type" href="hlo_ordering.h.html#xla::HloOrdering" title='xla::HloOrdering' data-ref="xla::HloOrdering">HloOrdering</a>&amp; <dfn class="local col6 decl" id="96ordering" title='ordering' data-type='const xla::HloOrdering &amp;' data-ref="96ordering">ordering</dfn>)</td></tr>
<tr><th id="464">464</th><td>        : <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::dataflow_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::dataflow_' data-use='w' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::dataflow_">dataflow_</a>(<a class="local col5 ref" href="#95alias_analysis" title='alias_analysis' data-ref="95alias_analysis">alias_analysis</a>.<a class="ref" href="hlo_alias_analysis.h.html#_ZNK3xla16HloAliasAnalysis17dataflow_analysisEv" title='xla::HloAliasAnalysis::dataflow_analysis' data-ref="_ZNK3xla16HloAliasAnalysis17dataflow_analysisEv">dataflow_analysis</a>()), <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ordering_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ordering_' data-use='w' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ordering_">ordering_</a>(<a class="local col6 ref" href="#96ordering" title='ordering' data-ref="96ordering">ordering</a>) {</td></tr>
<tr><th id="465">465</th><td>      <i>// Construct a list for each HLO buffer in the alias analysis. Maintain a</i></td></tr>
<tr><th id="466">466</th><td><i>      // map from HloValue to the respective list element representing that</i></td></tr>
<tr><th id="467">467</th><td><i>      // value. The map is used to construct the copy info map below.</i></td></tr>
<tr><th id="468">468</th><td>      <span class="namespace">tensorflow::gtl::</span><a class="type" href="../../../core/lib/gtl/flatmap.h.html#tensorflow::gtl::FlatMap" title='tensorflow::gtl::FlatMap' data-ref="tensorflow::gtl::FlatMap">FlatMap</a>&lt;<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValue" title='xla::HloValue' data-ref="xla::HloValue">HloValue</a>*, <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>*&gt; <a class="tu ref fake" href="../../../core/lib/gtl/flatmap.h.html#_ZN10tensorflow3gtl7FlatMapC1Ev" title='tensorflow::gtl::FlatMap::FlatMap&lt;Key, Val, Hash, Eq&gt;' data-use='c' data-ref="_ZN10tensorflow3gtl7FlatMapC1Ev"></a><dfn class="local col7 decl" id="97value_to_node" title='value_to_node' data-type='tensorflow::gtl::FlatMap&lt;const HloValue *, ValueNode *&gt;' data-ref="97value_to_node">value_to_node</dfn>;</td></tr>
<tr><th id="469">469</th><td>      <b>for</b> (<em>const</em> <a class="type" href="hlo_buffer.h.html#xla::HloBuffer" title='xla::HloBuffer' data-ref="xla::HloBuffer">HloBuffer</a>&amp; <dfn class="local col8 decl" id="98buffer" title='buffer' data-type='const xla::HloBuffer &amp;' data-ref="98buffer">buffer</dfn> : <a class="local col5 ref" href="#95alias_analysis" title='alias_analysis' data-ref="95alias_analysis">alias_analysis</a>.<a class="ref" href="hlo_alias_analysis.h.html#_ZNK3xla16HloAliasAnalysis7buffersEv" title='xla::HloAliasAnalysis::buffers' data-ref="_ZNK3xla16HloAliasAnalysis7buffersEv">buffers</a>()) {</td></tr>
<tr><th id="470">470</th><td>        <i>// Verify values contained in the buffer are strictly ordered. This</i></td></tr>
<tr><th id="471">471</th><td><i>        // should always be the case after adding copies to eliminate</i></td></tr>
<tr><th id="472">472</th><td><i>        // interference. Specifically, the addition of the control flow edges</i></td></tr>
<tr><th id="473">473</th><td><i>        // between copies added around aliased operations (kWhile) guarantees</i></td></tr>
<tr><th id="474">474</th><td><i>        // this strict order.</i></td></tr>
<tr><th id="475">475</th><td>        <b>for</b> (<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValue" title='xla::HloValue' data-ref="xla::HloValue">HloValue</a>* <dfn class="local col9 decl" id="99value_a" title='value_a' data-type='const xla::HloValue *' data-ref="99value_a">value_a</dfn> : <a class="local col8 ref" href="#98buffer" title='buffer' data-ref="98buffer">buffer</a>.<a class="ref" href="hlo_buffer.h.html#_ZNK3xla9HloBuffer6valuesEv" title='xla::HloBuffer::values' data-ref="_ZNK3xla9HloBuffer6valuesEv">values</a>()) {</td></tr>
<tr><th id="476">476</th><td>          <b>for</b> (<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValue" title='xla::HloValue' data-ref="xla::HloValue">HloValue</a>* <dfn class="local col0 decl" id="100value_b" title='value_b' data-type='const xla::HloValue *' data-ref="100value_b">value_b</dfn> : <a class="local col8 ref" href="#98buffer" title='buffer' data-ref="98buffer">buffer</a>.<a class="ref" href="hlo_buffer.h.html#_ZNK3xla9HloBuffer6valuesEv" title='xla::HloBuffer::values' data-ref="_ZNK3xla9HloBuffer6valuesEv">values</a>()) {</td></tr>
<tr><th id="477">477</th><td>            <b>if</b> (<a class="local col9 ref" href="#99value_a" title='value_a' data-ref="99value_a">value_a</a> != <a class="local col0 ref" href="#100value_b" title='value_b' data-ref="100value_b">value_b</a>) {</td></tr>
<tr><th id="478">478</th><td>              <a class="macro" href="../../../core/platform/default/logging.h.html#273" title="while (false &amp;&amp; (ordering_.LiveRangeStrictlyBefore(*value_a, *value_b, dataflow_) || ordering_.LiveRangeStrictlyBefore(*value_b, *value_a, dataflow_))) ::tensorflow::internal::LogMessageFatal(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 481)" data-ref="_M/DCHECK">DCHECK</a>(<a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ordering_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ordering_' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ordering_">ordering_</a>.<a class="ref" href="hlo_ordering.h.html#_ZNK3xla11HloOrdering23LiveRangeStrictlyBeforeERKNS_8HloValueES3_RKNS_19HloDataflowAnalysisE" title='xla::HloOrdering::LiveRangeStrictlyBefore' data-ref="_ZNK3xla11HloOrdering23LiveRangeStrictlyBeforeERKNS_8HloValueES3_RKNS_19HloDataflowAnalysisE">LiveRangeStrictlyBefore</a>(*<a class="local col9 ref" href="#99value_a" title='value_a' data-ref="99value_a">value_a</a>, *<a class="local col0 ref" href="#100value_b" title='value_b' data-ref="100value_b">value_b</a>,</td></tr>
<tr><th id="479">479</th><td>                                                       <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::dataflow_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::dataflow_' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::dataflow_">dataflow_</a>) ||</td></tr>
<tr><th id="480">480</th><td>                     <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ordering_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ordering_' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ordering_">ordering_</a>.<a class="ref" href="hlo_ordering.h.html#_ZNK3xla11HloOrdering23LiveRangeStrictlyBeforeERKNS_8HloValueES3_RKNS_19HloDataflowAnalysisE" title='xla::HloOrdering::LiveRangeStrictlyBefore' data-ref="_ZNK3xla11HloOrdering23LiveRangeStrictlyBeforeERKNS_8HloValueES3_RKNS_19HloDataflowAnalysisE">LiveRangeStrictlyBefore</a>(*<a class="local col0 ref" href="#100value_b" title='value_b' data-ref="100value_b">value_b</a>, *<a class="local col9 ref" href="#99value_a" title='value_a' data-ref="99value_a">value_a</a>,</td></tr>
<tr><th id="481">481</th><td>                                                       <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::dataflow_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::dataflow_' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::dataflow_">dataflow_</a>))</td></tr>
<tr><th id="482">482</th><td>                  <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <a class="local col9 ref" href="#99value_a" title='value_a' data-ref="99value_a">value_a</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue13ToShortStringEv" title='xla::HloValue::ToShortString' data-ref="_ZNK3xla8HloValue13ToShortStringEv">ToShortString</a>() <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsRSt13basic_ostreamIcT_EPKc" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIcT_EPKc">&lt;&lt;</a> <q>" and "</q></td></tr>
<tr><th id="483">483</th><td>                  <a class="ref" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E">&lt;&lt;</a> <a class="local col0 ref" href="#100value_b" title='value_b' data-ref="100value_b">value_b</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue13ToShortStringEv" title='xla::HloValue::ToShortString' data-ref="_ZNK3xla8HloValue13ToShortStringEv">ToShortString</a>() <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsRSt13basic_ostreamIcT_EPKc" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIcT_EPKc">&lt;&lt;</a> <q>" are not ordered"</q>;</td></tr>
<tr><th id="484">484</th><td>            }</td></tr>
<tr><th id="485">485</th><td>          }</td></tr>
<tr><th id="486">486</th><td>        }</td></tr>
<tr><th id="487">487</th><td></td></tr>
<tr><th id="488">488</th><td>        <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValue" title='xla::HloValue' data-ref="xla::HloValue">HloValue</a>*&gt; <dfn class="local col1 decl" id="101values" title='values' data-type='std::vector&lt;const HloValue *&gt;' data-ref="101values">values</dfn> = <a class="ref fake" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorC1ERKSt6vectorIT_T0_E" title='std::vector::vector&lt;_Tp, _Alloc&gt;' data-ref="_ZNSt6vectorC1ERKSt6vectorIT_T0_E"></a><a class="local col8 ref" href="#98buffer" title='buffer' data-ref="98buffer">buffer</a>.<a class="ref" href="hlo_buffer.h.html#_ZNK3xla9HloBuffer6valuesEv" title='xla::HloBuffer::values' data-ref="_ZNK3xla9HloBuffer6valuesEv">values</a>();</td></tr>
<tr><th id="489">489</th><td>        <span class="namespace">std::</span><a class="tu ref" href="../../../../../include/c++/5/bits/stl_algo.h.html#_ZSt4sortT_S_T0_" title='std::sort' data-use='c' data-ref="_ZSt4sortT_S_T0_">sort</a>(<a class="local col1 ref" href="#101values" title='values' data-ref="101values">values</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vector5beginEv" title='std::vector::begin' data-ref="_ZNSt6vector5beginEv">begin</a>(), <a class="local col1 ref" href="#101values" title='values' data-ref="101values">values</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vector3endEv" title='std::vector::end' data-ref="_ZNSt6vector3endEv">end</a>(),</td></tr>
<tr><th id="490">490</th><td>                  [<b>this</b>](<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValue" title='xla::HloValue' data-ref="xla::HloValue">HloValue</a>* <dfn class="local col2 decl" id="102a" title='a' data-type='const xla::HloValue *' data-ref="102a">a</dfn>, <em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValue" title='xla::HloValue' data-ref="xla::HloValue">HloValue</a>* <dfn class="local col3 decl" id="103b" title='b' data-type='const xla::HloValue *' data-ref="103b">b</dfn>) {</td></tr>
<tr><th id="491">491</th><td>                    <b>return</b> <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ordering_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ordering_' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ordering_">ordering_</a>.<a class="ref" href="hlo_ordering.h.html#_ZNK3xla11HloOrdering15IsDefinedBeforeERKNS_8HloValueES3_" title='xla::HloOrdering::IsDefinedBefore' data-ref="_ZNK3xla11HloOrdering15IsDefinedBeforeERKNS_8HloValueES3_">IsDefinedBefore</a>(*<a class="local col2 ref" href="#102a" title='a' data-ref="102a">a</a>, *<a class="local col3 ref" href="#103b" title='b' data-ref="103b">b</a>);</td></tr>
<tr><th id="492">492</th><td>                  });</td></tr>
<tr><th id="493">493</th><td></td></tr>
<tr><th id="494">494</th><td>        <i>// Create a list containing all of the values in the buffer.</i></td></tr>
<tr><th id="495">495</th><td>        <a class="tu member" href="#_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12AddValueListEN10tensorflow3gtl10ArraySliceIPKNS_8HloValueEEEPNS4_7FlatMapIS8_PNS2_9ValueNodeEN12439270" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::AddValueList' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12AddValueListEN10tensorflow3gtl10ArraySliceIPKNS_8HloValueEEEPNS4_7FlatMapIS8_PNS2_9ValueNodeEN12439270">AddValueList</a>(<a class="ref fake" href="../../../core/lib/gtl/array_slice.h.html#_ZN10tensorflow3gtl10ArraySliceC1ERKSt6vectorIT_SaIS3_EE" title='tensorflow::gtl::ArraySlice::ArraySlice&lt;T&gt;' data-ref="_ZN10tensorflow3gtl10ArraySliceC1ERKSt6vectorIT_SaIS3_EE"></a><a class="local col1 ref" href="#101values" title='values' data-ref="101values">values</a>, &amp;<a class="local col7 ref" href="#97value_to_node" title='value_to_node' data-ref="97value_to_node">value_to_node</a>);</td></tr>
<tr><th id="496">496</th><td>      }</td></tr>
<tr><th id="497">497</th><td></td></tr>
<tr><th id="498">498</th><td>      <i>// Create copy_map_ which contains the source and destination values</i></td></tr>
<tr><th id="499">499</th><td><i>      // of all copies.</i></td></tr>
<tr><th id="500">500</th><td>      <a class="tu member" href="#_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker13CreateCopyMapERKNS_9HloModuleERKN10tensorflow3gtl7FlatMapIPKNS_8HloValueEPNS2_9ValueNodeENS6_47323195" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CreateCopyMap' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker13CreateCopyMapERKNS_9HloModuleERKN10tensorflow3gtl7FlatMapIPKNS_8HloValueEPNS2_9ValueNodeENS6_47323195">CreateCopyMap</a>(<a class="local col4 ref" href="#94module" title='module' data-ref="94module">module</a>, <a class="local col7 ref" href="#97value_to_node" title='value_to_node' data-ref="97value_to_node">value_to_node</a>);</td></tr>
<tr><th id="501">501</th><td></td></tr>
<tr><th id="502">502</th><td>      <a class="macro" href="../util.h.html#536" title="do { if (((3) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel())) ::xla::LogLines(::tensorflow::INFO, ToString(), &quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 502); } while (false);" data-ref="_M/XLA_VLOG_LINES">XLA_VLOG_LINES</a>(<var>3</var>, <a class="ref fake" href="../../../core/lib/core/stringpiece.h.html#_ZN10tensorflow11StringPieceC1ERKSs" title='tensorflow::StringPiece::StringPiece' data-ref="_ZN10tensorflow11StringPieceC1ERKSs"></a><a class="tu member" href="#_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker8ToStringEv" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ToString' data-use='c' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker8ToStringEv">ToString</a>());</td></tr>
<tr><th id="503">503</th><td>      <a class="macro" href="../../../core/lib/core/status.h.html#142" title="while (false &amp;&amp; (::tensorflow::Status::OK() == (Verify()))) ::tensorflow::internal::LogMessageFatal(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 503)" data-ref="_M/TF_DCHECK_OK">TF_DCHECK_OK</a>(<a class="tu member" href="#_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6VerifyEv" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::Verify' data-use='c' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6VerifyEv">Verify</a>());</td></tr>
<tr><th id="504">504</th><td>    }</td></tr>
<tr><th id="505">505</th><td></td></tr>
<tr><th id="506">506</th><td>    <i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12AddValueListEN10tensorflow3gtl10ArraySliceIPKNS_8HloValueEEEPNS4_7FlatMapIS8_PNS2_9ValueNodeEN12439270">// Add a list containing the given values to BufferValueTracker. This</i></td></tr>
<tr><th id="507">507</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12AddValueListEN10tensorflow3gtl10ArraySliceIPKNS_8HloValueEEEPNS4_7FlatMapIS8_PNS2_9ValueNodeEN12439270">    // represents the values contained in a single buffer. For each value in</i></td></tr>
<tr><th id="508">508</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12AddValueListEN10tensorflow3gtl10ArraySliceIPKNS_8HloValueEEEPNS4_7FlatMapIS8_PNS2_9ValueNodeEN12439270">    // 'values' an entry is created in value_to_node which indicates the</i></td></tr>
<tr><th id="509">509</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12AddValueListEN10tensorflow3gtl10ArraySliceIPKNS_8HloValueEEEPNS4_7FlatMapIS8_PNS2_9ValueNodeEN12439270">    // respective ValueNode representing that value.</i></td></tr>
<tr><th id="510">510</th><td>    <em>void</em> <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12AddValueListEN10tensorflow3gtl10ArraySliceIPKNS_8HloValueEEEPNS4_7FlatMapIS8_PNS2_9ValueNodeEN12439270" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::AddValueList' data-type='void xla::(anonymous namespace)::CopyRemover::BufferValueTracker::AddValueList(tensorflow::gtl::ArraySlice&lt;const HloValue *&gt; values, tensorflow::gtl::FlatMap&lt;const HloValue *, ValueNode *&gt; * value_to_node)' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12AddValueListEN10tensorflow3gtl10ArraySliceIPKNS_8HloValueEEEPNS4_7FlatMapIS8_PNS2_9ValueNodeEN12439270">AddValueList</dfn>(</td></tr>
<tr><th id="511">511</th><td>        <span class="namespace">tensorflow::gtl::</span><a class="type" href="../../../core/lib/gtl/array_slice.h.html#tensorflow::gtl::ArraySlice" title='tensorflow::gtl::ArraySlice' data-ref="tensorflow::gtl::ArraySlice">ArraySlice</a>&lt;<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValue" title='xla::HloValue' data-ref="xla::HloValue">HloValue</a>*&gt; <dfn class="local col4 decl" id="104values" title='values' data-type='tensorflow::gtl::ArraySlice&lt;const HloValue *&gt;' data-ref="104values">values</dfn>,</td></tr>
<tr><th id="512">512</th><td>        <span class="namespace">tensorflow::gtl::</span><a class="type" href="../../../core/lib/gtl/flatmap.h.html#tensorflow::gtl::FlatMap" title='tensorflow::gtl::FlatMap' data-ref="tensorflow::gtl::FlatMap">FlatMap</a>&lt;<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValue" title='xla::HloValue' data-ref="xla::HloValue">HloValue</a>*, <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>*&gt;* <dfn class="local col5 decl" id="105value_to_node" title='value_to_node' data-type='tensorflow::gtl::FlatMap&lt;const HloValue *, ValueNode *&gt; *' data-ref="105value_to_node">value_to_node</dfn>) {</td></tr>
<tr><th id="513">513</th><td>      <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col6 decl" id="106tail" title='tail' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="106tail">tail</dfn> = <b>nullptr</b>;</td></tr>
<tr><th id="514">514</th><td>      <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col7 decl" id="107head" title='head' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="107head">head</dfn> = <b>nullptr</b>;</td></tr>
<tr><th id="515">515</th><td>      <b>for</b> (<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValue" title='xla::HloValue' data-ref="xla::HloValue">HloValue</a>* <dfn class="local col8 decl" id="108value" title='value' data-type='const xla::HloValue *' data-ref="108value">value</dfn> : <a class="local col4 ref" href="#104values" title='values' data-ref="104values">values</a>) {</td></tr>
<tr><th id="516">516</th><td>        <em>auto</em> <dfn class="local col9 decl" id="109new_node" title='new_node' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="109new_node">new_node</dfn> = <b>new</b> <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a><a class="tu ref" href="#_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker9ValueNodeC1EPKNS_8HloValueE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::ValueNode' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker9ValueNodeC1EPKNS_8HloValueE">(</a><a class="local col8 ref" href="#108value" title='value' data-ref="108value">value</a>);</td></tr>
<tr><th id="517">517</th><td>        (*<a class="local col5 ref" href="#105value_to_node" title='value_to_node' data-ref="105value_to_node">value_to_node</a>)<a class="tu ref" href="../../../core/lib/gtl/flatmap.h.html#_ZN10tensorflow3gtl7FlatMapixERKT_" title='tensorflow::gtl::FlatMap::operator[]' data-use='c' data-ref="_ZN10tensorflow3gtl7FlatMapixERKT_">[<a class="local col8 ref" href="#108value" title='value' data-ref="108value">value</a>]</a> = <a class="local col9 ref" href="#109new_node" title='new_node' data-ref="109new_node">new_node</a>;</td></tr>
<tr><th id="518">518</th><td></td></tr>
<tr><th id="519">519</th><td>        <i>// Copy the HLO values's uses into the ValueNode for the value. These</i></td></tr>
<tr><th id="520">520</th><td><i>        // uses in ValueNode are updated as copies are removed.</i></td></tr>
<tr><th id="521">521</th><td>        <a class="local col9 ref" href="#109new_node" title='new_node' data-ref="109new_node">new_node</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::uses' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses">uses</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vector7reserveEm" title='std::vector::reserve' data-ref="_ZNSt6vector7reserveEm">reserve</a>(<a class="local col8 ref" href="#108value" title='value' data-ref="108value">value</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue4usesEv" title='xla::HloValue::uses' data-ref="_ZNK3xla8HloValue4usesEv">uses</a>().<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNKSt6vector4sizeEv" title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv">size</a>());</td></tr>
<tr><th id="522">522</th><td>        <b>for</b> (<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloUse" title='xla::HloUse' data-ref="xla::HloUse">HloUse</a>&amp; <dfn class="local col0 decl" id="110use" title='use' data-type='const xla::HloUse &amp;' data-ref="110use">use</dfn> : <a class="local col8 ref" href="#108value" title='value' data-ref="108value">value</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue4usesEv" title='xla::HloValue::uses' data-ref="_ZNK3xla8HloValue4usesEv">uses</a>()) {</td></tr>
<tr><th id="523">523</th><td>          <a class="local col9 ref" href="#109new_node" title='new_node' data-ref="109new_node">new_node</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::uses' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses">uses</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vector9push_backEOT_" title='std::vector::push_back' data-ref="_ZNSt6vector9push_backEOT_">push_back</a>(&amp;<a class="local col0 ref" href="#110use" title='use' data-ref="110use">use</a>);</td></tr>
<tr><th id="524">524</th><td>        }</td></tr>
<tr><th id="525">525</th><td></td></tr>
<tr><th id="526">526</th><td>        <i>// Connect the new node into the linked list.</i></td></tr>
<tr><th id="527">527</th><td>        <b>if</b> (<a class="local col6 ref" href="#106tail" title='tail' data-ref="106tail">tail</a> == <b>nullptr</b>) {</td></tr>
<tr><th id="528">528</th><td>          <a class="local col7 ref" href="#107head" title='head' data-ref="107head">head</a> = <a class="local col9 ref" href="#109new_node" title='new_node' data-ref="109new_node">new_node</a>;</td></tr>
<tr><th id="529">529</th><td>        } <b>else</b> {</td></tr>
<tr><th id="530">530</th><td>          <a class="local col6 ref" href="#106tail" title='tail' data-ref="106tail">tail</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::next' data-use='w' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next">next</a> = <a class="local col9 ref" href="#109new_node" title='new_node' data-ref="109new_node">new_node</a>;</td></tr>
<tr><th id="531">531</th><td>          <a class="local col9 ref" href="#109new_node" title='new_node' data-ref="109new_node">new_node</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::prev' data-use='w' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev">prev</a> = <a class="local col6 ref" href="#106tail" title='tail' data-ref="106tail">tail</a>;</td></tr>
<tr><th id="532">532</th><td>        }</td></tr>
<tr><th id="533">533</th><td>        <a class="local col6 ref" href="#106tail" title='tail' data-ref="106tail">tail</a> = <a class="local col9 ref" href="#109new_node" title='new_node' data-ref="109new_node">new_node</a>;</td></tr>
<tr><th id="534">534</th><td>      }</td></tr>
<tr><th id="535">535</th><td></td></tr>
<tr><th id="536">536</th><td>      <i>// The linked list is circular so connect the head and tail.</i></td></tr>
<tr><th id="537">537</th><td>      <a class="local col6 ref" href="#106tail" title='tail' data-ref="106tail">tail</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::next' data-use='w' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next">next</a> = <a class="local col7 ref" href="#107head" title='head' data-ref="107head">head</a>;</td></tr>
<tr><th id="538">538</th><td>      <a class="local col7 ref" href="#107head" title='head' data-ref="107head">head</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::prev' data-use='w' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev">prev</a> = <a class="local col6 ref" href="#106tail" title='tail' data-ref="106tail">tail</a>;</td></tr>
<tr><th id="539">539</th><td>      <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::value_lists_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::value_lists_' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::value_lists_">value_lists_</a>.<a class="tu ref" href="../../../core/lib/gtl/flatset.h.html#_ZN10tensorflow3gtl7FlatSet6insertERKT_" title='tensorflow::gtl::FlatSet::insert' data-use='c' data-ref="_ZN10tensorflow3gtl7FlatSet6insertERKT_">insert</a>(<a class="local col7 ref" href="#107head" title='head' data-ref="107head">head</a>);</td></tr>
<tr><th id="540">540</th><td>    }</td></tr>
<tr><th id="541">541</th><td></td></tr>
<tr><th id="542">542</th><td>    <i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker13CreateCopyMapERKNS_9HloModuleERKN10tensorflow3gtl7FlatMapIPKNS_8HloValueEPNS2_9ValueNodeENS6_47323195">// This method also fills in copy_map_ which indicates which nodes</i></td></tr>
<tr><th id="543">543</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker13CreateCopyMapERKNS_9HloModuleERKN10tensorflow3gtl7FlatMapIPKNS_8HloValueEPNS2_9ValueNodeENS6_47323195">    // in the value lists corresponding to the source and destination values of</i></td></tr>
<tr><th id="544">544</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker13CreateCopyMapERKNS_9HloModuleERKN10tensorflow3gtl7FlatMapIPKNS_8HloValueEPNS2_9ValueNodeENS6_47323195">    // kCopy instructions. value_to_node should map each HloValue to its</i></td></tr>
<tr><th id="545">545</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker13CreateCopyMapERKNS_9HloModuleERKN10tensorflow3gtl7FlatMapIPKNS_8HloValueEPNS2_9ValueNodeENS6_47323195">    // respective ValueNode.</i></td></tr>
<tr><th id="546">546</th><td>    <em>void</em> <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker13CreateCopyMapERKNS_9HloModuleERKN10tensorflow3gtl7FlatMapIPKNS_8HloValueEPNS2_9ValueNodeENS6_47323195" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CreateCopyMap' data-type='void xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CreateCopyMap(const xla::HloModule &amp; module, const tensorflow::gtl::FlatMap&lt;const HloValue *, ValueNode *&gt; &amp; value_to_node)' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker13CreateCopyMapERKNS_9HloModuleERKN10tensorflow3gtl7FlatMapIPKNS_8HloValueEPNS2_9ValueNodeENS6_47323195">CreateCopyMap</dfn>(</td></tr>
<tr><th id="547">547</th><td>        <em>const</em> <a class="type" href="hlo_module.h.html#xla::HloModule" title='xla::HloModule' data-ref="xla::HloModule">HloModule</a>&amp; <dfn class="local col1 decl" id="111module" title='module' data-type='const xla::HloModule &amp;' data-ref="111module">module</dfn>,</td></tr>
<tr><th id="548">548</th><td>        <em>const</em> <span class="namespace">tensorflow::gtl::</span><a class="type" href="../../../core/lib/gtl/flatmap.h.html#tensorflow::gtl::FlatMap" title='tensorflow::gtl::FlatMap' data-ref="tensorflow::gtl::FlatMap">FlatMap</a>&lt;<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValue" title='xla::HloValue' data-ref="xla::HloValue">HloValue</a>*, <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>*&gt;&amp;</td></tr>
<tr><th id="549">549</th><td>            <dfn class="local col2 decl" id="112value_to_node" title='value_to_node' data-type='const tensorflow::gtl::FlatMap&lt;const HloValue *, ValueNode *&gt; &amp;' data-ref="112value_to_node">value_to_node</dfn>) {</td></tr>
<tr><th id="550">550</th><td>      <b>for</b> (<a class="type" href="hlo_computation.h.html#xla::HloComputation" title='xla::HloComputation' data-ref="xla::HloComputation">HloComputation</a>* <dfn class="local col3 decl" id="113computation" title='computation' data-type='xla::HloComputation *' data-ref="113computation">computation</dfn> : <a class="local col1 ref" href="#111module" title='module' data-ref="111module">module</a>.<a class="ref" href="hlo_module.h.html#_ZNK3xla9HloModule12computationsEv" title='xla::HloModule::computations' data-ref="_ZNK3xla9HloModule12computationsEv">computations</a>()) {</td></tr>
<tr><th id="551">551</th><td>        <b>for</b> (<a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col4 decl" id="114instruction" title='instruction' data-type='xla::HloInstruction *' data-ref="114instruction">instruction</dfn> : <a class="local col3 ref" href="#113computation" title='computation' data-ref="113computation">computation</a>-&gt;<a class="ref" href="hlo_computation.h.html#_ZN3xla14HloComputation12instructionsEv" title='xla::HloComputation::instructions' data-ref="_ZN3xla14HloComputation12instructionsEv">instructions</a>()) {</td></tr>
<tr><th id="552">552</th><td>          <i>// Add copies with unambiguous source values to the map. Copies with</i></td></tr>
<tr><th id="553">553</th><td><i>          // ambiguous sources are not removable.</i></td></tr>
<tr><th id="554">554</th><td>          <b>if</b> (<a class="local col4 ref" href="#114instruction" title='instruction' data-ref="114instruction">instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction6opcodeEv" title='xla::HloInstruction::opcode' data-ref="_ZNK3xla14HloInstruction6opcodeEv">opcode</a>() == <a class="type" href="hlo_opcode.h.html#xla::HloOpcode" title='xla::HloOpcode' data-ref="xla::HloOpcode">HloOpcode</a>::<a class="enum" href="hlo_opcode.h.html#135" title='xla::HloOpcode::kCopy' data-ref="xla::HloOpcode::kCopy">kCopy</a>) {</td></tr>
<tr><th id="555">555</th><td>            <em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValueSet" title='xla::HloValueSet' data-ref="xla::HloValueSet">HloValueSet</a>&amp; <dfn class="local col5 decl" id="115src_value_set" title='src_value_set' data-type='const xla::HloValueSet &amp;' data-ref="115src_value_set">src_value_set</dfn> =</td></tr>
<tr><th id="556">556</th><td>                <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::dataflow_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::dataflow_' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::dataflow_">dataflow_</a>.<a class="ref" href="hlo_dataflow_analysis.h.html#_ZNK3xla19HloDataflowAnalysis11GetValueSetEPKNS_14HloInstructionERKNS_10ShapeIndexE" title='xla::HloDataflowAnalysis::GetValueSet' data-ref="_ZNK3xla19HloDataflowAnalysis11GetValueSetEPKNS_14HloInstructionERKNS_10ShapeIndexE">GetValueSet</a>(<a class="local col4 ref" href="#114instruction" title='instruction' data-ref="114instruction">instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction7operandEx" title='xla::HloInstruction::operand' data-ref="_ZNK3xla14HloInstruction7operandEx">operand</a>(<var>0</var>));</td></tr>
<tr><th id="557">557</th><td>            <b>if</b> (<a class="local col5 ref" href="#115src_value_set" title='src_value_set' data-ref="115src_value_set">src_value_set</a>.<a class="ref" href="hlo_value.h.html#_ZNK3xla11HloValueSet6valuesEv" title='xla::HloValueSet::values' data-ref="_ZNK3xla11HloValueSet6valuesEv">values</a>().<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNKSt6vector4sizeEv" title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv">size</a>() == <var>1</var>) {</td></tr>
<tr><th id="558">558</th><td>              <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CopyNodes' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes">CopyNodes</a>&amp; <dfn class="local col6 decl" id="116copy_node" title='copy_node' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CopyNodes &amp;' data-ref="116copy_node">copy_node</dfn> = <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::copy_map_' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_">copy_map_</a><a class="tu ref" href="../../../core/lib/gtl/flatmap.h.html#_ZN10tensorflow3gtl7FlatMapixEOT_" title='tensorflow::gtl::FlatMap::operator[]' data-use='c' data-ref="_ZN10tensorflow3gtl7FlatMapixEOT_">[<a class="local col4 ref" href="#114instruction" title='instruction' data-ref="114instruction">instruction</a>]</a>;</td></tr>
<tr><th id="559">559</th><td>              <a class="local col6 ref" href="#116copy_node" title='copy_node' data-ref="116copy_node">copy_node</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes::dest" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CopyNodes::dest' data-use='w' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes::dest">dest</a> =</td></tr>
<tr><th id="560">560</th><td>                  <a class="local col2 ref" href="#112value_to_node" title='value_to_node' data-ref="112value_to_node">value_to_node</a>.<a class="tu ref" href="../../../core/lib/gtl/flatmap.h.html#_ZNK10tensorflow3gtl7FlatMap2atERKT_" title='tensorflow::gtl::FlatMap::at' data-use='c' data-ref="_ZNK10tensorflow3gtl7FlatMap2atERKT_">at</a>(&amp;<a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::dataflow_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::dataflow_' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::dataflow_">dataflow_</a>.<a class="ref" href="hlo_dataflow_analysis.h.html#_ZNK3xla19HloDataflowAnalysis16GetUniqueValueAtEPKNS_14HloInstructionERKNS_10ShapeIndexE" title='xla::HloDataflowAnalysis::GetUniqueValueAt' data-ref="_ZNK3xla19HloDataflowAnalysis16GetUniqueValueAtEPKNS_14HloInstructionERKNS_10ShapeIndexE">GetUniqueValueAt</a>(<a class="local col4 ref" href="#114instruction" title='instruction' data-ref="114instruction">instruction</a>));</td></tr>
<tr><th id="561">561</th><td>              <a class="local col6 ref" href="#116copy_node" title='copy_node' data-ref="116copy_node">copy_node</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes::src" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CopyNodes::src' data-use='w' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes::src">src</a> = <a class="local col2 ref" href="#112value_to_node" title='value_to_node' data-ref="112value_to_node">value_to_node</a>.<a class="tu ref" href="../../../core/lib/gtl/flatmap.h.html#_ZNK10tensorflow3gtl7FlatMap2atERKT_" title='tensorflow::gtl::FlatMap::at' data-use='c' data-ref="_ZNK10tensorflow3gtl7FlatMap2atERKT_">at</a>(&amp;<a class="local col5 ref" href="#115src_value_set" title='src_value_set' data-ref="115src_value_set">src_value_set</a>.<a class="ref" href="hlo_value.h.html#_ZNK3xla11HloValueSet14GetUniqueValueEv" title='xla::HloValueSet::GetUniqueValue' data-ref="_ZNK3xla11HloValueSet14GetUniqueValueEv">GetUniqueValue</a>());</td></tr>
<tr><th id="562">562</th><td>            }</td></tr>
<tr><th id="563">563</th><td>          }</td></tr>
<tr><th id="564">564</th><td>        }</td></tr>
<tr><th id="565">565</th><td>      }</td></tr>
<tr><th id="566">566</th><td>    }</td></tr>
<tr><th id="567">567</th><td></td></tr>
<tr><th id="568">568</th><td>    <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTrackerD1Ev" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::~BufferValueTracker' data-type='void xla::(anonymous namespace)::CopyRemover::BufferValueTracker::~BufferValueTracker()' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTrackerD1Ev">~BufferValueTracker</dfn>() {</td></tr>
<tr><th id="569">569</th><td>      <b>for</b> (<em>const</em> <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col7 decl" id="117head" title='head' data-type='const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="117head">head</dfn> : <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::value_lists_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::value_lists_' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::value_lists_">value_lists_</a>) {</td></tr>
<tr><th id="570">570</th><td>        <em>const</em> <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col8 decl" id="118p" title='p' data-type='const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="118p">p</dfn> = <a class="local col7 ref" href="#117head" title='head' data-ref="117head">head</a>;</td></tr>
<tr><th id="571">571</th><td>        <b>do</b> {</td></tr>
<tr><th id="572">572</th><td>          <em>const</em> <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col9 decl" id="119tmp" title='tmp' data-type='const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="119tmp">tmp</dfn> = <a class="local col8 ref" href="#118p" title='p' data-ref="118p">p</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::next' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next">next</a>;</td></tr>
<tr><th id="573">573</th><td>          <b>delete</b> <a class="local col8 ref" href="#118p" title='p' data-ref="118p">p</a>;</td></tr>
<tr><th id="574">574</th><td>          <a class="local col8 ref" href="#118p" title='p' data-ref="118p">p</a> = <a class="local col9 ref" href="#119tmp" title='tmp' data-ref="119tmp">tmp</a>;</td></tr>
<tr><th id="575">575</th><td>        } <b>while</b> (<a class="local col8 ref" href="#118p" title='p' data-ref="118p">p</a> != <a class="local col7 ref" href="#117head" title='head' data-ref="117head">head</a>);</td></tr>
<tr><th id="576">576</th><td>      }</td></tr>
<tr><th id="577">577</th><td>    }</td></tr>
<tr><th id="578">578</th><td></td></tr>
<tr><th id="579">579</th><td>    <i  data-doc="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6VerifyEv">// Verify invariants within the linked lists.</i></td></tr>
<tr><th id="580">580</th><td>    <a class="type" href="../../../core/lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a> <dfn class="tu decl def" id="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6VerifyEv" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::Verify' data-type='tensorflow::Status xla::(anonymous namespace)::CopyRemover::BufferValueTracker::Verify() const' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6VerifyEv">Verify</dfn>() <em>const</em> {</td></tr>
<tr><th id="581">581</th><td>      <b>for</b> (<em>const</em> <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col0 decl" id="120head" title='head' data-type='const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="120head">head</dfn> : <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::value_lists_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::value_lists_' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::value_lists_">value_lists_</a>) {</td></tr>
<tr><th id="582">582</th><td>        <em>const</em> <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col1 decl" id="121p" title='p' data-type='const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="121p">p</dfn> = <a class="local col0 ref" href="#120head" title='head' data-ref="120head">head</a>;</td></tr>
<tr><th id="583">583</th><td>        <b>do</b> {</td></tr>
<tr><th id="584">584</th><td>          <i>// Verify links between elements are consistent.</i></td></tr>
<tr><th id="585">585</th><td>          <a class="macro" href="../status_macros.h.html#179" title="while ((__builtin_expect(!(p-&gt;prev-&gt;next == p), 0))) return xla::status_macros::MakeErrorStream(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 585, tensorflow::error::INTERNAL) .with_log_stack_trace() .add_ret_check_failure(&quot;p-&gt;prev-&gt;next == p&quot;)" data-ref="_M/TF_RET_CHECK">TF_RET_CHECK</a>(<a class="local col1 ref" href="#121p" title='p' data-ref="121p">p</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::prev' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev">prev</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::next' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next">next</a> == <a class="local col1 ref" href="#121p" title='p' data-ref="121p">p</a>);</td></tr>
<tr><th id="586">586</th><td>          <a class="macro" href="../status_macros.h.html#179" title="while ((__builtin_expect(!(p-&gt;next-&gt;prev == p), 0))) return xla::status_macros::MakeErrorStream(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 586, tensorflow::error::INTERNAL) .with_log_stack_trace() .add_ret_check_failure(&quot;p-&gt;next-&gt;prev == p&quot;)" data-ref="_M/TF_RET_CHECK">TF_RET_CHECK</a>(<a class="local col1 ref" href="#121p" title='p' data-ref="121p">p</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::next' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next">next</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::prev' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev">prev</a> == <a class="local col1 ref" href="#121p" title='p' data-ref="121p">p</a>);</td></tr>
<tr><th id="587">587</th><td></td></tr>
<tr><th id="588">588</th><td>          <em>const</em> <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col2 decl" id="122def" title='def' data-type='const xla::HloInstruction *' data-ref="122def">def</dfn> = <a class="local col1 ref" href="#121p" title='p' data-ref="121p">p</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue20defining_instructionEv" title='xla::HloValue::defining_instruction' data-ref="_ZNK3xla8HloValue20defining_instructionEv">defining_instruction</a>();</td></tr>
<tr><th id="589">589</th><td>          <b>if</b> (<a class="local col2 ref" href="#122def" title='def' data-ref="122def">def</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction6opcodeEv" title='xla::HloInstruction::opcode' data-ref="_ZNK3xla14HloInstruction6opcodeEv">opcode</a>() == <a class="type" href="hlo_opcode.h.html#xla::HloOpcode" title='xla::HloOpcode' data-ref="xla::HloOpcode">HloOpcode</a>::<a class="enum" href="hlo_opcode.h.html#135" title='xla::HloOpcode::kCopy' data-ref="xla::HloOpcode::kCopy">kCopy</a> &amp;&amp;</td></tr>
<tr><th id="590">590</th><td>              <a class="tu ref" href="../map_util.h.html#_ZN3xla11ContainsKeyERKT_RKT0_" title='xla::ContainsKey' data-use='c' data-ref="_ZN3xla11ContainsKeyERKT_RKT0_">ContainsKey</a>(<a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::copy_map_' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_">copy_map_</a>, <a class="local col2 ref" href="#122def" title='def' data-ref="122def">def</a>)) {</td></tr>
<tr><th id="591">591</th><td>            <a class="macro" href="../status_macros.h.html#179" title="while ((__builtin_expect(!(copy_map_.at(def).dest == p), 0))) return xla::status_macros::MakeErrorStream(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 591, tensorflow::error::INTERNAL) .with_log_stack_trace() .add_ret_check_failure(&quot;copy_map_.at(def).dest == p&quot;)" data-ref="_M/TF_RET_CHECK">TF_RET_CHECK</a>(<a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::copy_map_' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_">copy_map_</a>.<a class="tu ref" href="../../../core/lib/gtl/flatmap.h.html#_ZNK10tensorflow3gtl7FlatMap2atERKT_" title='tensorflow::gtl::FlatMap::at' data-use='c' data-ref="_ZNK10tensorflow3gtl7FlatMap2atERKT_">at</a>(<a class="local col2 ref" href="#122def" title='def' data-ref="122def">def</a>).<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes::dest" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CopyNodes::dest' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes::dest">dest</a> == <a class="local col1 ref" href="#121p" title='p' data-ref="121p">p</a>);</td></tr>
<tr><th id="592">592</th><td>          }</td></tr>
<tr><th id="593">593</th><td>          <b>for</b> (<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloUse" title='xla::HloUse' data-ref="xla::HloUse">HloUse</a>* <dfn class="local col3 decl" id="123use" title='use' data-type='const xla::HloUse *' data-ref="123use">use</dfn> : <a class="local col1 ref" href="#121p" title='p' data-ref="121p">p</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::uses' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses">uses</a>) {</td></tr>
<tr><th id="594">594</th><td>            <b>if</b> (<a class="local col3 ref" href="#123use" title='use' data-ref="123use">use</a>-&gt;<a class="ref" href="hlo_value.h.html#xla::HloUse::instruction" title='xla::HloUse::instruction' data-ref="xla::HloUse::instruction">instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction6opcodeEv" title='xla::HloInstruction::opcode' data-ref="_ZNK3xla14HloInstruction6opcodeEv">opcode</a>() == <a class="type" href="hlo_opcode.h.html#xla::HloOpcode" title='xla::HloOpcode' data-ref="xla::HloOpcode">HloOpcode</a>::<a class="enum" href="hlo_opcode.h.html#135" title='xla::HloOpcode::kCopy' data-ref="xla::HloOpcode::kCopy">kCopy</a> &amp;&amp;</td></tr>
<tr><th id="595">595</th><td>                <a class="tu ref" href="../map_util.h.html#_ZN3xla11ContainsKeyERKT_RKT0_" title='xla::ContainsKey' data-use='c' data-ref="_ZN3xla11ContainsKeyERKT_RKT0_">ContainsKey</a>(<a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::copy_map_' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_">copy_map_</a>, <a class="local col3 ref" href="#123use" title='use' data-ref="123use">use</a>-&gt;<a class="ref" href="hlo_value.h.html#xla::HloUse::instruction" title='xla::HloUse::instruction' data-ref="xla::HloUse::instruction">instruction</a>)) {</td></tr>
<tr><th id="596">596</th><td>              <a class="macro" href="../status_macros.h.html#179" title="while ((__builtin_expect(!(copy_map_.at(use-&gt;instruction).src == p), 0))) return xla::status_macros::MakeErrorStream(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 596, tensorflow::error::INTERNAL) .with_log_stack_trace() .add_ret_check_failure(&quot;copy_map_.at(use-&gt;instruction).src == p&quot;)" data-ref="_M/TF_RET_CHECK">TF_RET_CHECK</a>(<a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::copy_map_' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_">copy_map_</a>.<a class="tu ref" href="../../../core/lib/gtl/flatmap.h.html#_ZNK10tensorflow3gtl7FlatMap2atERKT_" title='tensorflow::gtl::FlatMap::at' data-use='c' data-ref="_ZNK10tensorflow3gtl7FlatMap2atERKT_">at</a>(<a class="local col3 ref" href="#123use" title='use' data-ref="123use">use</a>-&gt;<a class="ref" href="hlo_value.h.html#xla::HloUse::instruction" title='xla::HloUse::instruction' data-ref="xla::HloUse::instruction">instruction</a>).<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes::src" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CopyNodes::src' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes::src">src</a> == <a class="local col1 ref" href="#121p" title='p' data-ref="121p">p</a>);</td></tr>
<tr><th id="597">597</th><td>            }</td></tr>
<tr><th id="598">598</th><td>          }</td></tr>
<tr><th id="599">599</th><td></td></tr>
<tr><th id="600">600</th><td>          <a class="local col1 ref" href="#121p" title='p' data-ref="121p">p</a> = <a class="local col1 ref" href="#121p" title='p' data-ref="121p">p</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::next' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next">next</a>;</td></tr>
<tr><th id="601">601</th><td>        } <b>while</b> (<a class="local col1 ref" href="#121p" title='p' data-ref="121p">p</a> != <a class="local col0 ref" href="#120head" title='head' data-ref="120head">head</a>);</td></tr>
<tr><th id="602">602</th><td>      }</td></tr>
<tr><th id="603">603</th><td>      <b>return</b> <a class="type" href="../../../core/lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a>::<a class="ref" href="../../../core/lib/core/status.h.html#_ZN10tensorflow6Status2OKEv" title='tensorflow::Status::OK' data-ref="_ZN10tensorflow6Status2OKEv">OK</a>();</td></tr>
<tr><th id="604">604</th><td>    }</td></tr>
<tr><th id="605">605</th><td></td></tr>
<tr><th id="606">606</th><td>    <i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12TryElideCopyEPKNS_14HloInstructionE">// Try to elide the given copy. Elision of a copy is possible only if no</i></td></tr>
<tr><th id="607">607</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12TryElideCopyEPKNS_14HloInstructionE">    // live range interference is introduced by the copy's elimination. If</i></td></tr>
<tr><th id="608">608</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12TryElideCopyEPKNS_14HloInstructionE">    // elision is possible, then the internal state (value lists) are updated,</i></td></tr>
<tr><th id="609">609</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12TryElideCopyEPKNS_14HloInstructionE">    // and true is returned. Returns false otherwise.</i></td></tr>
<tr><th id="610">610</th><td>    <em>bool</em> <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12TryElideCopyEPKNS_14HloInstructionE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::TryElideCopy' data-type='bool xla::(anonymous namespace)::CopyRemover::BufferValueTracker::TryElideCopy(const xla::HloInstruction * copy)' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12TryElideCopyEPKNS_14HloInstructionE">TryElideCopy</dfn>(<em>const</em> <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col4 decl" id="124copy" title='copy' data-type='const xla::HloInstruction *' data-ref="124copy">copy</dfn>) {</td></tr>
<tr><th id="611">611</th><td>      <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((2) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 611, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>2</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <q>"Trying to remove "</q> <a class="ref" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E">&lt;&lt;</a> <a class="local col4 ref" href="#124copy" title='copy' data-ref="124copy">copy</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction4nameEv" title='xla::HloInstruction::name' data-ref="_ZNK3xla14HloInstruction4nameEv">name</a>();</td></tr>
<tr><th id="612">612</th><td></td></tr>
<tr><th id="613">613</th><td>      <b>if</b> (!<a class="tu ref" href="../map_util.h.html#_ZN3xla11ContainsKeyERKT_RKT0_" title='xla::ContainsKey' data-use='c' data-ref="_ZN3xla11ContainsKeyERKT_RKT0_">ContainsKey</a>(<a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::copy_map_' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_">copy_map_</a>, <a class="local col4 ref" href="#124copy" title='copy' data-ref="124copy">copy</a>)) {</td></tr>
<tr><th id="614">614</th><td>        <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((2) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 614, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>2</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <a class="local col4 ref" href="#124copy" title='copy' data-ref="124copy">copy</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction4nameEv" title='xla::HloInstruction::name' data-ref="_ZNK3xla14HloInstruction4nameEv">name</a>() <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsRSt13basic_ostreamIcT_EPKc" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIcT_EPKc">&lt;&lt;</a> <q>" is not removable"</q>;</td></tr>
<tr><th id="615">615</th><td>        <b>return</b> <b>false</b>;</td></tr>
<tr><th id="616">616</th><td>      }</td></tr>
<tr><th id="617">617</th><td></td></tr>
<tr><th id="618">618</th><td>      <em>const</em> <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CopyNodes' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes">CopyNodes</a>&amp; <dfn class="local col5 decl" id="125copy_node" title='copy_node' data-type='const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CopyNodes &amp;' data-ref="125copy_node">copy_node</dfn> = <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::copy_map_' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_">copy_map_</a>.<a class="tu ref" href="../../../core/lib/gtl/flatmap.h.html#_ZN10tensorflow3gtl7FlatMap2atERKT_" title='tensorflow::gtl::FlatMap::at' data-use='c' data-ref="_ZN10tensorflow3gtl7FlatMap2atERKT_">at</a>(<a class="local col4 ref" href="#124copy" title='copy' data-ref="124copy">copy</a>);</td></tr>
<tr><th id="619">619</th><td>      <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col6 decl" id="126src" title='src' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="126src">src</dfn> = <a class="local col5 ref" href="#125copy_node" title='copy_node' data-ref="125copy_node">copy_node</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes::src" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CopyNodes::src' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes::src">src</a>;</td></tr>
<tr><th id="620">620</th><td>      <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col7 decl" id="127dest" title='dest' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="127dest">dest</dfn> = <a class="local col5 ref" href="#125copy_node" title='copy_node' data-ref="125copy_node">copy_node</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes::dest" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CopyNodes::dest' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes::dest">dest</a>;</td></tr>
<tr><th id="621">621</th><td>      <a class="macro" href="../../../core/platform/default/logging.h.html#273" title="while (false &amp;&amp; (src != nullptr)) ::tensorflow::internal::LogMessageFatal(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 621)" data-ref="_M/DCHECK">DCHECK</a>(<a class="local col6 ref" href="#126src" title='src' data-ref="126src">src</a> != <b>nullptr</b>);</td></tr>
<tr><th id="622">622</th><td>      <a class="macro" href="../../../core/platform/default/logging.h.html#273" title="while (false &amp;&amp; (dest != nullptr)) ::tensorflow::internal::LogMessageFatal(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 622)" data-ref="_M/DCHECK">DCHECK</a>(<a class="local col7 ref" href="#127dest" title='dest' data-ref="127dest">dest</a> != <b>nullptr</b>);</td></tr>
<tr><th id="623">623</th><td></td></tr>
<tr><th id="624">624</th><td>      <em>auto</em> <dfn class="local col8 decl" id="128is_live_range_before" title='is_live_range_before' data-type='(lambda at /root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc:624:35)' data-ref="128is_live_range_before">is_live_range_before</dfn> = [<b>this</b>](<em>const</em> <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>&amp; <dfn class="local col9 decl" id="129a" title='a' data-type='const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode &amp;' data-ref="129a">a</dfn>,</td></tr>
<tr><th id="625">625</th><td>                                         <em>const</em> <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>&amp; <dfn class="local col0 decl" id="130b" title='b' data-type='const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode &amp;' data-ref="130b">b</dfn>) {</td></tr>
<tr><th id="626">626</th><td>        <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((3) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 626, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>3</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <q>"Checking live range of "</q> <a class="ref" href="hlo_value.h.html#_ZN3xlalsERSoRKNS_8HloValueE" title='xla::operator&lt;&lt;' data-ref="_ZN3xlalsERSoRKNS_8HloValueE">&lt;&lt;</a> *<a class="local col9 ref" href="#129a" title='a' data-ref="129a">a</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a> <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsRSt13basic_ostreamIcT_EPKc" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIcT_EPKc">&lt;&lt;</a> <q>" WRT "</q> <a class="ref" href="hlo_value.h.html#_ZN3xlalsERSoRKNS_8HloValueE" title='xla::operator&lt;&lt;' data-ref="_ZN3xlalsERSoRKNS_8HloValueE">&lt;&lt;</a> *<a class="local col0 ref" href="#130b" title='b' data-ref="130b">b</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>;</td></tr>
<tr><th id="627">627</th><td>        <b>if</b> (<a class="tu member" href="#_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker15LiveRangeBeforeERKNS2_9ValueNodeES5_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::LiveRangeBefore' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker15LiveRangeBeforeERKNS2_9ValueNodeES5_">LiveRangeBefore</a>(<a class="local col9 ref" href="#129a" title='a' data-ref="129a">a</a>, <a class="local col0 ref" href="#130b" title='b' data-ref="130b">b</a>)) {</td></tr>
<tr><th id="628">628</th><td>          <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((2) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 628, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>2</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <q>"  Live range of "</q> <a class="ref" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E">&lt;&lt;</a> <a class="local col9 ref" href="#129a" title='a' data-ref="129a">a</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue13ToShortStringEv" title='xla::HloValue::ToShortString' data-ref="_ZNK3xla8HloValue13ToShortStringEv">ToShortString</a>()</td></tr>
<tr><th id="629">629</th><td>                  <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsRSt13basic_ostreamIcT_EPKc" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIcT_EPKc">&lt;&lt;</a> <q>" is before "</q> <a class="ref" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E">&lt;&lt;</a> <a class="local col0 ref" href="#130b" title='b' data-ref="130b">b</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue13ToShortStringEv" title='xla::HloValue::ToShortString' data-ref="_ZNK3xla8HloValue13ToShortStringEv">ToShortString</a>();</td></tr>
<tr><th id="630">630</th><td>          <b>return</b> <b>true</b>;</td></tr>
<tr><th id="631">631</th><td>        } <b>else</b> {</td></tr>
<tr><th id="632">632</th><td>          <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((2) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 632, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>2</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <q>"  Live range of "</q> <a class="ref" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E">&lt;&lt;</a> <a class="local col9 ref" href="#129a" title='a' data-ref="129a">a</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue13ToShortStringEv" title='xla::HloValue::ToShortString' data-ref="_ZNK3xla8HloValue13ToShortStringEv">ToShortString</a>()</td></tr>
<tr><th id="633">633</th><td>                  <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsRSt13basic_ostreamIcT_EPKc" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIcT_EPKc">&lt;&lt;</a> <q>" is not before "</q> <a class="ref" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E">&lt;&lt;</a> <a class="local col0 ref" href="#130b" title='b' data-ref="130b">b</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue13ToShortStringEv" title='xla::HloValue::ToShortString' data-ref="_ZNK3xla8HloValue13ToShortStringEv">ToShortString</a>();</td></tr>
<tr><th id="634">634</th><td>          <b>return</b> <b>false</b>;</td></tr>
<tr><th id="635">635</th><td>        }</td></tr>
<tr><th id="636">636</th><td>      };</td></tr>
<tr><th id="637">637</th><td></td></tr>
<tr><th id="638">638</th><td>      <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((3) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 638, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>3</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <a class="local col4 ref" href="#124copy" title='copy' data-ref="124copy">copy</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction4nameEv" title='xla::HloInstruction::name' data-ref="_ZNK3xla14HloInstruction4nameEv">name</a>() <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsRSt13basic_ostreamIcT_EPKc" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIcT_EPKc">&lt;&lt;</a> <q>" copies value "</q></td></tr>
<tr><th id="639">639</th><td>              <a class="ref" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E">&lt;&lt;</a> <a class="local col6 ref" href="#126src" title='src' data-ref="126src">src</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue13ToShortStringEv" title='xla::HloValue::ToShortString' data-ref="_ZNK3xla8HloValue13ToShortStringEv">ToShortString</a>();</td></tr>
<tr><th id="640">640</th><td>      <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((3) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 640, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>3</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <q>"Source buffer values: "</q> <a class="ref" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E">&lt;&lt;</a> <a class="tu member" href="#_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker17ValueListToStringEPKNS2_9ValueNodeE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueListToString' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker17ValueListToStringEPKNS2_9ValueNodeE">ValueListToString</a>(<a class="local col6 ref" href="#126src" title='src' data-ref="126src">src</a>);</td></tr>
<tr><th id="641">641</th><td>      <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((3) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 641, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>3</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <q>"Dest buffer values: "</q> <a class="ref" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E">&lt;&lt;</a> <a class="tu member" href="#_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker17ValueListToStringEPKNS2_9ValueNodeE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueListToString' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker17ValueListToStringEPKNS2_9ValueNodeE">ValueListToString</a>(<a class="local col7 ref" href="#127dest" title='dest' data-ref="127dest">dest</a>);</td></tr>
<tr><th id="642">642</th><td></td></tr>
<tr><th id="643">643</th><td>      <i>// A kCopy instruction copies an HLO value from a source buffer and</i></td></tr>
<tr><th id="644">644</th><td><i>      // defines an HLO value in a destination buffer. Most generally, the</i></td></tr>
<tr><th id="645">645</th><td><i>      // source and destination buffers may each hold more than one value at</i></td></tr>
<tr><th id="646">646</th><td><i>      // different points in the computation so we define the following:</i></td></tr>
<tr><th id="647">647</th><td><i>      //</i></td></tr>
<tr><th id="648">648</th><td><i>      //   Values in source buffer:      {s_0, ..., s_n}</i></td></tr>
<tr><th id="649">649</th><td><i>      //   Values in destination buffer: {d_0, ..., d_m}</i></td></tr>
<tr><th id="650">650</th><td><i>      //</i></td></tr>
<tr><th id="651">651</th><td><i>      // A kCopy instruction between these buffers copies a value s_x in the</i></td></tr>
<tr><th id="652">652</th><td><i>      // source buffer and defines a value d_y in the destination buffer. The</i></td></tr>
<tr><th id="653">653</th><td><i>      // elision of a copy merges the source and destination buffers together,</i></td></tr>
<tr><th id="654">654</th><td><i>      // so the list of values for the source and destination buffers are</i></td></tr>
<tr><th id="655">655</th><td><i>      // merged.</i></td></tr>
<tr><th id="656">656</th><td><i>      //</i></td></tr>
<tr><th id="657">657</th><td><i>      // We handle two different cases for copy elision:</i></td></tr>
<tr><th id="658">658</th><td><i>      //</i></td></tr>
<tr><th id="659">659</th><td><i>      //  (1) the kCopy defines the first value in the destination buffer (d_0).</i></td></tr>
<tr><th id="660">660</th><td><i>      //</i></td></tr>
<tr><th id="661">661</th><td><i>      //  (2) the kCopy copies the last value in the source buffer (s_n).</i></td></tr>
<tr><th id="662">662</th><td><i>      //</i></td></tr>
<tr><th id="663">663</th><td><i>      // For the remaining case where the kCopy copies a not-last value from the</i></td></tr>
<tr><th id="664">664</th><td><i>      // source buffer to a not-first value of the destination buffer, the kCopy</i></td></tr>
<tr><th id="665">665</th><td><i>      // instruction cannot be removed. This case is generated, for example, if</i></td></tr>
<tr><th id="666">666</th><td><i>      // the kCopy copies a while body parameter of the loop state at one tuple</i></td></tr>
<tr><th id="667">667</th><td><i>      // index to a different tuple index in the while body root. Removal of the</i></td></tr>
<tr><th id="668">668</th><td><i>      // copy necessarily results in live range interference of values in the</i></td></tr>
<tr><th id="669">669</th><td><i>      // loop state at the two different tuple indices.</i></td></tr>
<tr><th id="670">670</th><td><i>      //</i></td></tr>
<tr><th id="671">671</th><td><i>      //  We can only perform copy elision if the resulting merged values have</i></td></tr>
<tr><th id="672">672</th><td><i>      //  totally ordered live ranges; otherwise the merged buffer would have</i></td></tr>
<tr><th id="673">673</th><td><i>      //  live range interference.</i></td></tr>
<tr><th id="674">674</th><td>      <b>if</b> (<a class="tu member" href="#_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6IsHeadERKNS2_9ValueNodeE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::IsHead' data-use='c' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6IsHeadERKNS2_9ValueNodeE">IsHead</a>(*<a class="local col7 ref" href="#127dest" title='dest' data-ref="127dest">dest</a>)) {</td></tr>
<tr><th id="675">675</th><td>        <i>// The copy copies an arbitrary value in the source buffer (call it s_x)</i></td></tr>
<tr><th id="676">676</th><td><i>        // and defines d_0, the first value in the destination buffer. After</i></td></tr>
<tr><th id="677">677</th><td><i>        // merging, the values in the combined buffer must be strictly ordered</i></td></tr>
<tr><th id="678">678</th><td><i>        // as follows** to elide the copy:</i></td></tr>
<tr><th id="679">679</th><td><i>        //</i></td></tr>
<tr><th id="680">680</th><td><i>        // {s_0, ..., s_x, d_1, ..., d_m, s_{x+1}, ..., s_n}</i></td></tr>
<tr><th id="681">681</th><td><i>        //</i></td></tr>
<tr><th id="682">682</th><td><i>        // Removing the copy eliminates d_0, and uses of d_0 become uses of</i></td></tr>
<tr><th id="683">683</th><td><i>        // s_x. In the above ordering, the live range of d_m must be ordered</i></td></tr>
<tr><th id="684">684</th><td><i>        // before the live range of s_{x+1} and the definition and all uses of</i></td></tr>
<tr><th id="685">685</th><td><i>        // s_x must be ordered before the definition of d_1. These conditions</i></td></tr>
<tr><th id="686">686</th><td><i>        // are checked below prior to elision.</i></td></tr>
<tr><th id="687">687</th><td><i>        //</i></td></tr>
<tr><th id="688">688</th><td><i>        // ** Technically it might be possible to have a non-interfering</i></td></tr>
<tr><th id="689">689</th><td><i>        //    non-trivial interleaving of the values of the source and</i></td></tr>
<tr><th id="690">690</th><td><i>        //    destination buffers in the resulting order. However, this case is</i></td></tr>
<tr><th id="691">691</th><td><i>        //    slow and complicated to check and likely not worth it. So instead</i></td></tr>
<tr><th id="692">692</th><td><i>        //    we simply check for the case where *all* values of the destination</i></td></tr>
<tr><th id="693">693</th><td><i>        //    buffer (d_1 through d_m) are spliced into the point where the copy</i></td></tr>
<tr><th id="694">694</th><td><i>        //    used to be.</i></td></tr>
<tr><th id="695">695</th><td>        <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((2) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 695, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>2</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <a class="local col4 ref" href="#124copy" title='copy' data-ref="124copy">copy</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction4nameEv" title='xla::HloInstruction::name' data-ref="_ZNK3xla14HloInstruction4nameEv">name</a>() <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsRSt13basic_ostreamIcT_EPKc" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIcT_EPKc">&lt;&lt;</a> <q>" defines the first value in its buffer"</q>;</td></tr>
<tr><th id="696">696</th><td>        <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col1 decl" id="131next_dest" title='next_dest' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="131next_dest">next_dest</dfn> = <a class="tu member" href="#_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker4NextERKNS2_9ValueNodeE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::Next' data-use='c' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker4NextERKNS2_9ValueNodeE">Next</a>(*<a class="local col7 ref" href="#127dest" title='dest' data-ref="127dest">dest</a>);</td></tr>
<tr><th id="697">697</th><td>        <b>if</b> (<a class="local col1 ref" href="#131next_dest" title='next_dest' data-ref="131next_dest">next_dest</a> != <b>nullptr</b>) {</td></tr>
<tr><th id="698">698</th><td>          <i>// Live range of 'from' value (s_x) must be before 'next_dest' (d_1);</i></td></tr>
<tr><th id="699">699</th><td>          <b>if</b> (!<a class="local col8 ref" href="#128is_live_range_before" title='is_live_range_before' data-ref="128is_live_range_before">is_live_range_before</a><a class="tu ref" href="#_ZZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12TryElideCopyEPKNS_14HloInstructionEENKUlRKNS2_9ValueNodeES8_E_clES8_S8_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::TryElideCopy(const xla::HloInstruction *)::(anonymous class)::operator()' data-use='c' data-ref="_ZZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12TryElideCopyEPKNS_14HloInstructionEENKUlRKNS2_9ValueNodeES8_E_clES8_S8_">(*<a class="local col6 ref" href="#126src" title='src' data-ref="126src">src</a>, *<a class="local col1 ref" href="#131next_dest" title='next_dest' data-ref="131next_dest">next_dest</a>)</a>) {</td></tr>
<tr><th id="700">700</th><td>            <b>return</b> <b>false</b>;</td></tr>
<tr><th id="701">701</th><td>          }</td></tr>
<tr><th id="702">702</th><td>        }</td></tr>
<tr><th id="703">703</th><td>        <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col2 decl" id="132next_src" title='next_src' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="132next_src">next_src</dfn> = <a class="tu member" href="#_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker4NextERKNS2_9ValueNodeE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::Next' data-use='c' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker4NextERKNS2_9ValueNodeE">Next</a>(*<a class="local col6 ref" href="#126src" title='src' data-ref="126src">src</a>);</td></tr>
<tr><th id="704">704</th><td></td></tr>
<tr><th id="705">705</th><td>        <b>if</b> (<a class="local col2 ref" href="#132next_src" title='next_src' data-ref="132next_src">next_src</a> != <b>nullptr</b>) {</td></tr>
<tr><th id="706">706</th><td>          <i>// Live range of 'last_dest' (d_m) must be before 'next_src' s_{x+1}.</i></td></tr>
<tr><th id="707">707</th><td>          <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col3 decl" id="133last_dest" title='last_dest' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="133last_dest">last_dest</dfn> = <a class="local col7 ref" href="#127dest" title='dest' data-ref="127dest">dest</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::prev' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev">prev</a>;</td></tr>
<tr><th id="708">708</th><td>          <a class="macro" href="../../../core/platform/default/logging.h.html#273" title="while (false &amp;&amp; (IsTail(*last_dest))) ::tensorflow::internal::LogMessageFatal(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 708)" data-ref="_M/DCHECK">DCHECK</a>(<a class="tu member" href="#_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6IsTailERKNS2_9ValueNodeE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::IsTail' data-use='c' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6IsTailERKNS2_9ValueNodeE">IsTail</a>(*<a class="local col3 ref" href="#133last_dest" title='last_dest' data-ref="133last_dest">last_dest</a>));</td></tr>
<tr><th id="709">709</th><td>          <b>if</b> (!<a class="local col8 ref" href="#128is_live_range_before" title='is_live_range_before' data-ref="128is_live_range_before">is_live_range_before</a><a class="tu ref" href="#_ZZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12TryElideCopyEPKNS_14HloInstructionEENKUlRKNS2_9ValueNodeES8_E_clES8_S8_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::TryElideCopy(const xla::HloInstruction *)::(anonymous class)::operator()' data-use='c' data-ref="_ZZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12TryElideCopyEPKNS_14HloInstructionEENKUlRKNS2_9ValueNodeES8_E_clES8_S8_">(*<a class="local col3 ref" href="#133last_dest" title='last_dest' data-ref="133last_dest">last_dest</a>, *<a class="local col2 ref" href="#132next_src" title='next_src' data-ref="132next_src">next_src</a>)</a>) {</td></tr>
<tr><th id="710">710</th><td>            <b>return</b> <b>false</b>;</td></tr>
<tr><th id="711">711</th><td>          }</td></tr>
<tr><th id="712">712</th><td>        }</td></tr>
<tr><th id="713">713</th><td></td></tr>
<tr><th id="714">714</th><td>        <i>// Splice in destination buffer values list right after 'src'.</i></td></tr>
<tr><th id="715">715</th><td>        <a class="tu member" href="#_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker11SpliceAfterEPNS2_9ValueNodeES4_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::SpliceAfter' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker11SpliceAfterEPNS2_9ValueNodeES4_">SpliceAfter</a>(<a class="local col7 ref" href="#127dest" title='dest' data-ref="127dest">dest</a>, <a class="local col6 ref" href="#126src" title='src' data-ref="126src">src</a>);</td></tr>
<tr><th id="716">716</th><td>      } <b>else</b> <b>if</b> (<a class="tu member" href="#_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6IsTailERKNS2_9ValueNodeE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::IsTail' data-use='c' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6IsTailERKNS2_9ValueNodeE">IsTail</a>(*<a class="local col6 ref" href="#126src" title='src' data-ref="126src">src</a>)) {</td></tr>
<tr><th id="717">717</th><td>        <i>// The copy copies the last value in the source buffer, s_n, and defines</i></td></tr>
<tr><th id="718">718</th><td><i>        // an arbitrary value in the destination buffer, d_y.  After</i></td></tr>
<tr><th id="719">719</th><td><i>        // merging, the values in the combined buffer must be strictly ordered</i></td></tr>
<tr><th id="720">720</th><td><i>        // as follows** to elide the copy:</i></td></tr>
<tr><th id="721">721</th><td><i>        //</i></td></tr>
<tr><th id="722">722</th><td><i>        // {d_0, ..., d_{y-1}, s_0, ..., s_n, d_{y+1}, ..., d_m}</i></td></tr>
<tr><th id="723">723</th><td><i>        //</i></td></tr>
<tr><th id="724">724</th><td><i>        // Removing the copy eliminates d_y, and uses of d_y become uses of</i></td></tr>
<tr><th id="725">725</th><td><i>        // s_n. To enforce the above order, the live range of d_{y-1} must be</i></td></tr>
<tr><th id="726">726</th><td><i>        // before the live range of s_0, and the live range of s_n must be</i></td></tr>
<tr><th id="727">727</th><td><i>        // before the live range of d_{y+1}.</i></td></tr>
<tr><th id="728">728</th><td><i>        //</i></td></tr>
<tr><th id="729">729</th><td><i>        // ** See comment above in the code handling Case (1).</i></td></tr>
<tr><th id="730">730</th><td>        <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((2) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 730, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>2</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <a class="local col4 ref" href="#124copy" title='copy' data-ref="124copy">copy</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction4nameEv" title='xla::HloInstruction::name' data-ref="_ZNK3xla14HloInstruction4nameEv">name</a>() <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsRSt13basic_ostreamIcT_EPKc" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIcT_EPKc">&lt;&lt;</a> <q>" copies the last value ("</q></td></tr>
<tr><th id="731">731</th><td>                <a class="ref" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E">&lt;&lt;</a> <a class="local col6 ref" href="#126src" title='src' data-ref="126src">src</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue13ToShortStringEv" title='xla::HloValue::ToShortString' data-ref="_ZNK3xla8HloValue13ToShortStringEv">ToShortString</a>() <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsRSt13basic_ostreamIcT_EPKc" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIcT_EPKc">&lt;&lt;</a> <q>") in its buffer"</q>;</td></tr>
<tr><th id="732">732</th><td></td></tr>
<tr><th id="733">733</th><td>        <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col4 decl" id="134prev_dest" title='prev_dest' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="134prev_dest">prev_dest</dfn> = <a class="tu member" href="#_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker4PrevERKNS2_9ValueNodeE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::Prev' data-use='c' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker4PrevERKNS2_9ValueNodeE">Prev</a>(*<a class="local col7 ref" href="#127dest" title='dest' data-ref="127dest">dest</a>);</td></tr>
<tr><th id="734">734</th><td>        <i>// nullptr condition handled above in the first 'if' case.</i></td></tr>
<tr><th id="735">735</th><td>        <a class="macro" href="../../../core/platform/default/logging.h.html#273" title="while (false &amp;&amp; (prev_dest != nullptr)) ::tensorflow::internal::LogMessageFatal(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 735)" data-ref="_M/DCHECK">DCHECK</a>(<a class="local col4 ref" href="#134prev_dest" title='prev_dest' data-ref="134prev_dest">prev_dest</a> != <b>nullptr</b>);</td></tr>
<tr><th id="736">736</th><td>        <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col5 decl" id="135first_src" title='first_src' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="135first_src">first_src</dfn> = <a class="local col6 ref" href="#126src" title='src' data-ref="126src">src</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::next' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next">next</a>;</td></tr>
<tr><th id="737">737</th><td>        <a class="macro" href="../../../core/platform/default/logging.h.html#273" title="while (false &amp;&amp; (IsHead(*first_src))) ::tensorflow::internal::LogMessageFatal(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 737)" data-ref="_M/DCHECK">DCHECK</a>(<a class="tu member" href="#_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6IsHeadERKNS2_9ValueNodeE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::IsHead' data-use='c' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6IsHeadERKNS2_9ValueNodeE">IsHead</a>(*<a class="local col5 ref" href="#135first_src" title='first_src' data-ref="135first_src">first_src</a>));</td></tr>
<tr><th id="738">738</th><td>        <b>if</b> (!<a class="local col8 ref" href="#128is_live_range_before" title='is_live_range_before' data-ref="128is_live_range_before">is_live_range_before</a><a class="tu ref" href="#_ZZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12TryElideCopyEPKNS_14HloInstructionEENKUlRKNS2_9ValueNodeES8_E_clES8_S8_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::TryElideCopy(const xla::HloInstruction *)::(anonymous class)::operator()' data-use='c' data-ref="_ZZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12TryElideCopyEPKNS_14HloInstructionEENKUlRKNS2_9ValueNodeES8_E_clES8_S8_">(*<a class="local col4 ref" href="#134prev_dest" title='prev_dest' data-ref="134prev_dest">prev_dest</a>, *<a class="local col5 ref" href="#135first_src" title='first_src' data-ref="135first_src">first_src</a>)</a>) {</td></tr>
<tr><th id="739">739</th><td>          <i>// Live range of value d_{y-1} is not before s_0.</i></td></tr>
<tr><th id="740">740</th><td>          <b>return</b> <b>false</b>;</td></tr>
<tr><th id="741">741</th><td>        }</td></tr>
<tr><th id="742">742</th><td>        <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col6 decl" id="136next_dest" title='next_dest' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="136next_dest">next_dest</dfn> = <a class="tu member" href="#_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker4NextERKNS2_9ValueNodeE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::Next' data-use='c' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker4NextERKNS2_9ValueNodeE">Next</a>(*<a class="local col7 ref" href="#127dest" title='dest' data-ref="127dest">dest</a>);</td></tr>
<tr><th id="743">743</th><td>        <b>if</b> (<a class="local col6 ref" href="#136next_dest" title='next_dest' data-ref="136next_dest">next_dest</a> != <b>nullptr</b>) {</td></tr>
<tr><th id="744">744</th><td>          <b>if</b> (!<a class="local col8 ref" href="#128is_live_range_before" title='is_live_range_before' data-ref="128is_live_range_before">is_live_range_before</a><a class="tu ref" href="#_ZZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12TryElideCopyEPKNS_14HloInstructionEENKUlRKNS2_9ValueNodeES8_E_clES8_S8_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::TryElideCopy(const xla::HloInstruction *)::(anonymous class)::operator()' data-use='c' data-ref="_ZZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker12TryElideCopyEPKNS_14HloInstructionEENKUlRKNS2_9ValueNodeES8_E_clES8_S8_">(*<a class="local col6 ref" href="#126src" title='src' data-ref="126src">src</a>, *<a class="local col6 ref" href="#136next_dest" title='next_dest' data-ref="136next_dest">next_dest</a>)</a>) {</td></tr>
<tr><th id="745">745</th><td>            <i>// Live range of value s_n is not before d_{y+1}.</i></td></tr>
<tr><th id="746">746</th><td>            <b>return</b> <b>false</b>;</td></tr>
<tr><th id="747">747</th><td>          }</td></tr>
<tr><th id="748">748</th><td>        }</td></tr>
<tr><th id="749">749</th><td></td></tr>
<tr><th id="750">750</th><td>        <i>// Splice source buffer values list right after 'prev_dest'.</i></td></tr>
<tr><th id="751">751</th><td>        <a class="tu member" href="#_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker11SpliceAfterEPNS2_9ValueNodeES4_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::SpliceAfter' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker11SpliceAfterEPNS2_9ValueNodeES4_">SpliceAfter</a>(<a class="local col5 ref" href="#135first_src" title='first_src' data-ref="135first_src">first_src</a>, <a class="local col4 ref" href="#134prev_dest" title='prev_dest' data-ref="134prev_dest">prev_dest</a>);</td></tr>
<tr><th id="752">752</th><td>      } <b>else</b> {</td></tr>
<tr><th id="753">753</th><td>        <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((2) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 753, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>2</var>)</td></tr>
<tr><th id="754">754</th><td>            <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <a class="local col4 ref" href="#124copy" title='copy' data-ref="124copy">copy</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction4nameEv" title='xla::HloInstruction::name' data-ref="_ZNK3xla14HloInstruction4nameEv">name</a>()</td></tr>
<tr><th id="755">755</th><td>            <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsRSt13basic_ostreamIcT_EPKc" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIcT_EPKc">&lt;&lt;</a> <q>" copies value in middle of source buffer to value in middle "</q></td></tr>
<tr><th id="756">756</th><td>               <q>"of destination buffer"</q>;</td></tr>
<tr><th id="757">757</th><td>        <b>return</b> <b>false</b>;</td></tr>
<tr><th id="758">758</th><td>      }</td></tr>
<tr><th id="759">759</th><td></td></tr>
<tr><th id="760">760</th><td>      <a class="tu member" href="#_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker15RemoveCopyValueEPNS2_9ValueNodeE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::RemoveCopyValue' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker15RemoveCopyValueEPNS2_9ValueNodeE">RemoveCopyValue</a>(<a class="local col7 ref" href="#127dest" title='dest' data-ref="127dest">dest</a>);</td></tr>
<tr><th id="761">761</th><td></td></tr>
<tr><th id="762">762</th><td>      <a class="macro" href="../util.h.html#536" title="do { if (((4) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel())) ::xla::LogLines(::tensorflow::INFO, ToString(), &quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 762); } while (false);" data-ref="_M/XLA_VLOG_LINES">XLA_VLOG_LINES</a>(<var>4</var>, <a class="ref fake" href="../../../core/lib/core/stringpiece.h.html#_ZN10tensorflow11StringPieceC1ERKSs" title='tensorflow::StringPiece::StringPiece' data-ref="_ZN10tensorflow11StringPieceC1ERKSs"></a><a class="tu member" href="#_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker8ToStringEv" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ToString' data-use='c' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker8ToStringEv">ToString</a>());</td></tr>
<tr><th id="763">763</th><td>      <a class="macro" href="../../../core/lib/core/status.h.html#142" title="while (false &amp;&amp; (::tensorflow::Status::OK() == (Verify()))) ::tensorflow::internal::LogMessageFatal(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 763)" data-ref="_M/TF_DCHECK_OK">TF_DCHECK_OK</a>(<a class="tu member" href="#_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6VerifyEv" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::Verify' data-use='c' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6VerifyEv">Verify</a>());</td></tr>
<tr><th id="764">764</th><td></td></tr>
<tr><th id="765">765</th><td>      <b>return</b> <b>true</b>;</td></tr>
<tr><th id="766">766</th><td>    }</td></tr>
<tr><th id="767">767</th><td></td></tr>
<tr><th id="768">768</th><td>    <i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker15RemoveCopyValueEPNS2_9ValueNodeE">// Delete the given ValueNode associated with a elided kCopy</i></td></tr>
<tr><th id="769">769</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker15RemoveCopyValueEPNS2_9ValueNodeE">    // instruction. This should be called after splicing the value lists of the</i></td></tr>
<tr><th id="770">770</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker15RemoveCopyValueEPNS2_9ValueNodeE">    // source and destination buffers together.</i></td></tr>
<tr><th id="771">771</th><td>    <em>void</em> <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker15RemoveCopyValueEPNS2_9ValueNodeE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::RemoveCopyValue' data-type='void xla::(anonymous namespace)::CopyRemover::BufferValueTracker::RemoveCopyValue(xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode * copy_value_node)' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker15RemoveCopyValueEPNS2_9ValueNodeE">RemoveCopyValue</dfn>(<a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col7 decl" id="137copy_value_node" title='copy_value_node' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="137copy_value_node">copy_value_node</dfn>) {</td></tr>
<tr><th id="772">772</th><td>      <a class="macro" href="../../../core/platform/default/logging.h.html#251" title="while (::tensorflow::internal::CheckOpString _result = ::tensorflow::internal::Check_EQImpl( ::tensorflow::internal::GetReferenceableValue(copy_value_node-&gt;value-&gt;defining_instruction()-&gt;opcode()), ::tensorflow::internal::GetReferenceableValue(HloOpcode::kCopy), &quot;copy_value_node-&gt;value-&gt;defining_instruction()-&gt;opcode()&quot; &quot; &quot; &quot;==&quot; &quot; &quot; &quot;HloOpcode::kCopy&quot;)) ::tensorflow::internal::LogMessageFatal(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 773) &lt;&lt; *(_result.str_)" data-ref="_M/CHECK_EQ">CHECK_EQ</a>(<a class="local col7 ref" href="#137copy_value_node" title='copy_value_node' data-ref="137copy_value_node">copy_value_node</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue20defining_instructionEv" title='xla::HloValue::defining_instruction' data-ref="_ZNK3xla8HloValue20defining_instructionEv">defining_instruction</a>()-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction6opcodeEv" title='xla::HloInstruction::opcode' data-ref="_ZNK3xla14HloInstruction6opcodeEv">opcode</a>(),</td></tr>
<tr><th id="773">773</th><td>               <a class="type" href="hlo_opcode.h.html#xla::HloOpcode" title='xla::HloOpcode' data-ref="xla::HloOpcode">HloOpcode</a>::<a class="enum" href="hlo_opcode.h.html#135" title='xla::HloOpcode::kCopy' data-ref="xla::HloOpcode::kCopy">kCopy</a>);</td></tr>
<tr><th id="774">774</th><td>      <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col8 decl" id="138operand_node" title='operand_node' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="138operand_node">operand_node</dfn> = <a class="local col7 ref" href="#137copy_value_node" title='copy_value_node' data-ref="137copy_value_node">copy_value_node</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::prev' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev">prev</a>;</td></tr>
<tr><th id="775">775</th><td>      <a class="macro" href="../../../core/platform/default/logging.h.html#97" title="if ((__builtin_expect(!(operand_node != copy_value_node), 0))) ::tensorflow::internal::LogMessageFatal(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 775) &lt;&lt; &quot;Check failed: &quot; &quot;operand_node != copy_value_node&quot; &quot; &quot;" data-ref="_M/CHECK">CHECK</a>(<a class="local col8 ref" href="#138operand_node" title='operand_node' data-ref="138operand_node">operand_node</a> != <a class="local col7 ref" href="#137copy_value_node" title='copy_value_node' data-ref="137copy_value_node">copy_value_node</a>);</td></tr>
<tr><th id="776">776</th><td></td></tr>
<tr><th id="777">777</th><td>      <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((2) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 777, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>2</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <q>"Removing copy "</q> <a class="ref" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E">&lt;&lt;</a> <a class="local col8 ref" href="#138operand_node" title='operand_node' data-ref="138operand_node">operand_node</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue13ToShortStringEv" title='xla::HloValue::ToShortString' data-ref="_ZNK3xla8HloValue13ToShortStringEv">ToShortString</a>()</td></tr>
<tr><th id="778">778</th><td>              <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsRSt13basic_ostreamIcT_EPKc" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIcT_EPKc">&lt;&lt;</a> <q>" =&gt; "</q> <a class="ref" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E">&lt;&lt;</a> <a class="local col7 ref" href="#137copy_value_node" title='copy_value_node' data-ref="137copy_value_node">copy_value_node</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue13ToShortStringEv" title='xla::HloValue::ToShortString' data-ref="_ZNK3xla8HloValue13ToShortStringEv">ToShortString</a>();</td></tr>
<tr><th id="779">779</th><td></td></tr>
<tr><th id="780">780</th><td>      <i>// Splice out the copy value node.</i></td></tr>
<tr><th id="781">781</th><td>      <a class="local col8 ref" href="#138operand_node" title='operand_node' data-ref="138operand_node">operand_node</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::next' data-use='w' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next">next</a> = <a class="local col7 ref" href="#137copy_value_node" title='copy_value_node' data-ref="137copy_value_node">copy_value_node</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::next' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next">next</a>;</td></tr>
<tr><th id="782">782</th><td>      <a class="local col7 ref" href="#137copy_value_node" title='copy_value_node' data-ref="137copy_value_node">copy_value_node</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::next' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next">next</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::prev' data-use='w' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev">prev</a> = <a class="local col8 ref" href="#138operand_node" title='operand_node' data-ref="138operand_node">operand_node</a>;</td></tr>
<tr><th id="783">783</th><td></td></tr>
<tr><th id="784">784</th><td>      <i>// Patch up uses. Remove use of copy from operand_node uses.</i></td></tr>
<tr><th id="785">785</th><td>      <em>auto</em> <dfn class="local col9 decl" id="139it" title='it' data-type='__gnu_cxx::__normal_iterator&lt;const xla::HloUse **, std::vector&lt;const xla::HloUse *, std::allocator&lt;const xla::HloUse *&gt; &gt; &gt;' data-ref="139it">it</dfn> =</td></tr>
<tr><th id="786">786</th><td>          <span class="namespace">std::</span><a class="tu ref" href="../../../../../include/c++/5/bits/stl_algo.h.html#_ZSt7find_ifT_S_T0_" title='std::find_if' data-use='c' data-ref="_ZSt7find_ifT_S_T0_">find_if</a>(<a class="local col8 ref" href="#138operand_node" title='operand_node' data-ref="138operand_node">operand_node</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::uses' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses">uses</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vector5beginEv" title='std::vector::begin' data-ref="_ZNSt6vector5beginEv">begin</a>(), <a class="local col8 ref" href="#138operand_node" title='operand_node' data-ref="138operand_node">operand_node</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::uses' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses">uses</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vector3endEv" title='std::vector::end' data-ref="_ZNSt6vector3endEv">end</a>(),</td></tr>
<tr><th id="787">787</th><td>                       [copy_value_node](<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloUse" title='xla::HloUse' data-ref="xla::HloUse">HloUse</a>* <dfn class="local col0 decl" id="140use" title='use' data-type='const xla::HloUse *' data-ref="140use">use</dfn>) {</td></tr>
<tr><th id="788">788</th><td>                         <b>return</b> <a class="local col0 ref" href="#140use" title='use' data-ref="140use">use</a>-&gt;<a class="ref" href="hlo_value.h.html#xla::HloUse::instruction" title='xla::HloUse::instruction' data-ref="xla::HloUse::instruction">instruction</a> ==</td></tr>
<tr><th id="789">789</th><td>                                <a class="local col7 ref" href="#137copy_value_node" title='copy_value_node' data-ref="137copy_value_node">copy_value_node</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue20defining_instructionEv" title='xla::HloValue::defining_instruction' data-ref="_ZNK3xla8HloValue20defining_instructionEv">defining_instruction</a>();</td></tr>
<tr><th id="790">790</th><td>                       });</td></tr>
<tr><th id="791">791</th><td>      <a class="macro" href="../../../core/platform/default/logging.h.html#97" title="if ((__builtin_expect(!(it != operand_node-&gt;uses.end()), 0))) ::tensorflow::internal::LogMessageFatal(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 791) &lt;&lt; &quot;Check failed: &quot; &quot;it != operand_node-&gt;uses.end()&quot; &quot; &quot;" data-ref="_M/CHECK">CHECK</a>(<a class="local col9 ref" href="#139it" title='it' data-ref="139it">it</a> <a class="ref" href="../../../../../include/c++/5/bits/stl_iterator.h.html#__gnu_cxx::operator!=" title='__gnu_cxx::operator!=' data-ref="__gnu_cxx::operator!=">!=</a> <a class="local col8 ref" href="#138operand_node" title='operand_node' data-ref="138operand_node">operand_node</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::uses' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses">uses</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vector3endEv" title='std::vector::end' data-ref="_ZNSt6vector3endEv">end</a>());</td></tr>
<tr><th id="792">792</th><td>      <a class="local col8 ref" href="#138operand_node" title='operand_node' data-ref="138operand_node">operand_node</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::uses' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses">uses</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vector5eraseEN9__gnu_cxx17__normal_iteratorINS0_14__alloc_traitsINSt12_Vector_baseIT_T0_E14_Tp_alloc_typeEE13const_pointerESt6vectorIS4_S5_EEE" title='std::vector::erase' data-ref="_ZNSt6vector5eraseEN9__gnu_cxx17__normal_iteratorINS0_14__alloc_traitsINSt12_Vector_baseIT_T0_E14_Tp_alloc_typeEE13const_pointerESt6vectorIS4_S5_EEE">erase</a>(<a class="ref fake" href="../../../../../include/c++/5/bits/stl_iterator.h.html#__gnu_cxx::__normal_iterator::__normal_iterator{_Iterator,_Container}" title='__gnu_cxx::__normal_iterator::__normal_iterator&lt;_Iterator, _Container&gt;' data-ref="__gnu_cxx::__normal_iterator::__normal_iterator{_Iterator,_Container}"></a><a class="local col9 ref" href="#139it" title='it' data-ref="139it">it</a>);</td></tr>
<tr><th id="793">793</th><td></td></tr>
<tr><th id="794">794</th><td>      <i>// If the elided copy has any uses which are themselves kCopy instructions</i></td></tr>
<tr><th id="795">795</th><td><i>      // then patch up the copy info to reflect the that this kCopy instruction</i></td></tr>
<tr><th id="796">796</th><td><i>      // has a different operand (the operand of the elided copy).</i></td></tr>
<tr><th id="797">797</th><td>      <b>for</b> (<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloUse" title='xla::HloUse' data-ref="xla::HloUse">HloUse</a>* <dfn class="local col1 decl" id="141copy_use" title='copy_use' data-type='const xla::HloUse *' data-ref="141copy_use">copy_use</dfn> : <a class="local col7 ref" href="#137copy_value_node" title='copy_value_node' data-ref="137copy_value_node">copy_value_node</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::uses' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses">uses</a>) {</td></tr>
<tr><th id="798">798</th><td>        <a class="local col8 ref" href="#138operand_node" title='operand_node' data-ref="138operand_node">operand_node</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::uses' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses">uses</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vector9push_backERKT_" title='std::vector::push_back' data-ref="_ZNSt6vector9push_backERKT_">push_back</a>(<a class="local col1 ref" href="#141copy_use" title='copy_use' data-ref="141copy_use">copy_use</a>);</td></tr>
<tr><th id="799">799</th><td>        <b>if</b> (<a class="local col1 ref" href="#141copy_use" title='copy_use' data-ref="141copy_use">copy_use</a>-&gt;<a class="ref" href="hlo_value.h.html#xla::HloUse::instruction" title='xla::HloUse::instruction' data-ref="xla::HloUse::instruction">instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction6opcodeEv" title='xla::HloInstruction::opcode' data-ref="_ZNK3xla14HloInstruction6opcodeEv">opcode</a>() == <a class="type" href="hlo_opcode.h.html#xla::HloOpcode" title='xla::HloOpcode' data-ref="xla::HloOpcode">HloOpcode</a>::<a class="enum" href="hlo_opcode.h.html#135" title='xla::HloOpcode::kCopy' data-ref="xla::HloOpcode::kCopy">kCopy</a> &amp;&amp;</td></tr>
<tr><th id="800">800</th><td>            <a class="tu ref" href="../map_util.h.html#_ZN3xla11ContainsKeyERKT_RKT0_" title='xla::ContainsKey' data-use='c' data-ref="_ZN3xla11ContainsKeyERKT_RKT0_">ContainsKey</a>(<a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::copy_map_' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_">copy_map_</a>, <a class="local col1 ref" href="#141copy_use" title='copy_use' data-ref="141copy_use">copy_use</a>-&gt;<a class="ref" href="hlo_value.h.html#xla::HloUse::instruction" title='xla::HloUse::instruction' data-ref="xla::HloUse::instruction">instruction</a>)) {</td></tr>
<tr><th id="801">801</th><td>          <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::copy_map_' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_">copy_map_</a>.<a class="tu ref" href="../../../core/lib/gtl/flatmap.h.html#_ZN10tensorflow3gtl7FlatMap2atERKT_" title='tensorflow::gtl::FlatMap::at' data-use='c' data-ref="_ZN10tensorflow3gtl7FlatMap2atERKT_">at</a>(<a class="local col1 ref" href="#141copy_use" title='copy_use' data-ref="141copy_use">copy_use</a>-&gt;<a class="ref" href="hlo_value.h.html#xla::HloUse::instruction" title='xla::HloUse::instruction' data-ref="xla::HloUse::instruction">instruction</a>).<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes::src" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CopyNodes::src' data-use='w' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes::src">src</a> = <a class="local col8 ref" href="#138operand_node" title='operand_node' data-ref="138operand_node">operand_node</a>;</td></tr>
<tr><th id="802">802</th><td>        }</td></tr>
<tr><th id="803">803</th><td>      }</td></tr>
<tr><th id="804">804</th><td></td></tr>
<tr><th id="805">805</th><td>      <i>// Delete the copy info and the value node.</i></td></tr>
<tr><th id="806">806</th><td>      <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::copy_map_' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_">copy_map_</a>.<a class="tu ref" href="../../../core/lib/gtl/flatmap.h.html#_ZN10tensorflow3gtl7FlatMap5eraseERKT_" title='tensorflow::gtl::FlatMap::erase' data-use='c' data-ref="_ZN10tensorflow3gtl7FlatMap5eraseERKT_">erase</a>(<a class="local col7 ref" href="#137copy_value_node" title='copy_value_node' data-ref="137copy_value_node">copy_value_node</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue20defining_instructionEv" title='xla::HloValue::defining_instruction' data-ref="_ZNK3xla8HloValue20defining_instructionEv">defining_instruction</a>());</td></tr>
<tr><th id="807">807</th><td>      <b>delete</b> <a class="local col7 ref" href="#137copy_value_node" title='copy_value_node' data-ref="137copy_value_node">copy_value_node</a>;</td></tr>
<tr><th id="808">808</th><td>    }</td></tr>
<tr><th id="809">809</th><td></td></tr>
<tr><th id="810">810</th><td>    <i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker15LiveRangeBeforeERKNS2_9ValueNodeES5_">// Returns true if the live range of given value 'a' is before the live</i></td></tr>
<tr><th id="811">811</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker15LiveRangeBeforeERKNS2_9ValueNodeES5_">    // range of 'b'.</i></td></tr>
<tr><th id="812">812</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker15LiveRangeBeforeERKNS2_9ValueNodeES5_">    //</i></td></tr>
<tr><th id="813">813</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker15LiveRangeBeforeERKNS2_9ValueNodeES5_">    // We cannot use LiveRangeStrictlyBefore because HloValue::uses() is not</i></td></tr>
<tr><th id="814">814</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker15LiveRangeBeforeERKNS2_9ValueNodeES5_">    // updated as copies are removed.</i></td></tr>
<tr><th id="815">815</th><td>    <em>bool</em> <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker15LiveRangeBeforeERKNS2_9ValueNodeES5_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::LiveRangeBefore' data-type='bool xla::(anonymous namespace)::CopyRemover::BufferValueTracker::LiveRangeBefore(const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode &amp; a, const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode &amp; b)' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker15LiveRangeBeforeERKNS2_9ValueNodeES5_">LiveRangeBefore</dfn>(<em>const</em> <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>&amp; <dfn class="local col2 decl" id="142a" title='a' data-type='const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode &amp;' data-ref="142a">a</dfn>, <em>const</em> <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>&amp; <dfn class="local col3 decl" id="143b" title='b' data-type='const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode &amp;' data-ref="143b">b</dfn>) {</td></tr>
<tr><th id="816">816</th><td>      <b>if</b> (<a class="local col2 ref" href="#142a" title='a' data-ref="142a">a</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::uses' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses">uses</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNKSt6vector5emptyEv" title='std::vector::empty' data-ref="_ZNKSt6vector5emptyEv">empty</a>()) {</td></tr>
<tr><th id="817">817</th><td>        <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((2) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 817, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>2</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <q>"Empty uses for "</q> <a class="ref" href="hlo_value.h.html#_ZN3xlalsERSoRKNS_8HloValueE" title='xla::operator&lt;&lt;' data-ref="_ZN3xlalsERSoRKNS_8HloValueE">&lt;&lt;</a> *<a class="local col2 ref" href="#142a" title='a' data-ref="142a">a</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>;</td></tr>
<tr><th id="818">818</th><td>        <b>return</b> <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ordering_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ordering_' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ordering_">ordering_</a>.<a class="ref" href="hlo_ordering.h.html#_ZNK3xla11HloOrdering15IsDefinedBeforeERKNS_8HloValueES3_" title='xla::HloOrdering::IsDefinedBefore' data-ref="_ZNK3xla11HloOrdering15IsDefinedBeforeERKNS_8HloValueES3_">IsDefinedBefore</a>(*<a class="local col2 ref" href="#142a" title='a' data-ref="142a">a</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>, *<a class="local col3 ref" href="#143b" title='b' data-ref="143b">b</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>);</td></tr>
<tr><th id="819">819</th><td>      }</td></tr>
<tr><th id="820">820</th><td>      <b>for</b> (<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloUse" title='xla::HloUse' data-ref="xla::HloUse">HloUse</a>* <dfn class="local col4 decl" id="144use" title='use' data-type='const xla::HloUse *' data-ref="144use">use</dfn> : <a class="local col2 ref" href="#142a" title='a' data-ref="142a">a</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::uses' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses">uses</a>) {</td></tr>
<tr><th id="821">821</th><td>        <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((2) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 821, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>2</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <q>"Checking use "</q> <a class="ref" href="hlo_value.h.html#_ZN3xlalsERSoRKNS_6HloUseE" title='xla::operator&lt;&lt;' data-ref="_ZN3xlalsERSoRKNS_6HloUseE">&lt;&lt;</a> *<a class="local col4 ref" href="#144use" title='use' data-ref="144use">use</a> <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsRSt13basic_ostreamIcT_EPKc" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIcT_EPKc">&lt;&lt;</a> <q>" against "</q> <a class="ref" href="hlo_value.h.html#_ZN3xlalsERSoRKNS_8HloValueE" title='xla::operator&lt;&lt;' data-ref="_ZN3xlalsERSoRKNS_8HloValueE">&lt;&lt;</a> *<a class="local col3 ref" href="#143b" title='b' data-ref="143b">b</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>;</td></tr>
<tr><th id="822">822</th><td>        <b>if</b> (!<a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ordering_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ordering_' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ordering_">ordering_</a>.<a class="ref" href="hlo_ordering.h.html#_ZNK3xla11HloOrdering26UseIsBeforeValueDefinitionERKNS_6HloUseERKNS_8HloValueERKNS_19HloDataflowAnalysisE" title='xla::HloOrdering::UseIsBeforeValueDefinition' data-ref="_ZNK3xla11HloOrdering26UseIsBeforeValueDefinitionERKNS_6HloUseERKNS_8HloValueERKNS_19HloDataflowAnalysisE">UseIsBeforeValueDefinition</a>(*<a class="local col4 ref" href="#144use" title='use' data-ref="144use">use</a>, *<a class="local col3 ref" href="#143b" title='b' data-ref="143b">b</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>, <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::dataflow_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::dataflow_' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::dataflow_">dataflow_</a>)) {</td></tr>
<tr><th id="823">823</th><td>          <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((2) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 823, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>2</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <q>"Use "</q> <a class="ref" href="hlo_value.h.html#_ZN3xlalsERSoRKNS_6HloUseE" title='xla::operator&lt;&lt;' data-ref="_ZN3xlalsERSoRKNS_6HloUseE">&lt;&lt;</a> *<a class="local col4 ref" href="#144use" title='use' data-ref="144use">use</a> <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsRSt13basic_ostreamIcT_EPKc" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIcT_EPKc">&lt;&lt;</a> <q>" is NOT before "</q> <a class="ref" href="hlo_value.h.html#_ZN3xlalsERSoRKNS_8HloValueE" title='xla::operator&lt;&lt;' data-ref="_ZN3xlalsERSoRKNS_8HloValueE">&lt;&lt;</a> *<a class="local col3 ref" href="#143b" title='b' data-ref="143b">b</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>;</td></tr>
<tr><th id="824">824</th><td>          <b>return</b> <b>false</b>;</td></tr>
<tr><th id="825">825</th><td>        }</td></tr>
<tr><th id="826">826</th><td>        <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((2) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 826, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>2</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <q>"Use "</q> <a class="ref" href="hlo_value.h.html#_ZN3xlalsERSoRKNS_6HloUseE" title='xla::operator&lt;&lt;' data-ref="_ZN3xlalsERSoRKNS_6HloUseE">&lt;&lt;</a> *<a class="local col4 ref" href="#144use" title='use' data-ref="144use">use</a> <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsRSt13basic_ostreamIcT_EPKc" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIcT_EPKc">&lt;&lt;</a> <q>" is before "</q> <a class="ref" href="hlo_value.h.html#_ZN3xlalsERSoRKNS_8HloValueE" title='xla::operator&lt;&lt;' data-ref="_ZN3xlalsERSoRKNS_8HloValueE">&lt;&lt;</a> *<a class="local col3 ref" href="#143b" title='b' data-ref="143b">b</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>;</td></tr>
<tr><th id="827">827</th><td>      }</td></tr>
<tr><th id="828">828</th><td>      <b>return</b> <b>true</b>;</td></tr>
<tr><th id="829">829</th><td>    }</td></tr>
<tr><th id="830">830</th><td></td></tr>
<tr><th id="831">831</th><td>    <i  data-doc="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6IsTailERKNS2_9ValueNodeE">// Returns whether 'node' is the last node in its list.</i></td></tr>
<tr><th id="832">832</th><td>    <em>bool</em> <dfn class="tu decl def" id="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6IsTailERKNS2_9ValueNodeE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::IsTail' data-type='bool xla::(anonymous namespace)::CopyRemover::BufferValueTracker::IsTail(const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode &amp; node) const' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6IsTailERKNS2_9ValueNodeE">IsTail</dfn>(<em>const</em> <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>&amp; <dfn class="local col5 decl" id="145node" title='node' data-type='const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode &amp;' data-ref="145node">node</dfn>) <em>const</em> {</td></tr>
<tr><th id="833">833</th><td>      <b>return</b> <a class="tu ref" href="../map_util.h.html#_ZN3xla11ContainsKeyERKT_RKT0_" title='xla::ContainsKey' data-use='c' data-ref="_ZN3xla11ContainsKeyERKT_RKT0_">ContainsKey</a>(<a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::value_lists_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::value_lists_' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::value_lists_">value_lists_</a>, <a class="local col5 ref" href="#145node" title='node' data-ref="145node">node</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::next' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next">next</a>);</td></tr>
<tr><th id="834">834</th><td>    }</td></tr>
<tr><th id="835">835</th><td></td></tr>
<tr><th id="836">836</th><td>    <i  data-doc="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6IsHeadERKNS2_9ValueNodeE">// Returns whether 'node' is the first node in its list.</i></td></tr>
<tr><th id="837">837</th><td>    <em>bool</em> <dfn class="tu decl def" id="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6IsHeadERKNS2_9ValueNodeE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::IsHead' data-type='bool xla::(anonymous namespace)::CopyRemover::BufferValueTracker::IsHead(const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode &amp; node) const' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6IsHeadERKNS2_9ValueNodeE">IsHead</dfn>(<em>const</em> <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>&amp; <dfn class="local col6 decl" id="146node" title='node' data-type='const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode &amp;' data-ref="146node">node</dfn>) <em>const</em> {</td></tr>
<tr><th id="838">838</th><td>      <b>return</b> <a class="tu ref" href="../map_util.h.html#_ZN3xla11ContainsKeyERKT_RKT0_" title='xla::ContainsKey' data-use='c' data-ref="_ZN3xla11ContainsKeyERKT_RKT0_">ContainsKey</a>(<a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::value_lists_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::value_lists_' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::value_lists_">value_lists_</a>, &amp;<a class="local col6 ref" href="#146node" title='node' data-ref="146node">node</a>);</td></tr>
<tr><th id="839">839</th><td>    }</td></tr>
<tr><th id="840">840</th><td></td></tr>
<tr><th id="841">841</th><td>    <i  data-doc="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker4NextERKNS2_9ValueNodeE">// Returns the next node in the list after 'node'. If 'node' is the</i></td></tr>
<tr><th id="842">842</th><td><i  data-doc="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker4NextERKNS2_9ValueNodeE">    // tail, then nullptr is returned.</i></td></tr>
<tr><th id="843">843</th><td>    <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="tu decl def" id="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker4NextERKNS2_9ValueNodeE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::Next' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode * xla::(anonymous namespace)::CopyRemover::BufferValueTracker::Next(const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode &amp; node) const' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker4NextERKNS2_9ValueNodeE">Next</dfn>(<em>const</em> <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>&amp; <dfn class="local col7 decl" id="147node" title='node' data-type='const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode &amp;' data-ref="147node">node</dfn>) <em>const</em> {</td></tr>
<tr><th id="844">844</th><td>      <b>if</b> (<a class="tu member" href="#_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6IsTailERKNS2_9ValueNodeE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::IsTail' data-use='c' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6IsTailERKNS2_9ValueNodeE">IsTail</a>(<a class="local col7 ref" href="#147node" title='node' data-ref="147node">node</a>)) {</td></tr>
<tr><th id="845">845</th><td>        <b>return</b> <b>nullptr</b>;</td></tr>
<tr><th id="846">846</th><td>      } <b>else</b> {</td></tr>
<tr><th id="847">847</th><td>        <b>return</b> <a class="local col7 ref" href="#147node" title='node' data-ref="147node">node</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::next' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next">next</a>;</td></tr>
<tr><th id="848">848</th><td>      }</td></tr>
<tr><th id="849">849</th><td>    }</td></tr>
<tr><th id="850">850</th><td></td></tr>
<tr><th id="851">851</th><td>    <i  data-doc="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker4PrevERKNS2_9ValueNodeE">// Returns the previous node in the list before 'node'. If 'node'</i></td></tr>
<tr><th id="852">852</th><td><i  data-doc="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker4PrevERKNS2_9ValueNodeE">    // is the head, then nullptr is returned.</i></td></tr>
<tr><th id="853">853</th><td>    <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="tu decl def" id="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker4PrevERKNS2_9ValueNodeE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::Prev' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode * xla::(anonymous namespace)::CopyRemover::BufferValueTracker::Prev(const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode &amp; node) const' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker4PrevERKNS2_9ValueNodeE">Prev</dfn>(<em>const</em> <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>&amp; <dfn class="local col8 decl" id="148node" title='node' data-type='const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode &amp;' data-ref="148node">node</dfn>) <em>const</em> {</td></tr>
<tr><th id="854">854</th><td>      <b>if</b> (<a class="tu member" href="#_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6IsHeadERKNS2_9ValueNodeE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::IsHead' data-use='c' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6IsHeadERKNS2_9ValueNodeE">IsHead</a>(<a class="local col8 ref" href="#148node" title='node' data-ref="148node">node</a>)) {</td></tr>
<tr><th id="855">855</th><td>        <b>return</b> <b>nullptr</b>;</td></tr>
<tr><th id="856">856</th><td>      } <b>else</b> {</td></tr>
<tr><th id="857">857</th><td>        <b>return</b> <a class="local col8 ref" href="#148node" title='node' data-ref="148node">node</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::prev' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev">prev</a>;</td></tr>
<tr><th id="858">858</th><td>      }</td></tr>
<tr><th id="859">859</th><td>    }</td></tr>
<tr><th id="860">860</th><td></td></tr>
<tr><th id="861">861</th><td>    <i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker11SpliceAfterEPNS2_9ValueNodeES4_">// Splices the entire linked list with 'head' as its head right after the</i></td></tr>
<tr><th id="862">862</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker11SpliceAfterEPNS2_9ValueNodeES4_">    // node 'insert_after' in another linked list.</i></td></tr>
<tr><th id="863">863</th><td>    <em>void</em> <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker11SpliceAfterEPNS2_9ValueNodeES4_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::SpliceAfter' data-type='void xla::(anonymous namespace)::CopyRemover::BufferValueTracker::SpliceAfter(xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode * head, xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode * insert_after)' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker11SpliceAfterEPNS2_9ValueNodeES4_">SpliceAfter</dfn>(<a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col9 decl" id="149head" title='head' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="149head">head</dfn>, <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col0 decl" id="150insert_after" title='insert_after' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="150insert_after">insert_after</dfn>) {</td></tr>
<tr><th id="864">864</th><td>      <a class="macro" href="../../../core/platform/default/logging.h.html#273" title="while (false &amp;&amp; (IsHead(*head))) ::tensorflow::internal::LogMessageFatal(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 864)" data-ref="_M/DCHECK">DCHECK</a>(<a class="tu member" href="#_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6IsHeadERKNS2_9ValueNodeE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::IsHead' data-use='c' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6IsHeadERKNS2_9ValueNodeE">IsHead</a>(*<a class="local col9 ref" href="#149head" title='head' data-ref="149head">head</a>));</td></tr>
<tr><th id="865">865</th><td>      <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::value_lists_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::value_lists_' data-use='m' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::value_lists_">value_lists_</a>.<a class="tu ref" href="../../../core/lib/gtl/flatset.h.html#_ZN10tensorflow3gtl7FlatSet5eraseERKT_" title='tensorflow::gtl::FlatSet::erase' data-use='c' data-ref="_ZN10tensorflow3gtl7FlatSet5eraseERKT_">erase</a>(<a class="local col9 ref" href="#149head" title='head' data-ref="149head">head</a>);</td></tr>
<tr><th id="866">866</th><td></td></tr>
<tr><th id="867">867</th><td>      <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col1 decl" id="151tail" title='tail' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="151tail">tail</dfn> = <a class="local col9 ref" href="#149head" title='head' data-ref="149head">head</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::prev' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev">prev</a>;</td></tr>
<tr><th id="868">868</th><td>      <a class="local col1 ref" href="#151tail" title='tail' data-ref="151tail">tail</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::next' data-use='w' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next">next</a> = <a class="local col0 ref" href="#150insert_after" title='insert_after' data-ref="150insert_after">insert_after</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::next' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next">next</a>;</td></tr>
<tr><th id="869">869</th><td>      <a class="local col0 ref" href="#150insert_after" title='insert_after' data-ref="150insert_after">insert_after</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::next' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next">next</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::prev' data-use='w' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev">prev</a> = <a class="local col1 ref" href="#151tail" title='tail' data-ref="151tail">tail</a>;</td></tr>
<tr><th id="870">870</th><td></td></tr>
<tr><th id="871">871</th><td>      <a class="local col0 ref" href="#150insert_after" title='insert_after' data-ref="150insert_after">insert_after</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::next' data-use='w' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next">next</a> = <a class="local col9 ref" href="#149head" title='head' data-ref="149head">head</a>;</td></tr>
<tr><th id="872">872</th><td>      <a class="local col9 ref" href="#149head" title='head' data-ref="149head">head</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::prev' data-use='w' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::prev">prev</a> = <a class="local col0 ref" href="#150insert_after" title='insert_after' data-ref="150insert_after">insert_after</a>;</td></tr>
<tr><th id="873">873</th><td>    }</td></tr>
<tr><th id="874">874</th><td></td></tr>
<tr><th id="875">875</th><td>    <a class="typedef" href="../../../../../include/c++/5/bits/stringfwd.h.html#std::string" title='std::string' data-type='basic_string&lt;char&gt;' data-ref="std::string">string</a> <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker17ValueListToStringEPKNS2_9ValueNodeE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueListToString' data-type='string xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueListToString(const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode * element)' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker17ValueListToStringEPKNS2_9ValueNodeE">ValueListToString</dfn>(<em>const</em> <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col2 decl" id="152element" title='element' data-type='const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="152element">element</dfn>) {</td></tr>
<tr><th id="876">876</th><td>      <em>const</em> <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col3 decl" id="153head" title='head' data-type='const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="153head">head</dfn> = <a class="local col2 ref" href="#152element" title='element' data-ref="152element">element</a>;</td></tr>
<tr><th id="877">877</th><td>      <b>while</b> (!<a class="tu member" href="#_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6IsHeadERKNS2_9ValueNodeE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::IsHead' data-use='c' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker6IsHeadERKNS2_9ValueNodeE">IsHead</a>(*<a class="local col3 ref" href="#153head" title='head' data-ref="153head">head</a>)) {</td></tr>
<tr><th id="878">878</th><td>        <a class="local col3 ref" href="#153head" title='head' data-ref="153head">head</a> = <a class="tu member" href="#_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker4PrevERKNS2_9ValueNodeE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::Prev' data-use='c' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker4PrevERKNS2_9ValueNodeE">Prev</a>(*<a class="local col3 ref" href="#153head" title='head' data-ref="153head">head</a>);</td></tr>
<tr><th id="879">879</th><td>      }</td></tr>
<tr><th id="880">880</th><td>      <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValue" title='xla::HloValue' data-ref="xla::HloValue">HloValue</a>*&gt; <a class="ref fake" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorC1Ev" title='std::vector::vector&lt;_Tp, _Alloc&gt;' data-ref="_ZNSt6vectorC1Ev"></a><dfn class="local col4 decl" id="154values" title='values' data-type='std::vector&lt;const HloValue *&gt;' data-ref="154values">values</dfn>;</td></tr>
<tr><th id="881">881</th><td>      <b>for</b> (<em>const</em> <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col5 decl" id="155p" title='p' data-type='const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="155p">p</dfn> = <a class="local col3 ref" href="#153head" title='head' data-ref="153head">head</a>; <a class="local col5 ref" href="#155p" title='p' data-ref="155p">p</a> != <b>nullptr</b>; <a class="local col5 ref" href="#155p" title='p' data-ref="155p">p</a> = <a class="tu member" href="#_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker4NextERKNS2_9ValueNodeE" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::Next' data-use='c' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker4NextERKNS2_9ValueNodeE">Next</a>(*<a class="local col5 ref" href="#155p" title='p' data-ref="155p">p</a>)) {</td></tr>
<tr><th id="882">882</th><td>        <a class="local col4 ref" href="#154values" title='values' data-ref="154values">values</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vector9push_backERKT_" title='std::vector::push_back' data-ref="_ZNSt6vector9push_backERKT_">push_back</a>(<a class="local col5 ref" href="#155p" title='p' data-ref="155p">p</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>);</td></tr>
<tr><th id="883">883</th><td>      }</td></tr>
<tr><th id="884">884</th><td>      <b>return</b> <a class="ref" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings6StrCatERKNS0_8AlphaNumES3_S3_" title='tensorflow::strings::StrCat' data-ref="_ZN10tensorflow7strings6StrCatERKNS0_8AlphaNumES3_S3_">StrCat</a>(<a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1EPKc" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1EPKc"></a><q>"{"</q>,</td></tr>
<tr><th id="885">885</th><td>                    <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1ERKSs" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1ERKSs"></a><a class="tu ref" href="../../../core/lib/strings/str_util.h.html#_ZN10tensorflow8str_util4JoinERKT_PKcT0_" title='tensorflow::str_util::Join' data-use='c' data-ref="_ZN10tensorflow8str_util4JoinERKT_PKcT0_">Join</a>(<a class="local col4 ref" href="#154values" title='values' data-ref="154values">values</a>, <q>", "</q>,</td></tr>
<tr><th id="886">886</th><td>                         [](<a class="typedef" href="../../../../../include/c++/5/bits/stringfwd.h.html#std::string" title='std::string' data-type='basic_string&lt;char&gt;' data-ref="std::string">string</a>* <dfn class="local col6 decl" id="156s" title='s' data-type='string *' data-ref="156s">s</dfn>, <em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValue" title='xla::HloValue' data-ref="xla::HloValue">HloValue</a>* <dfn class="local col7 decl" id="157value" title='value' data-type='const xla::HloValue *' data-ref="157value">value</dfn>) {</td></tr>
<tr><th id="887">887</th><td>                           <a class="ref" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings9StrAppendEPSsRKNS0_8AlphaNumE" title='tensorflow::strings::StrAppend' data-ref="_ZN10tensorflow7strings9StrAppendEPSsRKNS0_8AlphaNumE">StrAppend</a>(<a class="local col6 ref" href="#156s" title='s' data-ref="156s">s</a>, <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1ERKSs" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1ERKSs"></a><a class="local col7 ref" href="#157value" title='value' data-ref="157value">value</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue13ToShortStringEv" title='xla::HloValue::ToShortString' data-ref="_ZNK3xla8HloValue13ToShortStringEv">ToShortString</a>());</td></tr>
<tr><th id="888">888</th><td>                         }),</td></tr>
<tr><th id="889">889</th><td>                    <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1EPKc" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1EPKc"></a><q>"}"</q>);</td></tr>
<tr><th id="890">890</th><td>    }</td></tr>
<tr><th id="891">891</th><td></td></tr>
<tr><th id="892">892</th><td>    <a class="typedef" href="../../../../../include/c++/5/bits/stringfwd.h.html#std::string" title='std::string' data-type='basic_string&lt;char&gt;' data-ref="std::string">string</a> <dfn class="tu decl def" id="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker8ToStringEv" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ToString' data-type='string xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ToString() const' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover18BufferValueTracker8ToStringEv">ToString</dfn>() <em>const</em> {</td></tr>
<tr><th id="893">893</th><td>      <a class="typedef" href="../../../../../include/c++/5/bits/stringfwd.h.html#std::string" title='std::string' data-type='basic_string&lt;char&gt;' data-ref="std::string">string</a> <dfn class="local col8 decl" id="158out" title='out' data-type='string' data-ref="158out">out</dfn> = <a class="ref" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings6StrCatERKNS0_8AlphaNumE" title='tensorflow::strings::StrCat' data-ref="_ZN10tensorflow7strings6StrCatERKNS0_8AlphaNumE">StrCat</a>(<a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1EPKc" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1EPKc"></a><q>"BufferValueTracker:\n"</q>);</td></tr>
<tr><th id="894">894</th><td>      <a class="ref" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings9StrAppendEPSsRKNS0_8AlphaNumE" title='tensorflow::strings::StrAppend' data-ref="_ZN10tensorflow7strings9StrAppendEPSsRKNS0_8AlphaNumE">StrAppend</a>(&amp;<a class="local col8 ref" href="#158out" title='out' data-ref="158out">out</a>, <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1EPKc" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1EPKc"></a><q>"  Def-use chains in each buffer:\n"</q>);</td></tr>
<tr><th id="895">895</th><td>      <b>for</b> (<em>const</em> <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col9 decl" id="159head" title='head' data-type='const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="159head">head</dfn> : <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::value_lists_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::value_lists_' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::value_lists_">value_lists_</a>) {</td></tr>
<tr><th id="896">896</th><td>        <a class="ref" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings9StrAppendEPSsRKNS0_8AlphaNumES4_S4_" title='tensorflow::strings::StrAppend' data-ref="_ZN10tensorflow7strings9StrAppendEPSsRKNS0_8AlphaNumES4_S4_">StrAppend</a>(&amp;<a class="local col8 ref" href="#158out" title='out' data-ref="158out">out</a>, <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1EPKc" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1EPKc"></a><q>"    Buffer defined by "</q>, <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1ERKSs" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1ERKSs"></a><a class="local col9 ref" href="#159head" title='head' data-ref="159head">head</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue13ToShortStringEv" title='xla::HloValue::ToShortString' data-ref="_ZNK3xla8HloValue13ToShortStringEv">ToShortString</a>(),</td></tr>
<tr><th id="897">897</th><td>                  <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1EPKc" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1EPKc"></a><q>":\n"</q>);</td></tr>
<tr><th id="898">898</th><td>        <em>const</em> <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="local col0 decl" id="160p" title='p' data-type='const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="160p">p</dfn> = <a class="local col9 ref" href="#159head" title='head' data-ref="159head">head</a>;</td></tr>
<tr><th id="899">899</th><td>        <b>do</b> {</td></tr>
<tr><th id="900">900</th><td>          <a class="ref" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings9StrAppendEPSsRKNS0_8AlphaNumES4_S4_S4_S4_DpRKT_" title='tensorflow::strings::StrAppend' data-ref="_ZN10tensorflow7strings9StrAppendEPSsRKNS0_8AlphaNumES4_S4_S4_S4_DpRKT_">StrAppend</a>(&amp;<a class="local col8 ref" href="#158out" title='out' data-ref="158out">out</a>, <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1EPKc" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1EPKc"></a><q>"      "</q>, <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1ERKSs" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1ERKSs"></a><a class="local col0 ref" href="#160p" title='p' data-ref="160p">p</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue13ToShortStringEv" title='xla::HloValue::ToShortString' data-ref="_ZNK3xla8HloValue13ToShortStringEv">ToShortString</a>(), <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1EPKc" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1EPKc"></a><q>", uses: "</q>,</td></tr>
<tr><th id="901">901</th><td>                    <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1ERKSs" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1ERKSs"></a><a class="tu ref" href="../../../core/lib/strings/str_util.h.html#_ZN10tensorflow8str_util4JoinERKT_PKcT0_" title='tensorflow::str_util::Join' data-use='c' data-ref="_ZN10tensorflow8str_util4JoinERKT_PKcT0_">Join</a>(<a class="local col0 ref" href="#160p" title='p' data-ref="160p">p</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::uses' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::uses">uses</a>, <q>"; "</q>,</td></tr>
<tr><th id="902">902</th><td>                         [](<a class="typedef" href="../../../../../include/c++/5/bits/stringfwd.h.html#std::string" title='std::string' data-type='basic_string&lt;char&gt;' data-ref="std::string">string</a>* <dfn class="local col1 decl" id="161s" title='s' data-type='string *' data-ref="161s">s</dfn>, <em>const</em> <a class="type" href="hlo_value.h.html#xla::HloUse" title='xla::HloUse' data-ref="xla::HloUse">HloUse</a>* <dfn class="local col2 decl" id="162use" title='use' data-type='const xla::HloUse *' data-ref="162use">use</dfn>) {</td></tr>
<tr><th id="903">903</th><td>                           <a class="ref" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings9StrAppendEPSsRKNS0_8AlphaNumE" title='tensorflow::strings::StrAppend' data-ref="_ZN10tensorflow7strings9StrAppendEPSsRKNS0_8AlphaNumE">StrAppend</a>(<a class="local col1 ref" href="#161s" title='s' data-ref="161s">s</a>, <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1ERKSs" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1ERKSs"></a><a class="local col2 ref" href="#162use" title='use' data-ref="162use">use</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla6HloUse8ToStringEv" title='xla::HloUse::ToString' data-ref="_ZNK3xla6HloUse8ToStringEv">ToString</a>());</td></tr>
<tr><th id="904">904</th><td>                         }),</td></tr>
<tr><th id="905">905</th><td>                    <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1EPKc" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1EPKc"></a><q>"\n"</q>);</td></tr>
<tr><th id="906">906</th><td></td></tr>
<tr><th id="907">907</th><td>          <a class="local col0 ref" href="#160p" title='p' data-ref="160p">p</a> = <a class="local col0 ref" href="#160p" title='p' data-ref="160p">p</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::next' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::next">next</a>;</td></tr>
<tr><th id="908">908</th><td>        } <b>while</b> (<a class="local col0 ref" href="#160p" title='p' data-ref="160p">p</a> != <a class="local col9 ref" href="#159head" title='head' data-ref="159head">head</a>);</td></tr>
<tr><th id="909">909</th><td>      }</td></tr>
<tr><th id="910">910</th><td>      <a class="ref" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings9StrAppendEPSsRKNS0_8AlphaNumE" title='tensorflow::strings::StrAppend' data-ref="_ZN10tensorflow7strings9StrAppendEPSsRKNS0_8AlphaNumE">StrAppend</a>(&amp;<a class="local col8 ref" href="#158out" title='out' data-ref="158out">out</a>, <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1EPKc" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1EPKc"></a><q>"  Potentially removable copies:\n"</q>);</td></tr>
<tr><th id="911">911</th><td>      <b>for</b> (<em>const</em> <em>auto</em>&amp; <dfn class="local col3 decl" id="163pair" title='pair' data-type='const tensorflow::gtl::FlatMap&lt;const xla::HloInstruction *, xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CopyNodes, tensorflow::hash&lt;const xla::HloInstruction *&gt;, std::equal_to&lt;const xla::HloInstruction *&gt; &gt;::ValueType &amp;' data-ref="163pair">pair</dfn> : <a class="tu member" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::copy_map_' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_">copy_map_</a>) {</td></tr>
<tr><th id="912">912</th><td>        <em>const</em> <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col4 decl" id="164copy" title='copy' data-type='const xla::HloInstruction *' data-ref="164copy">copy</dfn> = <a class="local col3 ref" href="#163pair" title='pair' data-ref="163pair">pair</a>.<a class="tu ref" href="../../../core/lib/gtl/flatmap.h.html#tensorflow::gtl::FlatMap::ValueType::first" title='tensorflow::gtl::FlatMap&lt;const xla::HloInstruction *, xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CopyNodes, tensorflow::hash&lt;const xla::HloInstruction *&gt;, std::equal_to&lt;const xla::HloInstruction *&gt; &gt;::ValueType::first' data-use='r' data-ref="tensorflow::gtl::FlatMap::ValueType::first">first</a>;</td></tr>
<tr><th id="913">913</th><td>        <em>const</em> <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CopyNodes' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes">CopyNodes</a>&amp; <dfn class="local col5 decl" id="165copy_info" title='copy_info' data-type='const xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CopyNodes &amp;' data-ref="165copy_info">copy_info</dfn> = <a class="local col3 ref" href="#163pair" title='pair' data-ref="163pair">pair</a>.<a class="tu ref" href="../../../core/lib/gtl/flatmap.h.html#tensorflow::gtl::FlatMap::ValueType::second" title='tensorflow::gtl::FlatMap&lt;const xla::HloInstruction *, xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CopyNodes, tensorflow::hash&lt;const xla::HloInstruction *&gt;, std::equal_to&lt;const xla::HloInstruction *&gt; &gt;::ValueType::second' data-use='r' data-ref="tensorflow::gtl::FlatMap::ValueType::second">second</a>;</td></tr>
<tr><th id="914">914</th><td></td></tr>
<tr><th id="915">915</th><td>        <a class="ref" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings9StrAppendEPSsRKNS0_8AlphaNumES4_S4_S4_S4_DpRKT_" title='tensorflow::strings::StrAppend' data-ref="_ZN10tensorflow7strings9StrAppendEPSsRKNS0_8AlphaNumES4_S4_S4_S4_DpRKT_">StrAppend</a>(&amp;<a class="local col8 ref" href="#158out" title='out' data-ref="158out">out</a>, <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1EPKc" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1EPKc"></a><q>"    "</q>, <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1ERKSs" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1ERKSs"></a><a class="local col4 ref" href="#164copy" title='copy' data-ref="164copy">copy</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction4nameEv" title='xla::HloInstruction::name' data-ref="_ZNK3xla14HloInstruction4nameEv">name</a>(), <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1EPKc" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1EPKc"></a><q>" : "</q>,</td></tr>
<tr><th id="916">916</th><td>                  <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1ERKSs" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1ERKSs"></a><a class="local col5 ref" href="#165copy_info" title='copy_info' data-ref="165copy_info">copy_info</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes::src" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CopyNodes::src' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes::src">src</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue13ToShortStringEv" title='xla::HloValue::ToShortString' data-ref="_ZNK3xla8HloValue13ToShortStringEv">ToShortString</a>(), <a class="ref fake" href="../../../core/lib/strings/strcat.h.html#_ZN10tensorflow7strings8AlphaNumC1EPKc" title='tensorflow::strings::AlphaNum::AlphaNum' data-ref="_ZN10tensorflow7strings8AlphaNumC1EPKc"></a><q>" =&gt; "</q>,</td></tr>
<tr><th id="917">917</th><td>                  <a class="local col5 ref" href="#165copy_info" title='copy_info' data-ref="165copy_info">copy_info</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes::dest" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CopyNodes::dest' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes::dest">dest</a>-&gt;<a class="tu ref" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode::value' data-use='r' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode::value">value</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue13ToShortStringEv" title='xla::HloValue::ToShortString' data-ref="_ZNK3xla8HloValue13ToShortStringEv">ToShortString</a>(), <q>"\n"</q>);</td></tr>
<tr><th id="918">918</th><td>      }</td></tr>
<tr><th id="919">919</th><td>      <b>return</b> <a class="local col8 ref" href="#158out" title='out' data-ref="158out">out</a>;</td></tr>
<tr><th id="920">920</th><td>    }</td></tr>
<tr><th id="921">921</th><td></td></tr>
<tr><th id="922">922</th><td>   <b>private</b>:</td></tr>
<tr><th id="923">923</th><td>    <em>const</em> <a class="type" href="hlo_dataflow_analysis.h.html#xla::HloDataflowAnalysis" title='xla::HloDataflowAnalysis' data-ref="xla::HloDataflowAnalysis">HloDataflowAnalysis</a>&amp; <dfn class="tu decl" id="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::dataflow_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::dataflow_' data-type='const xla::HloDataflowAnalysis &amp;' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::dataflow_">dataflow_</dfn>;</td></tr>
<tr><th id="924">924</th><td>    <em>const</em> <a class="type" href="hlo_ordering.h.html#xla::HloOrdering" title='xla::HloOrdering' data-ref="xla::HloOrdering">HloOrdering</a>&amp; <dfn class="tu decl" id="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ordering_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ordering_' data-type='const xla::HloOrdering &amp;' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ordering_">ordering_</dfn>;</td></tr>
<tr><th id="925">925</th><td></td></tr>
<tr><th id="926">926</th><td>    <i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::value_lists_">// The heads of all the value lists. Each value list represents the HLO</i></td></tr>
<tr><th id="927">927</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::value_lists_">    // values contained in a particular HLO buffer. The values in the list are</i></td></tr>
<tr><th id="928">928</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::value_lists_">    // in dependency order.</i></td></tr>
<tr><th id="929">929</th><td>    <span class="namespace">tensorflow::gtl::</span><a class="type" href="../../../core/lib/gtl/flatset.h.html#tensorflow::gtl::FlatSet" title='tensorflow::gtl::FlatSet' data-ref="tensorflow::gtl::FlatSet">FlatSet</a>&lt;<em>const</em> <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>*&gt; <dfn class="tu decl" id="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::value_lists_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::value_lists_' data-type='tensorflow::gtl::FlatSet&lt;const ValueNode *&gt;' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::value_lists_">value_lists_</dfn>;</td></tr>
<tr><th id="930">930</th><td></td></tr>
<tr><th id="931">931</th><td>    <i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes">// Copy removal requires fast access to the value list elements</i></td></tr>
<tr><th id="932">932</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes">    // corresponding to the source and destination values of the kCopy</i></td></tr>
<tr><th id="933">933</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes">    // instruction. This data structure holds pointers to these elements for</i></td></tr>
<tr><th id="934">934</th><td><i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes">    // each kCopy instruction in the graph.</i></td></tr>
<tr><th id="935">935</th><td>    <b>struct</b> <dfn class="tu type def" id="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CopyNodes' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes">CopyNodes</dfn> {</td></tr>
<tr><th id="936">936</th><td>      <i  data-doc="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes::src">// The source and destinations values of the kCopy instruction.</i></td></tr>
<tr><th id="937">937</th><td>      <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="tu decl" id="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes::src" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CopyNodes::src' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes::src">src</dfn> = <b>nullptr</b>;</td></tr>
<tr><th id="938">938</th><td>      <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::ValueNode">ValueNode</a>* <dfn class="tu decl" id="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes::dest" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CopyNodes::dest' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::ValueNode *' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes::dest">dest</dfn> = <b>nullptr</b>;</td></tr>
<tr><th id="939">939</th><td>    };</td></tr>
<tr><th id="940">940</th><td>    <span class="namespace">tensorflow::gtl::</span><a class="type" href="../../../core/lib/gtl/flatmap.h.html#tensorflow::gtl::FlatMap" title='tensorflow::gtl::FlatMap' data-ref="tensorflow::gtl::FlatMap">FlatMap</a>&lt;<em>const</em> <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>*, <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::CopyNodes' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::CopyNodes">CopyNodes</a>&gt; <dfn class="tu decl" id="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker::copy_map_' data-type='tensorflow::gtl::FlatMap&lt;const HloInstruction *, CopyNodes&gt;' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker::copy_map_">copy_map_</dfn>;</td></tr>
<tr><th id="941">941</th><td>  };</td></tr>
<tr><th id="942">942</th><td></td></tr>
<tr><th id="943">943</th><td>  <a class="type" href="hlo_module.h.html#xla::HloModule" title='xla::HloModule' data-ref="xla::HloModule">HloModule</a>* <dfn class="tu decl" id="xla::(anonymousnamespace)::CopyRemover::module_" title='xla::(anonymous namespace)::CopyRemover::module_' data-type='xla::HloModule *' data-ref="xla::(anonymousnamespace)::CopyRemover::module_">module_</dfn>;</td></tr>
<tr><th id="944">944</th><td>  <em>const</em> <a class="type" href="hlo_alias_analysis.h.html#xla::HloAliasAnalysis" title='xla::HloAliasAnalysis' data-ref="xla::HloAliasAnalysis">HloAliasAnalysis</a>&amp; <dfn class="tu decl" id="xla::(anonymousnamespace)::CopyRemover::alias_analysis_" title='xla::(anonymous namespace)::CopyRemover::alias_analysis_' data-type='const xla::HloAliasAnalysis &amp;' data-ref="xla::(anonymousnamespace)::CopyRemover::alias_analysis_">alias_analysis_</dfn>;</td></tr>
<tr><th id="945">945</th><td>  <em>const</em> <a class="type" href="hlo_ordering.h.html#xla::HloOrdering" title='xla::HloOrdering' data-ref="xla::HloOrdering">HloOrdering</a>&amp; <dfn class="tu decl" id="xla::(anonymousnamespace)::CopyRemover::ordering_" title='xla::(anonymous namespace)::CopyRemover::ordering_' data-type='const xla::HloOrdering &amp;' data-ref="xla::(anonymousnamespace)::CopyRemover::ordering_">ordering_</dfn>;</td></tr>
<tr><th id="946">946</th><td></td></tr>
<tr><th id="947">947</th><td>  <i  data-doc="xla::(anonymousnamespace)::CopyRemover::buffer_value_tracker_">// Object tracking the HLO values contained in each HLO buffer.</i></td></tr>
<tr><th id="948">948</th><td>  <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover::BufferValueTracker" title='xla::(anonymous namespace)::CopyRemover::BufferValueTracker' data-ref="xla::(anonymousnamespace)::CopyRemover::BufferValueTracker">BufferValueTracker</a> <dfn class="tu decl" id="xla::(anonymousnamespace)::CopyRemover::buffer_value_tracker_" title='xla::(anonymous namespace)::CopyRemover::buffer_value_tracker_' data-type='xla::(anonymous namespace)::CopyRemover::BufferValueTracker' data-ref="xla::(anonymousnamespace)::CopyRemover::buffer_value_tracker_">buffer_value_tracker_</dfn>;</td></tr>
<tr><th id="949">949</th><td>};</td></tr>
<tr><th id="950">950</th><td></td></tr>
<tr><th id="951">951</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_123RemoveUnnecessaryCopiesERKNS_11HloOrderingERKN10tensorflow3gtl7FlatSetIiNS4_4hashIiEESt8equal_toIiEEEPNS_9HloModuleE">// Try to remove as many copies from the module as possible without introducing</i></td></tr>
<tr><th id="952">952</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_123RemoveUnnecessaryCopiesERKNS_11HloOrderingERKN10tensorflow3gtl7FlatSetIiNS4_4hashIiEESt8equal_toIiEEEPNS_9HloModuleE">// live range interference. Copy instructions (identified by their unique id) in</i></td></tr>
<tr><th id="953">953</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_123RemoveUnnecessaryCopiesERKNS_11HloOrderingERKN10tensorflow3gtl7FlatSetIiNS4_4hashIiEESt8equal_toIiEEEPNS_9HloModuleE">// the set copies_to_exclude are not considered for removal.</i></td></tr>
<tr><th id="954">954</th><td><a class="type" href="../../../core/lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a> <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_123RemoveUnnecessaryCopiesERKNS_11HloOrderingERKN10tensorflow3gtl7FlatSetIiNS4_4hashIiEESt8equal_toIiEEEPNS_9HloModuleE" title='xla::(anonymous namespace)::RemoveUnnecessaryCopies' data-type='tensorflow::Status xla::(anonymous namespace)::RemoveUnnecessaryCopies(const xla::HloOrdering &amp; ordering, const tensorflow::gtl::FlatSet&lt;int&gt; &amp; copies_to_exclude, xla::HloModule * module)' data-ref="_ZN3xla12_GLOBAL__N_123RemoveUnnecessaryCopiesERKNS_11HloOrderingERKN10tensorflow3gtl7FlatSetIiNS4_4hashIiEESt8equal_toIiEEEPNS_9HloModuleE">RemoveUnnecessaryCopies</dfn>(</td></tr>
<tr><th id="955">955</th><td>    <em>const</em> <a class="type" href="hlo_ordering.h.html#xla::HloOrdering" title='xla::HloOrdering' data-ref="xla::HloOrdering">HloOrdering</a>&amp; <dfn class="local col6 decl" id="166ordering" title='ordering' data-type='const xla::HloOrdering &amp;' data-ref="166ordering">ordering</dfn>,</td></tr>
<tr><th id="956">956</th><td>    <em>const</em> <span class="namespace">tensorflow::gtl::</span><a class="type" href="../../../core/lib/gtl/flatset.h.html#tensorflow::gtl::FlatSet" title='tensorflow::gtl::FlatSet' data-ref="tensorflow::gtl::FlatSet">FlatSet</a>&lt;<em>int</em>&gt;&amp; <dfn class="local col7 decl" id="167copies_to_exclude" title='copies_to_exclude' data-type='const tensorflow::gtl::FlatSet&lt;int&gt; &amp;' data-ref="167copies_to_exclude">copies_to_exclude</dfn>, <a class="type" href="hlo_module.h.html#xla::HloModule" title='xla::HloModule' data-ref="xla::HloModule">HloModule</a>* <dfn class="local col8 decl" id="168module" title='module' data-type='xla::HloModule *' data-ref="168module">module</dfn>) {</td></tr>
<tr><th id="957">957</th><td>  <a class="macro" href="../status_macros.h.html#199" title="auto _status_or_value13 = (HloAliasAnalysis::Run(module)); if ((__builtin_expect(!_status_or_value13.ok(), 0))) { return _status_or_value13.status(); } std::unique_ptr&lt;HloAliasAnalysis&gt; alias_analysis = std::move(_status_or_value13.ValueOrDie())" data-ref="_M/TF_ASSIGN_OR_RETURN">TF_ASSIGN_OR_RETURN</a>(std::<a class="type" href="../../../../../include/c++/5/bits/unique_ptr.h.html#std::unique_ptr" title='std::unique_ptr' data-ref="std::unique_ptr">unique_ptr</a>&lt;<a class="type" href="hlo_alias_analysis.h.html#xla::HloAliasAnalysis" title='xla::HloAliasAnalysis' data-ref="xla::HloAliasAnalysis">HloAliasAnalysis</a>&gt; <dfn class="local col9 decl" id="169alias_analysis" title='alias_analysis' data-type='std::unique_ptr&lt;HloAliasAnalysis&gt;' data-ref="169alias_analysis">alias_analysis</dfn>,</td></tr>
<tr><th id="958">958</th><td>                      <a class="type" href="hlo_alias_analysis.h.html#xla::HloAliasAnalysis" title='xla::HloAliasAnalysis' data-ref="xla::HloAliasAnalysis">HloAliasAnalysis</a>::<a class="ref" href="hlo_alias_analysis.h.html#_ZN3xla16HloAliasAnalysis3RunEPNS_9HloModuleE" title='xla::HloAliasAnalysis::Run' data-ref="_ZN3xla16HloAliasAnalysis3RunEPNS_9HloModuleE">Run</a>(<a class="local col8 ref" href="#168module" title='module' data-ref="168module">module</a>));</td></tr>
<tr><th id="959">959</th><td>  <a class="tu type" href="#xla::(anonymousnamespace)::CopyRemover" title='xla::(anonymous namespace)::CopyRemover' data-ref="xla::(anonymousnamespace)::CopyRemover">CopyRemover</a> <dfn class="local col0 decl" id="170copy_remover" title='copy_remover' data-type='xla::(anonymous namespace)::CopyRemover' data-ref="170copy_remover">copy_remover</dfn><a class="tu ref" href="#_ZN3xla12_GLOBAL__N_111CopyRemoverC1ERKNS_16HloAliasAnalysisERKNS_11HloOrderingEPNS_9HloModuleE" title='xla::(anonymous namespace)::CopyRemover::CopyRemover' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemoverC1ERKNS_16HloAliasAnalysisERKNS_11HloOrderingEPNS_9HloModuleE">(</a><a class="ref" href="../../../../../include/c++/5/bits/unique_ptr.h.html#_ZNKSt10unique_ptrdeEv" title='std::unique_ptr::operator*' data-ref="_ZNKSt10unique_ptrdeEv">*</a><a class="local col9 ref" href="#957" title='alias_analysis' data-ref="169alias_analysis">alias_analysis</a>, <a class="local col6 ref" href="#166ordering" title='ordering' data-ref="166ordering">ordering</a>, <a class="local col8 ref" href="#168module" title='module' data-ref="168module">module</a>);</td></tr>
<tr><th id="960">960</th><td>  <a class="macro" href="../util.h.html#536" title="do { if (((3) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel())) ::xla::LogLines(::tensorflow::INFO, copy_remover.ToString(), &quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 960); } while (false);" data-ref="_M/XLA_VLOG_LINES">XLA_VLOG_LINES</a>(<var>3</var>, <a class="ref fake" href="../../../core/lib/core/stringpiece.h.html#_ZN10tensorflow11StringPieceC1ERKSs" title='tensorflow::StringPiece::StringPiece' data-ref="_ZN10tensorflow11StringPieceC1ERKSs"></a><a class="local col0 ref" href="#170copy_remover" title='copy_remover' data-ref="170copy_remover">copy_remover</a>.<a class="tu ref" href="#_ZNK3xla12_GLOBAL__N_111CopyRemover8ToStringEv" title='xla::(anonymous namespace)::CopyRemover::ToString' data-use='c' data-ref="_ZNK3xla12_GLOBAL__N_111CopyRemover8ToStringEv">ToString</a>());</td></tr>
<tr><th id="961">961</th><td></td></tr>
<tr><th id="962">962</th><td>  <b>for</b> (<a class="type" href="hlo_computation.h.html#xla::HloComputation" title='xla::HloComputation' data-ref="xla::HloComputation">HloComputation</a>* <dfn class="local col1 decl" id="171computation" title='computation' data-type='xla::HloComputation *' data-ref="171computation">computation</dfn> : <a class="local col8 ref" href="#168module" title='module' data-ref="168module">module</a>-&gt;<a class="ref" href="hlo_module.h.html#_ZN3xla9HloModule12computationsEv" title='xla::HloModule::computations' data-ref="_ZN3xla9HloModule12computationsEv">computations</a>()) {</td></tr>
<tr><th id="963">963</th><td>    <b>for</b> (<a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col2 decl" id="172instruction" title='instruction' data-type='xla::HloInstruction *' data-ref="172instruction">instruction</dfn> : <a class="local col1 ref" href="#171computation" title='computation' data-ref="171computation">computation</a>-&gt;<a class="ref" href="hlo_computation.h.html#_ZN3xla14HloComputation12instructionsEv" title='xla::HloComputation::instructions' data-ref="_ZN3xla14HloComputation12instructionsEv">instructions</a>()) {</td></tr>
<tr><th id="964">964</th><td>      <b>if</b> (<a class="local col2 ref" href="#172instruction" title='instruction' data-ref="172instruction">instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction6opcodeEv" title='xla::HloInstruction::opcode' data-ref="_ZNK3xla14HloInstruction6opcodeEv">opcode</a>() == <a class="type" href="hlo_opcode.h.html#xla::HloOpcode" title='xla::HloOpcode' data-ref="xla::HloOpcode">HloOpcode</a>::<a class="enum" href="hlo_opcode.h.html#135" title='xla::HloOpcode::kCopy' data-ref="xla::HloOpcode::kCopy">kCopy</a> &amp;&amp;</td></tr>
<tr><th id="965">965</th><td>          !<a class="ref" href="../map_util.h.html#_ZN3xla11ContainsKeyERKT_RKT0_" title='xla::ContainsKey' data-ref="_ZN3xla11ContainsKeyERKT_RKT0_">ContainsKey</a>(<a class="local col7 ref" href="#167copies_to_exclude" title='copies_to_exclude' data-ref="167copies_to_exclude">copies_to_exclude</a>, <a class="local col2 ref" href="#172instruction" title='instruction' data-ref="172instruction">instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction9unique_idEv" title='xla::HloInstruction::unique_id' data-ref="_ZNK3xla14HloInstruction9unique_idEv">unique_id</a>())) {</td></tr>
<tr><th id="966">966</th><td>        <a class="macro" href="../../../core/lib/core/errors.h.html#69" title="do { const ::tensorflow::Status _status = (copy_remover.TryElideCopy(instruction).status()); if ((__builtin_expect(!_status.ok(), 0))) return _status; } while (0)" data-ref="_M/TF_RETURN_IF_ERROR">TF_RETURN_IF_ERROR</a>(<a class="local col0 ref" href="#170copy_remover" title='copy_remover' data-ref="170copy_remover">copy_remover</a>.<a class="tu ref" href="#_ZN3xla12_GLOBAL__N_111CopyRemover12TryElideCopyEPNS_14HloInstructionE" title='xla::(anonymous namespace)::CopyRemover::TryElideCopy' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_111CopyRemover12TryElideCopyEPNS_14HloInstructionE">TryElideCopy</a>(<a class="local col2 ref" href="#172instruction" title='instruction' data-ref="172instruction">instruction</a>).<a class="ref" href="../statusor.h.html#_ZNO3xla8StatusOr6statusEv" title='xla::StatusOr::status' data-ref="_ZNO3xla8StatusOr6statusEv">status</a>());</td></tr>
<tr><th id="967">967</th><td>      }</td></tr>
<tr><th id="968">968</th><td>    }</td></tr>
<tr><th id="969">969</th><td>  }</td></tr>
<tr><th id="970">970</th><td>  <b>return</b> <a class="type" href="../../../core/lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a>::<a class="ref" href="../../../core/lib/core/status.h.html#_ZN10tensorflow6Status2OKEv" title='tensorflow::Status::OK' data-ref="_ZN10tensorflow6Status2OKEv">OK</a>();</td></tr>
<tr><th id="971">971</th><td>}</td></tr>
<tr><th id="972">972</th><td></td></tr>
<tr><th id="973">973</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_120AddSpecialCaseCopiesERKNS_9CallGraphEPNS_9HloModuleE">// Add copies to address special constraints on the roots of computations not</i></td></tr>
<tr><th id="974">974</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_120AddSpecialCaseCopiesERKNS_9CallGraphEPNS_9HloModuleE">// related to live range interference:</i></td></tr>
<tr><th id="975">975</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_120AddSpecialCaseCopiesERKNS_9CallGraphEPNS_9HloModuleE">//</i></td></tr>
<tr><th id="976">976</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_120AddSpecialCaseCopiesERKNS_9CallGraphEPNS_9HloModuleE">//    (1) Entry computation root must be unambiguous and distinct.</i></td></tr>
<tr><th id="977">977</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_120AddSpecialCaseCopiesERKNS_9CallGraphEPNS_9HloModuleE">//</i></td></tr>
<tr><th id="978">978</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_120AddSpecialCaseCopiesERKNS_9CallGraphEPNS_9HloModuleE">//    (2) Any computation called by a kCall instruction must have an</i></td></tr>
<tr><th id="979">979</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_120AddSpecialCaseCopiesERKNS_9CallGraphEPNS_9HloModuleE">//        unambiguous root.</i></td></tr>
<tr><th id="980">980</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_120AddSpecialCaseCopiesERKNS_9CallGraphEPNS_9HloModuleE">//</i></td></tr>
<tr><th id="981">981</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_120AddSpecialCaseCopiesERKNS_9CallGraphEPNS_9HloModuleE">//    (3) Constants and parameters cannot be live out of the entry computation</i></td></tr>
<tr><th id="982">982</th><td><i  data-doc="_ZN3xla12_GLOBAL__N_120AddSpecialCaseCopiesERKNS_9CallGraphEPNS_9HloModuleE">//</i></td></tr>
<tr><th id="983">983</th><td><a class="type" href="../../../core/lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a> <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_120AddSpecialCaseCopiesERKNS_9CallGraphEPNS_9HloModuleE" title='xla::(anonymous namespace)::AddSpecialCaseCopies' data-type='tensorflow::Status xla::(anonymous namespace)::AddSpecialCaseCopies(const xla::CallGraph &amp; call_graph, xla::HloModule * module)' data-ref="_ZN3xla12_GLOBAL__N_120AddSpecialCaseCopiesERKNS_9CallGraphEPNS_9HloModuleE">AddSpecialCaseCopies</dfn>(<em>const</em> <a class="type" href="call_graph.h.html#xla::CallGraph" title='xla::CallGraph' data-ref="xla::CallGraph">CallGraph</a>&amp; <dfn class="local col3 decl" id="173call_graph" title='call_graph' data-type='const xla::CallGraph &amp;' data-ref="173call_graph">call_graph</dfn>, <a class="type" href="hlo_module.h.html#xla::HloModule" title='xla::HloModule' data-ref="xla::HloModule">HloModule</a>* <dfn class="local col4 decl" id="174module" title='module' data-type='xla::HloModule *' data-ref="174module">module</dfn>) {</td></tr>
<tr><th id="984">984</th><td>  <a class="macro" href="../status_macros.h.html#199" title="auto _status_or_value15 = (HloAliasAnalysis::Run(module)); if ((__builtin_expect(!_status_or_value15.ok(), 0))) { return _status_or_value15.status(); } std::unique_ptr&lt;HloAliasAnalysis&gt; alias_analysis = std::move(_status_or_value15.ValueOrDie())" data-ref="_M/TF_ASSIGN_OR_RETURN">TF_ASSIGN_OR_RETURN</a>(std::<a class="type" href="../../../../../include/c++/5/bits/unique_ptr.h.html#std::unique_ptr" title='std::unique_ptr' data-ref="std::unique_ptr">unique_ptr</a>&lt;<a class="type" href="hlo_alias_analysis.h.html#xla::HloAliasAnalysis" title='xla::HloAliasAnalysis' data-ref="xla::HloAliasAnalysis">HloAliasAnalysis</a>&gt; <dfn class="local col5 decl" id="175alias_analysis" title='alias_analysis' data-type='std::unique_ptr&lt;HloAliasAnalysis&gt;' data-ref="175alias_analysis">alias_analysis</dfn>,</td></tr>
<tr><th id="985">985</th><td>                      <a class="type" href="hlo_alias_analysis.h.html#xla::HloAliasAnalysis" title='xla::HloAliasAnalysis' data-ref="xla::HloAliasAnalysis">HloAliasAnalysis</a>::<a class="ref" href="hlo_alias_analysis.h.html#_ZN3xla16HloAliasAnalysis3RunEPNS_9HloModuleE" title='xla::HloAliasAnalysis::Run' data-ref="_ZN3xla16HloAliasAnalysis3RunEPNS_9HloModuleE">Run</a>(<a class="local col4 ref" href="#174module" title='module' data-ref="174module">module</a>));</td></tr>
<tr><th id="986">986</th><td></td></tr>
<tr><th id="987">987</th><td>  <i>// Identify which shape indices of which instructions need to be copied. Store</i></td></tr>
<tr><th id="988">988</th><td><i>  // these results in 'instructions_to_copy'.</i></td></tr>
<tr><th id="989">989</th><td>  <a class="type" href="hlo_instruction.h.html#xla::HloInstructionMap" title='xla::HloInstructionMap' data-ref="xla::HloInstructionMap">HloInstructionMap</a>&lt;<a class="type" href="../shape_tree.h.html#xla::ShapeTree" title='xla::ShapeTree' data-ref="xla::ShapeTree">ShapeTree</a>&lt;<em>bool</em>&gt;&gt; <a class="ref fake" href="../../../../../include/c++/5/bits/stl_map.h.html#_ZNSt3mapC1Ev" title='std::map::map&lt;_Key, _Tp, _Compare, _Alloc&gt;' data-ref="_ZNSt3mapC1Ev"></a><dfn class="local col6 decl" id="176instructions_to_copy" title='instructions_to_copy' data-type='HloInstructionMap&lt;ShapeTree&lt;bool&gt; &gt;' data-ref="176instructions_to_copy">instructions_to_copy</dfn>;</td></tr>
<tr><th id="990">990</th><td>  <em>auto</em> <dfn class="local col7 decl" id="177add_index_to_copy" title='add_index_to_copy' data-type='(lambda at /root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc:990:28)' data-ref="177add_index_to_copy">add_index_to_copy</dfn> = [&amp;instructions_to_copy](<a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col8 decl" id="178instruction" title='instruction' data-type='xla::HloInstruction *' data-ref="178instruction">instruction</dfn>,</td></tr>
<tr><th id="991">991</th><td>                                                   <em>const</em> <a class="type" href="../shape_util.h.html#xla::ShapeIndex" title='xla::ShapeIndex' data-ref="xla::ShapeIndex">ShapeIndex</a>&amp; <dfn class="local col9 decl" id="179index" title='index' data-type='const xla::ShapeIndex &amp;' data-ref="179index">index</dfn>) {</td></tr>
<tr><th id="992">992</th><td>    <em>auto</em> <dfn class="local col0 decl" id="180it" title='it' data-type='std::_Rb_tree_iterator&lt;std::pair&lt;xla::HloInstruction *const, xla::ShapeTree&lt;bool&gt; &gt; &gt;' data-ref="180it">it</dfn> = <a class="local col6 ref" href="#176instructions_to_copy" title='instructions_to_copy' data-ref="176instructions_to_copy">instructions_to_copy</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_map.h.html#_ZNSt3map4findERKT_" title='std::map::find' data-ref="_ZNSt3map4findERKT_">find</a>(<a class="local col8 ref" href="#178instruction" title='instruction' data-ref="178instruction">instruction</a>);</td></tr>
<tr><th id="993">993</th><td>    <b>if</b> (<a class="local col0 ref" href="#180it" title='it' data-ref="180it">it</a> <a class="ref" href="../../../../../include/c++/5/bits/stl_tree.h.html#_ZNKSt17_Rb_tree_iteratoreqERKSt17_Rb_tree_iteratorIT_E" title='std::_Rb_tree_iterator::operator==' data-ref="_ZNKSt17_Rb_tree_iteratoreqERKSt17_Rb_tree_iteratorIT_E">==</a> <a class="local col6 ref" href="#176instructions_to_copy" title='instructions_to_copy' data-ref="176instructions_to_copy">instructions_to_copy</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_map.h.html#_ZNSt3map3endEv" title='std::map::end' data-ref="_ZNSt3map3endEv">end</a>()) {</td></tr>
<tr><th id="994">994</th><td>      <em>auto</em> <dfn class="local col1 decl" id="181it_added" title='it_added' data-type='std::pair&lt;std::_Rb_tree_iterator&lt;std::pair&lt;xla::HloInstruction *const, xla::ShapeTree&lt;bool&gt; &gt; &gt;, bool&gt;' data-ref="181it_added">it_added</dfn> = <a class="local col6 ref" href="#176instructions_to_copy" title='instructions_to_copy' data-ref="176instructions_to_copy">instructions_to_copy</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_map.h.html#_ZNSt3map7emplaceEDpOT_" title='std::map::emplace' data-ref="_ZNSt3map7emplaceEDpOT_">emplace</a>(</td></tr>
<tr><th id="995">995</th><td>          <span class="namespace">std::</span><a class="ref" href="../../../../../include/c++/5/bits/stl_pair.h.html#std::piecewise_construct" title='std::piecewise_construct' data-ref="std::piecewise_construct">piecewise_construct</a>, <span class="namespace">std::</span><a class="ref" href="../../../../../include/c++/5/tuple.html#_ZSt16forward_as_tupleDpOT_" title='std::forward_as_tuple' data-ref="_ZSt16forward_as_tupleDpOT_">forward_as_tuple</a>(<span class='refarg'><a class="local col8 ref" href="#178instruction" title='instruction' data-ref="178instruction">instruction</a></span>),</td></tr>
<tr><th id="996">996</th><td>          <span class="namespace">std::</span><a class="ref" href="../../../../../include/c++/5/tuple.html#_ZSt16forward_as_tupleDpOT_" title='std::forward_as_tuple' data-ref="_ZSt16forward_as_tupleDpOT_">forward_as_tuple</a>(<a class="local col8 ref" href="#178instruction" title='instruction' data-ref="178instruction">instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction5shapeEv" title='xla::HloInstruction::shape' data-ref="_ZNK3xla14HloInstruction5shapeEv">shape</a>(), <i>/*init_value=*/</i><b>false</b>));</td></tr>
<tr><th id="997">997</th><td>      <a class="local col0 ref" href="#180it" title='it' data-ref="180it">it</a> <a class="ref" href="../../../../../include/c++/5/bits/stl_tree.h.html#174" title='std::_Rb_tree_iterator&lt;std::pair&lt;xla::HloInstruction *const, xla::ShapeTree&lt;bool&gt; &gt; &gt;::operator=' data-ref="_ZNSt17_Rb_tree_iteratorISt4pairIKPN3xla14HloInstructionENS1_9ShapeTreeIbEEEEaSERKS8_">=</a> <a class="local col1 ref" href="#181it_added" title='it_added' data-ref="181it_added">it_added</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_pair.h.html#std::pair::first" title='std::pair&lt;std::_Rb_tree_iterator&lt;std::pair&lt;xla::HloInstruction *const, xla::ShapeTree&lt;bool&gt; &gt; &gt;, bool&gt;::first' data-ref="std::pair::first">first</a>;</td></tr>
<tr><th id="998">998</th><td>    }</td></tr>
<tr><th id="999">999</th><td>    *<a class="local col0 ref" href="#180it" title='it' data-ref="180it">it</a><a class="ref" href="../../../../../include/c++/5/bits/stl_tree.h.html#_ZNKSt17_Rb_tree_iteratorptEv" title='std::_Rb_tree_iterator::operator-&gt;' data-ref="_ZNKSt17_Rb_tree_iteratorptEv">-&gt;</a><a class="ref" href="../../../../../include/c++/5/bits/stl_pair.h.html#std::pair::second" title='std::pair&lt;xla::HloInstruction *const, xla::ShapeTree&lt;bool&gt; &gt;::second' data-ref="std::pair::second">second</a>.<a class="ref" href="../shape_tree.h.html#_ZN3xla9ShapeTree15mutable_elementERKNS_10ShapeIndexE" title='xla::ShapeTree::mutable_element' data-ref="_ZN3xla9ShapeTree15mutable_elementERKNS_10ShapeIndexE">mutable_element</a>(<a class="local col9 ref" href="#179index" title='index' data-ref="179index">index</a>) = <b>true</b>;</td></tr>
<tr><th id="1000">1000</th><td>  };</td></tr>
<tr><th id="1001">1001</th><td></td></tr>
<tr><th id="1002">1002</th><td>  <i>// Iterate through values of all constants and entry parameters. These values</i></td></tr>
<tr><th id="1003">1003</th><td><i>  // are special because they are held in read-only buffers. If any of these</i></td></tr>
<tr><th id="1004">1004</th><td><i>  // values share a buffer with other values (for example, the init value of a</i></td></tr>
<tr><th id="1005">1005</th><td><i>  // while is a constant) then copy the value at its definition and replace all</i></td></tr>
<tr><th id="1006">1006</th><td><i>  // its uses with the copy.</i></td></tr>
<tr><th id="1007">1007</th><td>  <b>for</b> (<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValue" title='xla::HloValue' data-ref="xla::HloValue">HloValue</a>* <dfn class="local col2 decl" id="182value" title='value' data-type='const xla::HloValue *' data-ref="182value">value</dfn> : <a class="local col5 ref" href="#984" title='alias_analysis' data-ref="175alias_analysis">alias_analysis</a><a class="ref" href="../../../../../include/c++/5/bits/unique_ptr.h.html#_ZNKSt10unique_ptrptEv" title='std::unique_ptr::operator-&gt;' data-ref="_ZNKSt10unique_ptrptEv">-&gt;</a><a class="ref" href="hlo_alias_analysis.h.html#_ZNK3xla16HloAliasAnalysis17dataflow_analysisEv" title='xla::HloAliasAnalysis::dataflow_analysis' data-ref="_ZNK3xla16HloAliasAnalysis17dataflow_analysisEv">dataflow_analysis</a>().<a class="ref" href="hlo_dataflow_analysis.h.html#_ZNK3xla19HloDataflowAnalysis6valuesEv" title='xla::HloDataflowAnalysis::values' data-ref="_ZNK3xla19HloDataflowAnalysis6valuesEv">values</a>()) {</td></tr>
<tr><th id="1008">1008</th><td>    <b>if</b> (<a class="tu ref" href="#_ZN3xla12_GLOBAL__N_115ValueIsReadOnlyERKNS_8HloValueE" title='xla::(anonymous namespace)::ValueIsReadOnly' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_115ValueIsReadOnlyERKNS_8HloValueE">ValueIsReadOnly</a>(*<a class="local col2 ref" href="#182value" title='value' data-ref="182value">value</a>) &amp;&amp;</td></tr>
<tr><th id="1009">1009</th><td>        <a class="local col5 ref" href="#984" title='alias_analysis' data-ref="175alias_analysis">alias_analysis</a><a class="ref" href="../../../../../include/c++/5/bits/unique_ptr.h.html#_ZNKSt10unique_ptrptEv" title='std::unique_ptr::operator-&gt;' data-ref="_ZNKSt10unique_ptrptEv">-&gt;</a><a class="ref" href="hlo_alias_analysis.h.html#_ZN3xla16HloAliasAnalysis24GetBufferContainingValueERKNS_8HloValueE" title='xla::HloAliasAnalysis::GetBufferContainingValue' data-ref="_ZN3xla16HloAliasAnalysis24GetBufferContainingValueERKNS_8HloValueE">GetBufferContainingValue</a>(*<a class="local col2 ref" href="#182value" title='value' data-ref="182value">value</a>).<a class="ref" href="hlo_buffer.h.html#_ZNK3xla9HloBuffer6valuesEv" title='xla::HloBuffer::values' data-ref="_ZNK3xla9HloBuffer6valuesEv">values</a>().<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNKSt6vector4sizeEv" title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv">size</a>() &gt; <var>1</var>) {</td></tr>
<tr><th id="1010">1010</th><td>      <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((2) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 1010, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>2</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <q>"Value "</q> <a class="ref" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E">&lt;&lt;</a> <a class="local col2 ref" href="#182value" title='value' data-ref="182value">value</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue13ToShortStringEv" title='xla::HloValue::ToShortString' data-ref="_ZNK3xla8HloValue13ToShortStringEv">ToShortString</a>()</td></tr>
<tr><th id="1011">1011</th><td>              <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsRSt13basic_ostreamIcT_EPKc" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIcT_EPKc">&lt;&lt;</a> <q>" is read only, but its buffer contains more than one value. "</q></td></tr>
<tr><th id="1012">1012</th><td>                 <q>"Copying."</q>;</td></tr>
<tr><th id="1013">1013</th><td>      <a class="local col7 ref" href="#177add_index_to_copy" title='add_index_to_copy' data-ref="177add_index_to_copy">add_index_to_copy</a>(<a class="local col2 ref" href="#182value" title='value' data-ref="182value">value</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue20defining_instructionEv" title='xla::HloValue::defining_instruction' data-ref="_ZNK3xla8HloValue20defining_instructionEv">defining_instruction</a>(), <a class="local col2 ref" href="#182value" title='value' data-ref="182value">value</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue14defining_indexEv" title='xla::HloValue::defining_index' data-ref="_ZNK3xla8HloValue14defining_indexEv">defining_index</a>());</td></tr>
<tr><th id="1014">1014</th><td>    }</td></tr>
<tr><th id="1015">1015</th><td>  }</td></tr>
<tr><th id="1016">1016</th><td></td></tr>
<tr><th id="1017">1017</th><td>  <i>// Identify copies which must be added at root instructions</i></td></tr>
<tr><th id="1018">1018</th><td>  <b>for</b> (<a class="type" href="hlo_computation.h.html#xla::HloComputation" title='xla::HloComputation' data-ref="xla::HloComputation">HloComputation</a>* <dfn class="local col3 decl" id="183computation" title='computation' data-type='xla::HloComputation *' data-ref="183computation">computation</dfn> : <a class="local col4 ref" href="#174module" title='module' data-ref="174module">module</a>-&gt;<a class="ref" href="hlo_module.h.html#_ZN3xla9HloModule12computationsEv" title='xla::HloModule::computations' data-ref="_ZN3xla9HloModule12computationsEv">computations</a>()) {</td></tr>
<tr><th id="1019">1019</th><td>    <em>const</em> <a class="type" href="call_graph.h.html#xla::CallGraphNode" title='xla::CallGraphNode' data-ref="xla::CallGraphNode">CallGraphNode</a>&amp; <dfn class="local col4 decl" id="184node" title='node' data-type='const xla::CallGraphNode &amp;' data-ref="184node">node</dfn> = <a class="local col3 ref" href="#173call_graph" title='call_graph' data-ref="173call_graph">call_graph</a>.<a class="ref" href="call_graph.h.html#_ZNK3xla9CallGraph7GetNodeEPKNS_14HloComputationE" title='xla::CallGraph::GetNode' data-ref="_ZNK3xla9CallGraph7GetNodeEPKNS_14HloComputationE">GetNode</a>(<a class="local col3 ref" href="#183computation" title='computation' data-ref="183computation">computation</a>);</td></tr>
<tr><th id="1020">1020</th><td>    <b>if</b> (<a class="local col4 ref" href="#184node" title='node' data-ref="184node">node</a>.<a class="ref" href="call_graph.h.html#_ZNK3xla13CallGraphNode7contextEv" title='xla::CallGraphNode::context' data-ref="_ZNK3xla13CallGraphNode7contextEv">context</a>() == <a class="type" href="call_graph.h.html#xla::CallContext" title='xla::CallContext' data-ref="xla::CallContext">CallContext</a>::<a class="enum" href="call_graph.h.html#xla::CallContext::kParallel" title='xla::CallContext::kParallel' data-ref="xla::CallContext::kParallel">kParallel</a>) {</td></tr>
<tr><th id="1021">1021</th><td>      <b>continue</b>;</td></tr>
<tr><th id="1022">1022</th><td>    }</td></tr>
<tr><th id="1023">1023</th><td>    <a class="macro" href="../status_macros.h.html#179" title="while ((__builtin_expect(!(node.context() == CallContext::kSequential), 0))) return xla::status_macros::MakeErrorStream(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 1023, tensorflow::error::INTERNAL) .with_log_stack_trace() .add_ret_check_failure(&quot;node.context() == CallContext::kSequential&quot;)" data-ref="_M/TF_RET_CHECK">TF_RET_CHECK</a>(<a class="local col4 ref" href="#184node" title='node' data-ref="184node">node</a>.<a class="ref" href="call_graph.h.html#_ZNK3xla13CallGraphNode7contextEv" title='xla::CallGraphNode::context' data-ref="_ZNK3xla13CallGraphNode7contextEv">context</a>() == <a class="type" href="call_graph.h.html#xla::CallContext" title='xla::CallContext' data-ref="xla::CallContext">CallContext</a>::<a class="enum" href="call_graph.h.html#xla::CallContext::kSequential" title='xla::CallContext::kSequential' data-ref="xla::CallContext::kSequential">kSequential</a>);</td></tr>
<tr><th id="1024">1024</th><td></td></tr>
<tr><th id="1025">1025</th><td>    <a class="tu type" href="#xla::(anonymousnamespace)::SpecialCaseCopyPolicy" title='xla::(anonymous namespace)::SpecialCaseCopyPolicy' data-ref="xla::(anonymousnamespace)::SpecialCaseCopyPolicy">SpecialCaseCopyPolicy</a> <dfn class="local col5 decl" id="185policy" title='policy' data-type='xla::(anonymous namespace)::SpecialCaseCopyPolicy' data-ref="185policy">policy</dfn> =</td></tr>
<tr><th id="1026">1026</th><td>        <a class="tu ref" href="#_ZN3xla12_GLOBAL__N_124GetSpecialCaseCopyPolicyERKNS_13CallGraphNodeEPNS_9HloModuleEPNS_14HloComputationE" title='xla::(anonymous namespace)::GetSpecialCaseCopyPolicy' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_124GetSpecialCaseCopyPolicyERKNS_13CallGraphNodeEPNS_9HloModuleEPNS_14HloComputationE">GetSpecialCaseCopyPolicy</a>(<a class="local col4 ref" href="#184node" title='node' data-ref="184node">node</a>, <a class="local col4 ref" href="#174module" title='module' data-ref="174module">module</a>, <a class="local col3 ref" href="#183computation" title='computation' data-ref="183computation">computation</a>);</td></tr>
<tr><th id="1027">1027</th><td>    <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col6 decl" id="186root" title='root' data-type='xla::HloInstruction *' data-ref="186root">root</dfn> = <a class="local col3 ref" href="#183computation" title='computation' data-ref="183computation">computation</a>-&gt;<a class="ref" href="hlo_computation.h.html#_ZNK3xla14HloComputation16root_instructionEv" title='xla::HloComputation::root_instruction' data-ref="_ZNK3xla14HloComputation16root_instructionEv">root_instruction</a>();</td></tr>
<tr><th id="1028">1028</th><td></td></tr>
<tr><th id="1029">1029</th><td>    <i>// Mark nondistinct/ambiguous indices.</i></td></tr>
<tr><th id="1030">1030</th><td>    <span class="namespace">tensorflow::gtl::</span><a class="type" href="../../../core/lib/gtl/flatset.h.html#tensorflow::gtl::FlatSet" title='tensorflow::gtl::FlatSet' data-ref="tensorflow::gtl::FlatSet">FlatSet</a>&lt;<em>const</em> <a class="type" href="hlo_buffer.h.html#xla::HloBuffer" title='xla::HloBuffer' data-ref="xla::HloBuffer">HloBuffer</a>*&gt; <a class="ref fake" href="../../../core/lib/gtl/flatset.h.html#_ZN10tensorflow3gtl7FlatSetC1Ev" title='tensorflow::gtl::FlatSet::FlatSet&lt;Key, Hash, Eq&gt;' data-ref="_ZN10tensorflow3gtl7FlatSetC1Ev"></a><dfn class="local col7 decl" id="187seen" title='seen' data-type='tensorflow::gtl::FlatSet&lt;const HloBuffer *&gt;' data-ref="187seen">seen</dfn>;</td></tr>
<tr><th id="1031">1031</th><td>    <a class="type" href="../shape_util.h.html#xla::ShapeUtil" title='xla::ShapeUtil' data-ref="xla::ShapeUtil">ShapeUtil</a>::<a class="ref" href="../shape_util.h.html#_ZN3xla9ShapeUtil15ForEachSubshapeERKNS_5ShapeERKSt8functionIFvS3_RKNS_10ShapeIndexEEE" title='xla::ShapeUtil::ForEachSubshape' data-ref="_ZN3xla9ShapeUtil15ForEachSubshapeERKNS_5ShapeERKSt8functionIFvS3_RKNS_10ShapeIndexEEE">ForEachSubshape</a>(</td></tr>
<tr><th id="1032">1032</th><td>        <a class="local col6 ref" href="#186root" title='root' data-ref="186root">root</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction5shapeEv" title='xla::HloInstruction::shape' data-ref="_ZNK3xla14HloInstruction5shapeEv">shape</a>(), <a class="ref fake" href="../../../../../include/c++/5/functional.html#_ZNSt8functionIFT_DpT0_EEC1ET_" title='std::function&lt;type-parameter-0-0 (type-parameter-0-1...)&gt;::function&lt;type-parameter-0-0 (type-parameter-0-1...)&gt;' data-ref="_ZNSt8functionIFT_DpT0_EEC1ET_"></a>[&amp;](<em>const</em> <span class='type' title='xla::Shape' data-ref="xla::Shape">Shape</span>&amp; <i>/*subshape*/</i>, <em>const</em> <a class="type" href="../shape_util.h.html#xla::ShapeIndex" title='xla::ShapeIndex' data-ref="xla::ShapeIndex">ShapeIndex</a>&amp; <dfn class="local col8 decl" id="188index" title='index' data-type='const xla::ShapeIndex &amp;' data-ref="188index">index</dfn>) {</td></tr>
<tr><th id="1033">1033</th><td>          <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<em>const</em> <a class="type" href="hlo_buffer.h.html#xla::HloBuffer" title='xla::HloBuffer' data-ref="xla::HloBuffer">HloBuffer</a>*&gt; <dfn class="local col9 decl" id="189buffers_at_index" title='buffers_at_index' data-type='std::vector&lt;const HloBuffer *&gt;' data-ref="189buffers_at_index">buffers_at_index</dfn> =</td></tr>
<tr><th id="1034">1034</th><td>              <a class="local col5 ref" href="#984" title='alias_analysis' data-ref="175alias_analysis">alias_analysis</a><a class="ref" href="../../../../../include/c++/5/bits/unique_ptr.h.html#_ZNKSt10unique_ptrptEv" title='std::unique_ptr::operator-&gt;' data-ref="_ZNKSt10unique_ptrptEv">-&gt;</a><a class="ref" href="hlo_alias_analysis.h.html#_ZNK3xla16HloAliasAnalysis16ComputeBuffersAtEPKNS_14HloInstructionERKNS_10ShapeIndexE" title='xla::HloAliasAnalysis::ComputeBuffersAt' data-ref="_ZNK3xla16HloAliasAnalysis16ComputeBuffersAtEPKNS_14HloInstructionERKNS_10ShapeIndexE">ComputeBuffersAt</a>(<a class="local col6 ref" href="#186root" title='root' data-ref="186root">root</a>, <a class="local col8 ref" href="#188index" title='index' data-ref="188index">index</a>);</td></tr>
<tr><th id="1035">1035</th><td>          <em>bool</em> <dfn class="local col0 decl" id="190buffer_seen_before" title='buffer_seen_before' data-type='bool' data-ref="190buffer_seen_before">buffer_seen_before</dfn> = <b>false</b>;</td></tr>
<tr><th id="1036">1036</th><td>          <b>for</b> (<em>const</em> <a class="type" href="hlo_buffer.h.html#xla::HloBuffer" title='xla::HloBuffer' data-ref="xla::HloBuffer">HloBuffer</a>* <dfn class="local col1 decl" id="191buffer" title='buffer' data-type='const xla::HloBuffer *' data-ref="191buffer">buffer</dfn> : <a class="local col9 ref" href="#189buffers_at_index" title='buffers_at_index' data-ref="189buffers_at_index">buffers_at_index</a>) {</td></tr>
<tr><th id="1037">1037</th><td>            <a class="local col0 ref" href="#190buffer_seen_before" title='buffer_seen_before' data-ref="190buffer_seen_before">buffer_seen_before</a> |= !<a class="local col7 ref" href="#187seen" title='seen' data-ref="187seen">seen</a>.<a class="ref" href="../../../core/lib/gtl/flatset.h.html#_ZN10tensorflow3gtl7FlatSet6insertERKT_" title='tensorflow::gtl::FlatSet::insert' data-ref="_ZN10tensorflow3gtl7FlatSet6insertERKT_">insert</a>(<a class="local col1 ref" href="#191buffer" title='buffer' data-ref="191buffer">buffer</a>).<a class="ref" href="../../../../../include/c++/5/bits/stl_pair.h.html#std::pair::second" title='std::pair&lt;tensorflow::gtl::FlatSet&lt;const xla::HloBuffer *, tensorflow::hash&lt;const xla::HloBuffer *&gt;, std::equal_to&lt;const xla::HloBuffer *&gt; &gt;::const_iterator, bool&gt;::second' data-ref="std::pair::second">second</a>;</td></tr>
<tr><th id="1038">1038</th><td>          }</td></tr>
<tr><th id="1039">1039</th><td>          <b>if</b> (<a class="local col9 ref" href="#189buffers_at_index" title='buffers_at_index' data-ref="189buffers_at_index">buffers_at_index</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNKSt6vector4sizeEv" title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv">size</a>() &gt; <var>1</var> ||</td></tr>
<tr><th id="1040">1040</th><td>              (<a class="local col0 ref" href="#190buffer_seen_before" title='buffer_seen_before' data-ref="190buffer_seen_before">buffer_seen_before</a> &amp;&amp; <a class="local col5 ref" href="#185policy" title='policy' data-ref="185policy">policy</a>.<a class="tu ref" href="#xla::(anonymousnamespace)::SpecialCaseCopyPolicy::copy_root_replicated_buffers" title='xla::(anonymous namespace)::SpecialCaseCopyPolicy::copy_root_replicated_buffers' data-use='r' data-ref="xla::(anonymousnamespace)::SpecialCaseCopyPolicy::copy_root_replicated_buffers">copy_root_replicated_buffers</a>)) {</td></tr>
<tr><th id="1041">1041</th><td>            <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((2) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 1041, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>2</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <q>"Index "</q> <a class="ref" href="../shape_util.h.html#_ZN3xlalsERSoRKNS_10ShapeIndexE" title='xla::operator&lt;&lt;' data-ref="_ZN3xlalsERSoRKNS_10ShapeIndexE">&lt;&lt;</a> <a class="local col8 ref" href="#188index" title='index' data-ref="188index">index</a> <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsRSt13basic_ostreamIcT_EPKc" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIcT_EPKc">&lt;&lt;</a> <q>" of computation "</q></td></tr>
<tr><th id="1042">1042</th><td>                    <a class="ref" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E">&lt;&lt;</a> <a class="local col3 ref" href="#183computation" title='computation' data-ref="183computation">computation</a>-&gt;<a class="ref" href="hlo_computation.h.html#_ZNK3xla14HloComputation4nameEv" title='xla::HloComputation::name' data-ref="_ZNK3xla14HloComputation4nameEv">name</a>() <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsRSt13basic_ostreamIcT_EPKc" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIcT_EPKc">&lt;&lt;</a> <q>" ("</q> <a class="ref" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E">&lt;&lt;</a> <a class="local col6 ref" href="#186root" title='root' data-ref="186root">root</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction4nameEv" title='xla::HloInstruction::name' data-ref="_ZNK3xla14HloInstruction4nameEv">name</a>()</td></tr>
<tr><th id="1043">1043</th><td>                    <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsRSt13basic_ostreamIcT_EPKc" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIcT_EPKc">&lt;&lt;</a> <q>") has ambiguous or non-distinct buffer. Copying."</q>;</td></tr>
<tr><th id="1044">1044</th><td>            <a class="local col7 ref" href="#177add_index_to_copy" title='add_index_to_copy' data-ref="177add_index_to_copy">add_index_to_copy</a>(<a class="local col6 ref" href="#186root" title='root' data-ref="186root">root</a>, <a class="local col8 ref" href="#188index" title='index' data-ref="188index">index</a>);</td></tr>
<tr><th id="1045">1045</th><td>          }</td></tr>
<tr><th id="1046">1046</th><td>        });</td></tr>
<tr><th id="1047">1047</th><td></td></tr>
<tr><th id="1048">1048</th><td>    <b>for</b> (<em>const</em> <em>auto</em>&amp; <dfn class="local col2 decl" id="192pair" title='pair' data-type='const std::pair&lt;xla::ShapeIndex, const xla::HloValueSet &amp;&gt; &amp;' data-ref="192pair">pair</dfn> :</td></tr>
<tr><th id="1049">1049</th><td>         <a class="local col5 ref" href="#984" title='alias_analysis' data-ref="175alias_analysis">alias_analysis</a><a class="ref" href="../../../../../include/c++/5/bits/unique_ptr.h.html#_ZNKSt10unique_ptrptEv" title='std::unique_ptr::operator-&gt;' data-ref="_ZNKSt10unique_ptrptEv">-&gt;</a><a class="ref" href="hlo_alias_analysis.h.html#_ZNK3xla16HloAliasAnalysis17dataflow_analysisEv" title='xla::HloAliasAnalysis::dataflow_analysis' data-ref="_ZNK3xla16HloAliasAnalysis17dataflow_analysisEv">dataflow_analysis</a>().<a class="ref" href="hlo_dataflow_analysis.h.html#_ZNK3xla19HloDataflowAnalysis22GetInstructionValueSetEPKNS_14HloInstructionE" title='xla::HloDataflowAnalysis::GetInstructionValueSet' data-ref="_ZNK3xla19HloDataflowAnalysis22GetInstructionValueSetEPKNS_14HloInstructionE">GetInstructionValueSet</a>(<a class="local col6 ref" href="#186root" title='root' data-ref="186root">root</a>)) {</td></tr>
<tr><th id="1050">1050</th><td>      <em>const</em> <a class="type" href="../shape_util.h.html#xla::ShapeIndex" title='xla::ShapeIndex' data-ref="xla::ShapeIndex">ShapeIndex</a>&amp; <dfn class="local col3 decl" id="193index" title='index' data-type='const xla::ShapeIndex &amp;' data-ref="193index">index</dfn> = <a class="local col2 ref" href="#192pair" title='pair' data-ref="192pair">pair</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_pair.h.html#std::pair::first" title='std::pair&lt;xla::ShapeIndex, const xla::HloValueSet &amp;&gt;::first' data-ref="std::pair::first">first</a>;</td></tr>
<tr><th id="1051">1051</th><td>      <em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValueSet" title='xla::HloValueSet' data-ref="xla::HloValueSet">HloValueSet</a>&amp; <dfn class="local col4 decl" id="194value_set" title='value_set' data-type='const xla::HloValueSet &amp;' data-ref="194value_set">value_set</dfn> = <a class="local col2 ref" href="#192pair" title='pair' data-ref="192pair">pair</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_pair.h.html#std::pair::second" title='std::pair&lt;xla::ShapeIndex, const xla::HloValueSet &amp;&gt;::second' data-ref="std::pair::second">second</a>;</td></tr>
<tr><th id="1052">1052</th><td>      <b>for</b> (<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValue" title='xla::HloValue' data-ref="xla::HloValue">HloValue</a>* <dfn class="local col5 decl" id="195value" title='value' data-type='const xla::HloValue *' data-ref="195value">value</dfn> : <a class="local col4 ref" href="#194value_set" title='value_set' data-ref="194value_set">value_set</a>.<a class="ref" href="hlo_value.h.html#_ZNK3xla11HloValueSet6valuesEv" title='xla::HloValueSet::values' data-ref="_ZNK3xla11HloValueSet6valuesEv">values</a>()) {</td></tr>
<tr><th id="1053">1053</th><td>        <b>if</b> (<a class="tu ref" href="#_ZN3xla12_GLOBAL__N_119ShouldCopyRootValueERKNS_8HloValueERKNS0_21SpecialCaseCopyPolicyE" title='xla::(anonymous namespace)::ShouldCopyRootValue' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_119ShouldCopyRootValueERKNS_8HloValueERKNS0_21SpecialCaseCopyPolicyE">ShouldCopyRootValue</a>(*<a class="local col5 ref" href="#195value" title='value' data-ref="195value">value</a>, <a class="local col5 ref" href="#185policy" title='policy' data-ref="185policy">policy</a>)) {</td></tr>
<tr><th id="1054">1054</th><td>          <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((2) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 1054, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>2</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <q>"Root of ("</q> <a class="ref" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E">&lt;&lt;</a> <a class="local col6 ref" href="#186root" title='root' data-ref="186root">root</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction4nameEv" title='xla::HloInstruction::name' data-ref="_ZNK3xla14HloInstruction4nameEv">name</a>() <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsRSt13basic_ostreamIcT_EPKc" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIcT_EPKc">&lt;&lt;</a> <q>") of computation("</q></td></tr>
<tr><th id="1055">1055</th><td>                  <a class="ref" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIT_T0_ERKSbIS0_S1_T1_E">&lt;&lt;</a> <a class="local col3 ref" href="#183computation" title='computation' data-ref="183computation">computation</a>-&gt;<a class="ref" href="hlo_computation.h.html#_ZNK3xla14HloComputation4nameEv" title='xla::HloComputation::name' data-ref="_ZNK3xla14HloComputation4nameEv">name</a>()</td></tr>
<tr><th id="1056">1056</th><td>                  <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsRSt13basic_ostreamIcT_EPKc" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIcT_EPKc">&lt;&lt;</a> <q>") has constant or parameter value at index "</q> <a class="ref" href="../shape_util.h.html#_ZN3xlalsERSoRKNS_10ShapeIndexE" title='xla::operator&lt;&lt;' data-ref="_ZN3xlalsERSoRKNS_10ShapeIndexE">&lt;&lt;</a> <a class="local col3 ref" href="#193index" title='index' data-ref="193index">index</a></td></tr>
<tr><th id="1057">1057</th><td>                  <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsRSt13basic_ostreamIcT_EPKc" title='std::operator&lt;&lt;' data-ref="_ZStlsRSt13basic_ostreamIcT_EPKc">&lt;&lt;</a> <q>". Copying."</q>;</td></tr>
<tr><th id="1058">1058</th><td>          <a class="local col7 ref" href="#177add_index_to_copy" title='add_index_to_copy' data-ref="177add_index_to_copy">add_index_to_copy</a>(<a class="local col6 ref" href="#186root" title='root' data-ref="186root">root</a>, <a class="local col3 ref" href="#193index" title='index' data-ref="193index">index</a>);</td></tr>
<tr><th id="1059">1059</th><td>        }</td></tr>
<tr><th id="1060">1060</th><td>      }</td></tr>
<tr><th id="1061">1061</th><td>    }</td></tr>
<tr><th id="1062">1062</th><td>  }</td></tr>
<tr><th id="1063">1063</th><td></td></tr>
<tr><th id="1064">1064</th><td>  <i>// Add copy instructions indicated in 'instructions_to_copy' to the module.</i></td></tr>
<tr><th id="1065">1065</th><td>  <b>for</b> (<em>const</em> <em>auto</em>&amp; <dfn class="local col6 decl" id="196pair" title='pair' data-type='const std::pair&lt;xla::HloInstruction *const, xla::ShapeTree&lt;bool&gt; &gt; &amp;' data-ref="196pair">pair</dfn> : <a class="local col6 ref" href="#176instructions_to_copy" title='instructions_to_copy' data-ref="176instructions_to_copy">instructions_to_copy</a>) {</td></tr>
<tr><th id="1066">1066</th><td>    <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col7 decl" id="197instruction" title='instruction' data-type='xla::HloInstruction *' data-ref="197instruction">instruction</dfn> = <a class="local col6 ref" href="#196pair" title='pair' data-ref="196pair">pair</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_pair.h.html#std::pair::first" title='std::pair&lt;xla::HloInstruction *const, xla::ShapeTree&lt;bool&gt; &gt;::first' data-ref="std::pair::first">first</a>;</td></tr>
<tr><th id="1067">1067</th><td>    <em>const</em> <a class="type" href="../shape_tree.h.html#xla::ShapeTree" title='xla::ShapeTree' data-ref="xla::ShapeTree">ShapeTree</a>&lt;<em>bool</em>&gt;&amp; <dfn class="local col8 decl" id="198indices_to_copy" title='indices_to_copy' data-type='const ShapeTree&lt;bool&gt; &amp;' data-ref="198indices_to_copy">indices_to_copy</dfn> = <a class="local col6 ref" href="#196pair" title='pair' data-ref="196pair">pair</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_pair.h.html#std::pair::second" title='std::pair&lt;xla::HloInstruction *const, xla::ShapeTree&lt;bool&gt; &gt;::second' data-ref="std::pair::second">second</a>;</td></tr>
<tr><th id="1068">1068</th><td></td></tr>
<tr><th id="1069">1069</th><td>    <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/stl_vector.h.html#std::vector" title='std::vector' data-ref="std::vector">vector</a>&lt;<a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>*&gt; <dfn class="local col9 decl" id="199users" title='users' data-type='std::vector&lt;HloInstruction *&gt;' data-ref="199users">users</dfn> = <a class="ref fake" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNSt6vectorC1ERKSt6vectorIT_T0_E" title='std::vector::vector&lt;_Tp, _Alloc&gt;' data-ref="_ZNSt6vectorC1ERKSt6vectorIT_T0_E"></a><a class="local col7 ref" href="#197instruction" title='instruction' data-ref="197instruction">instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction5usersEv" title='xla::HloInstruction::users' data-ref="_ZNK3xla14HloInstruction5usersEv">users</a>();</td></tr>
<tr><th id="1070">1070</th><td>    <a class="macro" href="../status_macros.h.html#199" title="auto _status_or_value17 = (instruction-&gt;parent()-&gt;DeepCopyInstruction( instruction, &amp;indices_to_copy)); if ((__builtin_expect(!_status_or_value17.ok(), 0))) { return _status_or_value17.status(); } HloInstruction * deep_copy = std::move(_status_or_value17.ValueOrDie())" data-ref="_M/TF_ASSIGN_OR_RETURN">TF_ASSIGN_OR_RETURN</a>(<a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a> * <dfn class="local col0 decl" id="200deep_copy" title='deep_copy' data-type='xla::HloInstruction *' data-ref="200deep_copy">deep_copy</dfn>,</td></tr>
<tr><th id="1071">1071</th><td>                        <a class="local col7 ref" href="#197instruction" title='instruction' data-ref="197instruction">instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZN3xla14HloInstruction6parentEv" title='xla::HloInstruction::parent' data-ref="_ZN3xla14HloInstruction6parentEv">parent</a>()-&gt;<a class="ref" href="hlo_computation.h.html#_ZN3xla14HloComputation19DeepCopyInstructionEPNS_14HloInstructionEPKNS_9ShapeTreeIbEEPNS3_IS2_EE" title='xla::HloComputation::DeepCopyInstruction' data-ref="_ZN3xla14HloComputation19DeepCopyInstructionEPNS_14HloInstructionEPKNS_9ShapeTreeIbEEPNS3_IS2_EE">DeepCopyInstruction</a>(</td></tr>
<tr><th id="1072">1072</th><td>                            <a class="local col7 ref" href="#197instruction" title='instruction' data-ref="197instruction">instruction</a>, &amp;<a class="local col8 ref" href="#198indices_to_copy" title='indices_to_copy' data-ref="198indices_to_copy">indices_to_copy</a>));</td></tr>
<tr><th id="1073">1073</th><td>    <b>for</b> (<a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col1 decl" id="201user" title='user' data-type='xla::HloInstruction *' data-ref="201user">user</dfn> : <a class="local col9 ref" href="#199users" title='users' data-ref="199users">users</a>) {</td></tr>
<tr><th id="1074">1074</th><td>      <a class="macro" href="../../../core/lib/core/errors.h.html#69" title="do { const ::tensorflow::Status _status = (instruction-&gt;ReplaceUseWith(user, deep_copy)); if ((__builtin_expect(!_status.ok(), 0))) return _status; } while (0)" data-ref="_M/TF_RETURN_IF_ERROR">TF_RETURN_IF_ERROR</a>(<a class="local col7 ref" href="#197instruction" title='instruction' data-ref="197instruction">instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZN3xla14HloInstruction14ReplaceUseWithEPS0_S1_" title='xla::HloInstruction::ReplaceUseWith' data-ref="_ZN3xla14HloInstruction14ReplaceUseWithEPS0_S1_">ReplaceUseWith</a>(<a class="local col1 ref" href="#201user" title='user' data-ref="201user">user</a>, <a class="local col0 ref" href="#1070" title='deep_copy' data-ref="200deep_copy">deep_copy</a>));</td></tr>
<tr><th id="1075">1075</th><td>    }</td></tr>
<tr><th id="1076">1076</th><td>    <b>if</b> (<a class="local col7 ref" href="#197instruction" title='instruction' data-ref="197instruction">instruction</a> == <a class="local col7 ref" href="#197instruction" title='instruction' data-ref="197instruction">instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZN3xla14HloInstruction6parentEv" title='xla::HloInstruction::parent' data-ref="_ZN3xla14HloInstruction6parentEv">parent</a>()-&gt;<a class="ref" href="hlo_computation.h.html#_ZNK3xla14HloComputation16root_instructionEv" title='xla::HloComputation::root_instruction' data-ref="_ZNK3xla14HloComputation16root_instructionEv">root_instruction</a>()) {</td></tr>
<tr><th id="1077">1077</th><td>      <a class="local col7 ref" href="#197instruction" title='instruction' data-ref="197instruction">instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZN3xla14HloInstruction6parentEv" title='xla::HloInstruction::parent' data-ref="_ZN3xla14HloInstruction6parentEv">parent</a>()-&gt;<a class="ref" href="hlo_computation.h.html#_ZN3xla14HloComputation20set_root_instructionEPNS_14HloInstructionE" title='xla::HloComputation::set_root_instruction' data-ref="_ZN3xla14HloComputation20set_root_instructionEPNS_14HloInstructionE">set_root_instruction</a>(<a class="local col0 ref" href="#1070" title='deep_copy' data-ref="200deep_copy">deep_copy</a>);</td></tr>
<tr><th id="1078">1078</th><td>    }</td></tr>
<tr><th id="1079">1079</th><td>  }</td></tr>
<tr><th id="1080">1080</th><td>  <b>return</b> <a class="type" href="../../../core/lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a>::<a class="ref" href="../../../core/lib/core/status.h.html#_ZN10tensorflow6Status2OKEv" title='tensorflow::Status::OK' data-ref="_ZN10tensorflow6Status2OKEv">OK</a>();</td></tr>
<tr><th id="1081">1081</th><td>}</td></tr>
<tr><th id="1082">1082</th><td></td></tr>
<tr><th id="1083">1083</th><td><a class="type" href="../../../core/lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a> <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_129VerifyNoLiveRangeInterferenceEPNS_9HloModuleE" title='xla::(anonymous namespace)::VerifyNoLiveRangeInterference' data-type='tensorflow::Status xla::(anonymous namespace)::VerifyNoLiveRangeInterference(xla::HloModule * module)' data-ref="_ZN3xla12_GLOBAL__N_129VerifyNoLiveRangeInterferenceEPNS_9HloModuleE">VerifyNoLiveRangeInterference</dfn>(<a class="type" href="hlo_module.h.html#xla::HloModule" title='xla::HloModule' data-ref="xla::HloModule">HloModule</a>* <dfn class="local col2 decl" id="202module" title='module' data-type='xla::HloModule *' data-ref="202module">module</dfn>) {</td></tr>
<tr><th id="1084">1084</th><td>  <a class="macro" href="../status_macros.h.html#199" title="auto _status_or_value19 = (HloAliasAnalysis::Run(module)); if ((__builtin_expect(!_status_or_value19.ok(), 0))) { return _status_or_value19.status(); } std::unique_ptr&lt;HloAliasAnalysis&gt; alias_analysis = std::move(_status_or_value19.ValueOrDie())" data-ref="_M/TF_ASSIGN_OR_RETURN">TF_ASSIGN_OR_RETURN</a>(std::<a class="type" href="../../../../../include/c++/5/bits/unique_ptr.h.html#std::unique_ptr" title='std::unique_ptr' data-ref="std::unique_ptr">unique_ptr</a>&lt;<a class="type" href="hlo_alias_analysis.h.html#xla::HloAliasAnalysis" title='xla::HloAliasAnalysis' data-ref="xla::HloAliasAnalysis">HloAliasAnalysis</a>&gt; <dfn class="local col3 decl" id="203alias_analysis" title='alias_analysis' data-type='std::unique_ptr&lt;HloAliasAnalysis&gt;' data-ref="203alias_analysis">alias_analysis</dfn>,</td></tr>
<tr><th id="1085">1085</th><td>                      <a class="type" href="hlo_alias_analysis.h.html#xla::HloAliasAnalysis" title='xla::HloAliasAnalysis' data-ref="xla::HloAliasAnalysis">HloAliasAnalysis</a>::<a class="ref" href="hlo_alias_analysis.h.html#_ZN3xla16HloAliasAnalysis3RunEPNS_9HloModuleE" title='xla::HloAliasAnalysis::Run' data-ref="_ZN3xla16HloAliasAnalysis3RunEPNS_9HloModuleE">Run</a>(<a class="local col2 ref" href="#202module" title='module' data-ref="202module">module</a>));</td></tr>
<tr><th id="1086">1086</th><td>  <a class="type" href="hlo_ordering.h.html#xla::DependencyHloOrdering" title='xla::DependencyHloOrdering' data-ref="xla::DependencyHloOrdering">DependencyHloOrdering</a> <dfn class="local col4 decl" id="204ordering" title='ordering' data-type='xla::DependencyHloOrdering' data-ref="204ordering">ordering</dfn><a class="ref" href="hlo_ordering.h.html#_ZN3xla21DependencyHloOrderingC1EPKNS_9HloModuleE" title='xla::DependencyHloOrdering::DependencyHloOrdering' data-ref="_ZN3xla21DependencyHloOrderingC1EPKNS_9HloModuleE">(</a><a class="local col2 ref" href="#202module" title='module' data-ref="202module">module</a>);</td></tr>
<tr><th id="1087">1087</th><td>  <a class="macro" href="../status_macros.h.html#179" title="while ((__builtin_expect(!(!alias_analysis-&gt;HasLiveRangeInterference(ordering)), 0))) return xla::status_macros::MakeErrorStream(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 1087, tensorflow::error::INTERNAL) .with_log_stack_trace() .add_ret_check_failure(&quot;!alias_analysis-&gt;HasLiveRangeInterference(ordering)&quot;)" data-ref="_M/TF_RET_CHECK">TF_RET_CHECK</a>(!<a class="local col3 ref" href="#1084" title='alias_analysis' data-ref="203alias_analysis">alias_analysis</a><a class="ref" href="../../../../../include/c++/5/bits/unique_ptr.h.html#_ZNKSt10unique_ptrptEv" title='std::unique_ptr::operator-&gt;' data-ref="_ZNKSt10unique_ptrptEv">-&gt;</a><a class="ref" href="hlo_alias_analysis.h.html#_ZNK3xla16HloAliasAnalysis24HasLiveRangeInterferenceERKNS_11HloOrderingE" title='xla::HloAliasAnalysis::HasLiveRangeInterference' data-ref="_ZNK3xla16HloAliasAnalysis24HasLiveRangeInterferenceERKNS_11HloOrderingE">HasLiveRangeInterference</a>(<a class="local col4 ref" href="#204ordering" title='ordering' data-ref="204ordering">ordering</a>));</td></tr>
<tr><th id="1088">1088</th><td>  <b>return</b> <a class="type" href="../../../core/lib/core/status.h.html#tensorflow::Status" title='tensorflow::Status' data-ref="tensorflow::Status">Status</a>::<a class="ref" href="../../../core/lib/core/status.h.html#_ZN10tensorflow6Status2OKEv" title='tensorflow::Status::OK' data-ref="_ZN10tensorflow6Status2OKEv">OK</a>();</td></tr>
<tr><th id="1089">1089</th><td>}</td></tr>
<tr><th id="1090">1090</th><td></td></tr>
<tr><th id="1091">1091</th><td><em>void</em> <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_115MaybeDumpModuleERKSsRKNS_9HloModuleE" title='xla::(anonymous namespace)::MaybeDumpModule' data-type='void xla::(anonymous namespace)::MaybeDumpModule(const string &amp; message, const xla::HloModule &amp; module)' data-ref="_ZN3xla12_GLOBAL__N_115MaybeDumpModuleERKSsRKNS_9HloModuleE">MaybeDumpModule</dfn>(<em>const</em> <a class="typedef" href="../../../../../include/c++/5/bits/stringfwd.h.html#std::string" title='std::string' data-type='basic_string&lt;char&gt;' data-ref="std::string">string</a>&amp; <dfn class="local col5 decl" id="205message" title='message' data-type='const string &amp;' data-ref="205message">message</dfn>, <em>const</em> <a class="type" href="hlo_module.h.html#xla::HloModule" title='xla::HloModule' data-ref="xla::HloModule">HloModule</a>&amp; <dfn class="local col6 decl" id="206module" title='module' data-type='const xla::HloModule &amp;' data-ref="206module">module</dfn>) {</td></tr>
<tr><th id="1092">1092</th><td>  <b>if</b> (<a class="macro" href="../../../core/platform/default/logging.h.html#85" title="((3) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel())" data-ref="_M/VLOG_IS_ON">VLOG_IS_ON</a>(<var>3</var>)) {</td></tr>
<tr><th id="1093">1093</th><td>    <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((3) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 1093, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>3</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <a class="local col5 ref" href="#205message" title='message' data-ref="205message">message</a>;</td></tr>
<tr><th id="1094">1094</th><td>    <a class="macro" href="../util.h.html#536" title="do { if (((3) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel())) ::xla::LogLines(::tensorflow::INFO, module.ToString(), &quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 1094); } while (false);" data-ref="_M/XLA_VLOG_LINES">XLA_VLOG_LINES</a>(<var>3</var>, <a class="ref fake" href="../../../core/lib/core/stringpiece.h.html#_ZN10tensorflow11StringPieceC1ERKSs" title='tensorflow::StringPiece::StringPiece' data-ref="_ZN10tensorflow11StringPieceC1ERKSs"></a><a class="local col6 ref" href="#206module" title='module' data-ref="206module">module</a>.<a class="ref" href="hlo_module.h.html#_ZNK3xla9HloModule8ToStringEv" title='xla::HloModule::ToString' data-ref="_ZNK3xla9HloModule8ToStringEv">ToString</a>());</td></tr>
<tr><th id="1095">1095</th><td>    <span class="namespace">hlo_graph_dumper::</span><a class="ref" href="hlo_graph_dumper.h.html#_ZN3xla16hlo_graph_dumper18MaybeDumpHloModuleERKNS_9HloModuleERKSsPKNS_19HloExecutionProfileE" title='xla::hlo_graph_dumper::MaybeDumpHloModule' data-ref="_ZN3xla16hlo_graph_dumper18MaybeDumpHloModuleERKNS_9HloModuleERKSsPKNS_19HloExecutionProfileE">MaybeDumpHloModule</a>(<a class="local col6 ref" href="#206module" title='module' data-ref="206module">module</a>, <a class="local col5 ref" href="#205message" title='message' data-ref="205message">message</a>);</td></tr>
<tr><th id="1096">1096</th><td>  }</td></tr>
<tr><th id="1097">1097</th><td>}</td></tr>
<tr><th id="1098">1098</th><td></td></tr>
<tr><th id="1099">1099</th><td>}  <i>// namespace</i></td></tr>
<tr><th id="1100">1100</th><td></td></tr>
<tr><th id="1101">1101</th><td><a class="type" href="../statusor.h.html#xla::StatusOr" title='xla::StatusOr' data-ref="xla::StatusOr">StatusOr</a>&lt;<em>bool</em>&gt; <a class="type" href="copy_insertion.h.html#xla::CopyInsertion" title='xla::CopyInsertion' data-ref="xla::CopyInsertion">CopyInsertion</a>::<dfn class="virtual decl def" id="_ZN3xla13CopyInsertion3RunEPNS_9HloModuleE" title='xla::CopyInsertion::Run' data-ref="_ZN3xla13CopyInsertion3RunEPNS_9HloModuleE">Run</dfn>(<a class="type" href="hlo_module.h.html#xla::HloModule" title='xla::HloModule' data-ref="xla::HloModule">HloModule</a>* <dfn class="local col7 decl" id="207module" title='module' data-type='xla::HloModule *' data-ref="207module">module</dfn>) {</td></tr>
<tr><th id="1102">1102</th><td>  <i>// Copy insertion is performed in three steps:</i></td></tr>
<tr><th id="1103">1103</th><td><i>  //</i></td></tr>
<tr><th id="1104">1104</th><td><i>  // (1) Add copies conservatively to guarantee that there is no live-range</i></td></tr>
<tr><th id="1105">1105</th><td><i>  //     interference. This is done simplistically and usually results in more</i></td></tr>
<tr><th id="1106">1106</th><td><i>  //     copies than is strictly necessary.</i></td></tr>
<tr><th id="1107">1107</th><td><i>  //</i></td></tr>
<tr><th id="1108">1108</th><td><i>  // (2) Using a more fine-grained analysis, remove as many copies that were</i></td></tr>
<tr><th id="1109">1109</th><td><i>  //     added in (1) as possible while ensuring no live-range interference.</i></td></tr>
<tr><th id="1110">1110</th><td><i>  //</i></td></tr>
<tr><th id="1111">1111</th><td><i>  // (3) Add copies to resolve issues not related to live range interference</i></td></tr>
<tr><th id="1112">1112</th><td><i>  //     such as parameters and constants live out of the entry computation.</i></td></tr>
<tr><th id="1113">1113</th><td><i>  //</i></td></tr>
<tr><th id="1114">1114</th><td><i>  // We add copies then remove them (step (1) then (2)) rather than simply</i></td></tr>
<tr><th id="1115">1115</th><td><i>  // adding only the copies that are necessary because, in general, it is</i></td></tr>
<tr><th id="1116">1116</th><td><i>  // difficult to figure out the minimal set of copies to add once there is</i></td></tr>
<tr><th id="1117">1117</th><td><i>  // interference. On the other hand, it is easy to determine if removing a copy</i></td></tr>
<tr><th id="1118">1118</th><td><i>  // will introduce interference.</i></td></tr>
<tr><th id="1119">1119</th><td><i>  //</i></td></tr>
<tr><th id="1120">1120</th><td><i>  // The final copy insertion in (3) is done separately to simplify the</i></td></tr>
<tr><th id="1121">1121</th><td><i>  // implementation of copy removal in (2) which is the most complicated part of</i></td></tr>
<tr><th id="1122">1122</th><td><i>  // the pass. As is, copy removal only has to reason about live range</i></td></tr>
<tr><th id="1123">1123</th><td><i>  // interference. If all copies were added in step (1) then copy removal would</i></td></tr>
<tr><th id="1124">1124</th><td><i>  // also have to reason about things like constants and parameters live out of</i></td></tr>
<tr><th id="1125">1125</th><td><i>  // the computation.</i></td></tr>
<tr><th id="1126">1126</th><td>  <a class="tu ref" href="#_ZN3xla12_GLOBAL__N_115MaybeDumpModuleERKSsRKNS_9HloModuleE" title='xla::(anonymous namespace)::MaybeDumpModule' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_115MaybeDumpModuleERKSsRKNS_9HloModuleE">MaybeDumpModule</a>(<a class="ref fake" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZNSt12basic_stringC1EPKT_RKT1_" title='std::basic_string::basic_string&lt;_CharT, _Traits, _Alloc&gt;' data-ref="_ZNSt12basic_stringC1EPKT_RKT1_"></a><q>"before copy insertion"</q>, *<a class="local col7 ref" href="#207module" title='module' data-ref="207module">module</a>);</td></tr>
<tr><th id="1127">1127</th><td></td></tr>
<tr><th id="1128">1128</th><td>  <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/unique_ptr.h.html#std::unique_ptr" title='std::unique_ptr' data-ref="std::unique_ptr">unique_ptr</a>&lt;<a class="type" href="call_graph.h.html#xla::CallGraph" title='xla::CallGraph' data-ref="xla::CallGraph">CallGraph</a>&gt; <dfn class="local col8 decl" id="208call_graph" title='call_graph' data-type='std::unique_ptr&lt;CallGraph&gt;' data-ref="208call_graph">call_graph</dfn> = <a class="type" href="call_graph.h.html#xla::CallGraph" title='xla::CallGraph' data-ref="xla::CallGraph">CallGraph</a>::<a class="ref" href="call_graph.h.html#_ZN3xla9CallGraph5BuildEPKNS_9HloModuleE" title='xla::CallGraph::Build' data-ref="_ZN3xla9CallGraph5BuildEPKNS_9HloModuleE">Build</a>(<a class="local col7 ref" href="#207module" title='module' data-ref="207module">module</a>);</td></tr>
<tr><th id="1129">1129</th><td>  <b>if</b> (!<a class="local col8 ref" href="#208call_graph" title='call_graph' data-ref="208call_graph">call_graph</a><a class="ref" href="../../../../../include/c++/5/bits/unique_ptr.h.html#_ZNKSt10unique_ptrptEv" title='std::unique_ptr::operator-&gt;' data-ref="_ZNKSt10unique_ptrptEv">-&gt;</a><a class="ref" href="call_graph.h.html#_ZNK3xla9CallGraph11IsFlattenedEv" title='xla::CallGraph::IsFlattened' data-ref="_ZNK3xla9CallGraph11IsFlattenedEv">IsFlattened</a>()) {</td></tr>
<tr><th id="1130">1130</th><td>    <b>return</b> <a class="ref fake" href="../statusor.h.html#_ZN3xla8StatusOrC1EON10tensorflow6StatusE" title='xla::StatusOr::StatusOr&lt;T&gt;' data-ref="_ZN3xla8StatusOrC1EON10tensorflow6StatusE"></a><a class="ref" href="../util.h.html#_ZN3xla18FailedPreconditionEPKcz" title='xla::FailedPrecondition' data-ref="_ZN3xla18FailedPreconditionEPKcz">FailedPrecondition</a>(</td></tr>
<tr><th id="1131">1131</th><td>        <q>"Call graph must be flattened before copy insertion."</q>);</td></tr>
<tr><th id="1132">1132</th><td>  }</td></tr>
<tr><th id="1133">1133</th><td></td></tr>
<tr><th id="1134">1134</th><td>  <i>// Gather Ids of existing kCopy instructions in the module. We avoid removing</i></td></tr>
<tr><th id="1135">1135</th><td><i>  // these copies (except via DCE in TupleSimplifier) because they may have been</i></td></tr>
<tr><th id="1136">1136</th><td><i>  // added for reasons not considered by copy insertion (eg, layout assignment).</i></td></tr>
<tr><th id="1137">1137</th><td><i>  // Instruction id is used instead of HloInstruction* because the pointer</i></td></tr>
<tr><th id="1138">1138</th><td><i>  // values may be recycled.</i></td></tr>
<tr><th id="1139">1139</th><td>  <span class="namespace">tensorflow::gtl::</span><a class="type" href="../../../core/lib/gtl/flatset.h.html#tensorflow::gtl::FlatSet" title='tensorflow::gtl::FlatSet' data-ref="tensorflow::gtl::FlatSet">FlatSet</a>&lt;<em>int</em>&gt; <a class="ref fake" href="../../../core/lib/gtl/flatset.h.html#_ZN10tensorflow3gtl7FlatSetC1Ev" title='tensorflow::gtl::FlatSet::FlatSet&lt;Key, Hash, Eq&gt;' data-ref="_ZN10tensorflow3gtl7FlatSetC1Ev"></a><dfn class="local col9 decl" id="209existing_copies" title='existing_copies' data-type='tensorflow::gtl::FlatSet&lt;int&gt;' data-ref="209existing_copies">existing_copies</dfn>;</td></tr>
<tr><th id="1140">1140</th><td>  <b>for</b> (<a class="type" href="hlo_computation.h.html#xla::HloComputation" title='xla::HloComputation' data-ref="xla::HloComputation">HloComputation</a>* <dfn class="local col0 decl" id="210computation" title='computation' data-type='xla::HloComputation *' data-ref="210computation">computation</dfn> : <a class="local col7 ref" href="#207module" title='module' data-ref="207module">module</a>-&gt;<a class="ref" href="hlo_module.h.html#_ZN3xla9HloModule12computationsEv" title='xla::HloModule::computations' data-ref="_ZN3xla9HloModule12computationsEv">computations</a>()) {</td></tr>
<tr><th id="1141">1141</th><td>    <b>for</b> (<a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col1 decl" id="211instruction" title='instruction' data-type='xla::HloInstruction *' data-ref="211instruction">instruction</dfn> : <a class="local col0 ref" href="#210computation" title='computation' data-ref="210computation">computation</a>-&gt;<a class="ref" href="hlo_computation.h.html#_ZN3xla14HloComputation12instructionsEv" title='xla::HloComputation::instructions' data-ref="_ZN3xla14HloComputation12instructionsEv">instructions</a>()) {</td></tr>
<tr><th id="1142">1142</th><td>      <b>if</b> (<a class="local col1 ref" href="#211instruction" title='instruction' data-ref="211instruction">instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction6opcodeEv" title='xla::HloInstruction::opcode' data-ref="_ZNK3xla14HloInstruction6opcodeEv">opcode</a>() == <a class="type" href="hlo_opcode.h.html#xla::HloOpcode" title='xla::HloOpcode' data-ref="xla::HloOpcode">HloOpcode</a>::<a class="enum" href="hlo_opcode.h.html#135" title='xla::HloOpcode::kCopy' data-ref="xla::HloOpcode::kCopy">kCopy</a>) {</td></tr>
<tr><th id="1143">1143</th><td>        <a class="local col9 ref" href="#209existing_copies" title='existing_copies' data-ref="209existing_copies">existing_copies</a>.<a class="ref" href="../../../core/lib/gtl/flatset.h.html#_ZN10tensorflow3gtl7FlatSet6insertERKT_" title='tensorflow::gtl::FlatSet::insert' data-ref="_ZN10tensorflow3gtl7FlatSet6insertERKT_">insert</a>(<a class="local col1 ref" href="#211instruction" title='instruction' data-ref="211instruction">instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction9unique_idEv" title='xla::HloInstruction::unique_id' data-ref="_ZNK3xla14HloInstruction9unique_idEv">unique_id</a>());</td></tr>
<tr><th id="1144">1144</th><td>      }</td></tr>
<tr><th id="1145">1145</th><td>    }</td></tr>
<tr><th id="1146">1146</th><td>  }</td></tr>
<tr><th id="1147">1147</th><td></td></tr>
<tr><th id="1148">1148</th><td>  <a class="macro" href="../../../core/lib/core/errors.h.html#69" title="do { const ::tensorflow::Status _status = (AddCopiesToResolveInterference(module)); if ((__builtin_expect(!_status.ok(), 0))) return _status; } while (0)" data-ref="_M/TF_RETURN_IF_ERROR">TF_RETURN_IF_ERROR</a>(<a class="tu ref" href="#_ZN3xla12_GLOBAL__N_130AddCopiesToResolveInterferenceEPNS_9HloModuleE" title='xla::(anonymous namespace)::AddCopiesToResolveInterference' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_130AddCopiesToResolveInterferenceEPNS_9HloModuleE">AddCopiesToResolveInterference</a>(<a class="local col7 ref" href="#207module" title='module' data-ref="207module">module</a>));</td></tr>
<tr><th id="1149">1149</th><td></td></tr>
<tr><th id="1150">1150</th><td>  <i>// Simplify the tuple structures introduced by the deep copies. This should be</i></td></tr>
<tr><th id="1151">1151</th><td><i>  // done before removing copies (RemoveUnnecessaryCopies) because tuple</i></td></tr>
<tr><th id="1152">1152</th><td><i>  // simplification changes dependencies in the graph which changes live range</i></td></tr>
<tr><th id="1153">1153</th><td><i>  // interference in the graph. Also run DCE to remove the dead Tuple/GTE</i></td></tr>
<tr><th id="1154">1154</th><td><i>  // instructions introduced by tuple simplification.</i></td></tr>
<tr><th id="1155">1155</th><td>  <a class="type" href="tuple_simplifier.h.html#xla::TupleSimplifier" title='xla::TupleSimplifier' data-ref="xla::TupleSimplifier">TupleSimplifier</a> <a class="ref fake" href="tuple_simplifier.h.html#_ZN3xla15TupleSimplifierC1Ev" title='xla::TupleSimplifier::TupleSimplifier' data-ref="_ZN3xla15TupleSimplifierC1Ev"></a><dfn class="local col2 decl" id="212tuple_simplifier" title='tuple_simplifier' data-type='xla::TupleSimplifier' data-ref="212tuple_simplifier">tuple_simplifier</dfn>;</td></tr>
<tr><th id="1156">1156</th><td>  <a class="type" href="hlo_dce.h.html#xla::HloDCE" title='xla::HloDCE' data-ref="xla::HloDCE">HloDCE</a> <a class="ref fake" href="hlo_dce.h.html#36" title='xla::HloDCE::HloDCE' data-ref="_ZN3xla6HloDCEC1Ev"></a><dfn class="local col3 decl" id="213dce" title='dce' data-type='xla::HloDCE' data-ref="213dce">dce</dfn>;</td></tr>
<tr><th id="1157">1157</th><td>  <a class="macro" href="../../../core/lib/core/errors.h.html#69" title="do { const ::tensorflow::Status _status = (tuple_simplifier.Run(module).status()); if ((__builtin_expect(!_status.ok(), 0))) return _status; } while (0)" data-ref="_M/TF_RETURN_IF_ERROR">TF_RETURN_IF_ERROR</a>(<a class="local col2 ref" href="#212tuple_simplifier" title='tuple_simplifier' data-ref="212tuple_simplifier">tuple_simplifier</a>.<a class="virtual ref" href="tuple_simplifier.h.html#_ZN3xla15TupleSimplifier3RunEPNS_9HloModuleE" title='xla::TupleSimplifier::Run' data-ref="_ZN3xla15TupleSimplifier3RunEPNS_9HloModuleE">Run</a>(<a class="local col7 ref" href="#207module" title='module' data-ref="207module">module</a>).<a class="ref" href="../statusor.h.html#_ZNO3xla8StatusOr6statusEv" title='xla::StatusOr::status' data-ref="_ZNO3xla8StatusOr6statusEv">status</a>());</td></tr>
<tr><th id="1158">1158</th><td>  <a class="macro" href="../../../core/lib/core/errors.h.html#69" title="do { const ::tensorflow::Status _status = (dce.Run(module).status()); if ((__builtin_expect(!_status.ok(), 0))) return _status; } while (0)" data-ref="_M/TF_RETURN_IF_ERROR">TF_RETURN_IF_ERROR</a>(<a class="local col3 ref" href="#213dce" title='dce' data-ref="213dce">dce</a>.<a class="virtual ref" href="hlo_dce.h.html#_ZN3xla6HloDCE3RunEPNS_9HloModuleE" title='xla::HloDCE::Run' data-ref="_ZN3xla6HloDCE3RunEPNS_9HloModuleE">Run</a>(<a class="local col7 ref" href="#207module" title='module' data-ref="207module">module</a>).<a class="ref" href="../statusor.h.html#_ZNO3xla8StatusOr6statusEv" title='xla::StatusOr::status' data-ref="_ZNO3xla8StatusOr6statusEv">status</a>());</td></tr>
<tr><th id="1159">1159</th><td></td></tr>
<tr><th id="1160">1160</th><td>  <a class="macro" href="../../../core/lib/core/status.h.html#142" title="while (false &amp;&amp; (::tensorflow::Status::OK() == (VerifyNoLiveRangeInterference(module)))) ::tensorflow::internal::LogMessageFatal(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 1160)" data-ref="_M/TF_DCHECK_OK">TF_DCHECK_OK</a>(<a class="tu ref" href="#_ZN3xla12_GLOBAL__N_129VerifyNoLiveRangeInterferenceEPNS_9HloModuleE" title='xla::(anonymous namespace)::VerifyNoLiveRangeInterference' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_129VerifyNoLiveRangeInterferenceEPNS_9HloModuleE">VerifyNoLiveRangeInterference</a>(<a class="local col7 ref" href="#207module" title='module' data-ref="207module">module</a>));</td></tr>
<tr><th id="1161">1161</th><td></td></tr>
<tr><th id="1162">1162</th><td>  <a class="tu ref" href="#_ZN3xla12_GLOBAL__N_115MaybeDumpModuleERKSsRKNS_9HloModuleE" title='xla::(anonymous namespace)::MaybeDumpModule' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_115MaybeDumpModuleERKSsRKNS_9HloModuleE">MaybeDumpModule</a>(<a class="ref fake" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZNSt12basic_stringC1EPKT_RKT1_" title='std::basic_string::basic_string&lt;_CharT, _Traits, _Alloc&gt;' data-ref="_ZNSt12basic_stringC1EPKT_RKT1_"></a><q>"after adding copies to resolve interference"</q>, *<a class="local col7 ref" href="#207module" title='module' data-ref="207module">module</a>);</td></tr>
<tr><th id="1163">1163</th><td></td></tr>
<tr><th id="1164">1164</th><td>  <a class="type" href="hlo_ordering.h.html#xla::DependencyHloOrdering" title='xla::DependencyHloOrdering' data-ref="xla::DependencyHloOrdering">DependencyHloOrdering</a> <dfn class="local col4 decl" id="214ordering" title='ordering' data-type='xla::DependencyHloOrdering' data-ref="214ordering">ordering</dfn><a class="ref" href="hlo_ordering.h.html#_ZN3xla21DependencyHloOrderingC1EPKNS_9HloModuleE" title='xla::DependencyHloOrdering::DependencyHloOrdering' data-ref="_ZN3xla21DependencyHloOrderingC1EPKNS_9HloModuleE">(</a><a class="local col7 ref" href="#207module" title='module' data-ref="207module">module</a>);</td></tr>
<tr><th id="1165">1165</th><td>  <a class="macro" href="../../../core/lib/core/errors.h.html#69" title="do { const ::tensorflow::Status _status = (RemoveUnnecessaryCopies(ordering, existing_copies, module)); if ((__builtin_expect(!_status.ok(), 0))) return _status; } while (0)" data-ref="_M/TF_RETURN_IF_ERROR">TF_RETURN_IF_ERROR</a>(</td></tr>
<tr><th id="1166">1166</th><td>      <a class="tu ref" href="#_ZN3xla12_GLOBAL__N_123RemoveUnnecessaryCopiesERKNS_11HloOrderingERKN10tensorflow3gtl7FlatSetIiNS4_4hashIiEESt8equal_toIiEEEPNS_9HloModuleE" title='xla::(anonymous namespace)::RemoveUnnecessaryCopies' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_123RemoveUnnecessaryCopiesERKNS_11HloOrderingERKN10tensorflow3gtl7FlatSetIiNS4_4hashIiEESt8equal_toIiEEEPNS_9HloModuleE">RemoveUnnecessaryCopies</a>(<a class="local col4 ref" href="#214ordering" title='ordering' data-ref="214ordering">ordering</a>, <a class="local col9 ref" href="#209existing_copies" title='existing_copies' data-ref="209existing_copies">existing_copies</a>, <a class="local col7 ref" href="#207module" title='module' data-ref="207module">module</a>));</td></tr>
<tr><th id="1167">1167</th><td></td></tr>
<tr><th id="1168">1168</th><td>  <a class="tu ref" href="#_ZN3xla12_GLOBAL__N_115MaybeDumpModuleERKSsRKNS_9HloModuleE" title='xla::(anonymous namespace)::MaybeDumpModule' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_115MaybeDumpModuleERKSsRKNS_9HloModuleE">MaybeDumpModule</a>(<a class="ref fake" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZNSt12basic_stringC1EPKT_RKT1_" title='std::basic_string::basic_string&lt;_CharT, _Traits, _Alloc&gt;' data-ref="_ZNSt12basic_stringC1EPKT_RKT1_"></a><q>"after removing unnecessary copies"</q>, *<a class="local col7 ref" href="#207module" title='module' data-ref="207module">module</a>);</td></tr>
<tr><th id="1169">1169</th><td></td></tr>
<tr><th id="1170">1170</th><td>  <a class="macro" href="../../../core/lib/core/errors.h.html#69" title="do { const ::tensorflow::Status _status = (AddSpecialCaseCopies(*call_graph, module)); if ((__builtin_expect(!_status.ok(), 0))) return _status; } while (0)" data-ref="_M/TF_RETURN_IF_ERROR">TF_RETURN_IF_ERROR</a>(<a class="tu ref" href="#_ZN3xla12_GLOBAL__N_120AddSpecialCaseCopiesERKNS_9CallGraphEPNS_9HloModuleE" title='xla::(anonymous namespace)::AddSpecialCaseCopies' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_120AddSpecialCaseCopiesERKNS_9CallGraphEPNS_9HloModuleE">AddSpecialCaseCopies</a>(<a class="ref" href="../../../../../include/c++/5/bits/unique_ptr.h.html#_ZNKSt10unique_ptrdeEv" title='std::unique_ptr::operator*' data-ref="_ZNKSt10unique_ptrdeEv">*</a><a class="local col8 ref" href="#208call_graph" title='call_graph' data-ref="208call_graph">call_graph</a>, <a class="local col7 ref" href="#207module" title='module' data-ref="207module">module</a>));</td></tr>
<tr><th id="1171">1171</th><td></td></tr>
<tr><th id="1172">1172</th><td>  <a class="tu ref" href="#_ZN3xla12_GLOBAL__N_115MaybeDumpModuleERKSsRKNS_9HloModuleE" title='xla::(anonymous namespace)::MaybeDumpModule' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_115MaybeDumpModuleERKSsRKNS_9HloModuleE">MaybeDumpModule</a>(<a class="ref fake" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZNSt12basic_stringC1EPKT_RKT1_" title='std::basic_string::basic_string&lt;_CharT, _Traits, _Alloc&gt;' data-ref="_ZNSt12basic_stringC1EPKT_RKT1_"></a><q>"after adding special-case copies"</q>, *<a class="local col7 ref" href="#207module" title='module' data-ref="207module">module</a>);</td></tr>
<tr><th id="1173">1173</th><td></td></tr>
<tr><th id="1174">1174</th><td>  <a class="macro" href="../../../core/lib/core/errors.h.html#69" title="do { const ::tensorflow::Status _status = (tuple_simplifier.Run(module).status()); if ((__builtin_expect(!_status.ok(), 0))) return _status; } while (0)" data-ref="_M/TF_RETURN_IF_ERROR">TF_RETURN_IF_ERROR</a>(<a class="local col2 ref" href="#212tuple_simplifier" title='tuple_simplifier' data-ref="212tuple_simplifier">tuple_simplifier</a>.<a class="virtual ref" href="tuple_simplifier.h.html#_ZN3xla15TupleSimplifier3RunEPNS_9HloModuleE" title='xla::TupleSimplifier::Run' data-ref="_ZN3xla15TupleSimplifier3RunEPNS_9HloModuleE">Run</a>(<a class="local col7 ref" href="#207module" title='module' data-ref="207module">module</a>).<a class="ref" href="../statusor.h.html#_ZNO3xla8StatusOr6statusEv" title='xla::StatusOr::status' data-ref="_ZNO3xla8StatusOr6statusEv">status</a>());</td></tr>
<tr><th id="1175">1175</th><td>  <a class="macro" href="../../../core/lib/core/errors.h.html#69" title="do { const ::tensorflow::Status _status = (dce.Run(module).status()); if ((__builtin_expect(!_status.ok(), 0))) return _status; } while (0)" data-ref="_M/TF_RETURN_IF_ERROR">TF_RETURN_IF_ERROR</a>(<a class="local col3 ref" href="#213dce" title='dce' data-ref="213dce">dce</a>.<a class="virtual ref" href="hlo_dce.h.html#_ZN3xla6HloDCE3RunEPNS_9HloModuleE" title='xla::HloDCE::Run' data-ref="_ZN3xla6HloDCE3RunEPNS_9HloModuleE">Run</a>(<a class="local col7 ref" href="#207module" title='module' data-ref="207module">module</a>).<a class="ref" href="../statusor.h.html#_ZNO3xla8StatusOr6statusEv" title='xla::StatusOr::status' data-ref="_ZNO3xla8StatusOr6statusEv">status</a>());</td></tr>
<tr><th id="1176">1176</th><td>  <a class="macro" href="../../../core/lib/core/status.h.html#142" title="while (false &amp;&amp; (::tensorflow::Status::OK() == (VerifyNoLiveRangeInterference(module)))) ::tensorflow::internal::LogMessageFatal(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 1176)" data-ref="_M/TF_DCHECK_OK">TF_DCHECK_OK</a>(<a class="tu ref" href="#_ZN3xla12_GLOBAL__N_129VerifyNoLiveRangeInterferenceEPNS_9HloModuleE" title='xla::(anonymous namespace)::VerifyNoLiveRangeInterference' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_129VerifyNoLiveRangeInterferenceEPNS_9HloModuleE">VerifyNoLiveRangeInterference</a>(<a class="local col7 ref" href="#207module" title='module' data-ref="207module">module</a>));</td></tr>
<tr><th id="1177">1177</th><td></td></tr>
<tr><th id="1178">1178</th><td>  <a class="tu ref" href="#_ZN3xla12_GLOBAL__N_115MaybeDumpModuleERKSsRKNS_9HloModuleE" title='xla::(anonymous namespace)::MaybeDumpModule' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_115MaybeDumpModuleERKSsRKNS_9HloModuleE">MaybeDumpModule</a>(<a class="ref fake" href="../../../../../include/c++/5/bits/basic_string.h.html#_ZNSt12basic_stringC1EPKT_RKT1_" title='std::basic_string::basic_string&lt;_CharT, _Traits, _Alloc&gt;' data-ref="_ZNSt12basic_stringC1EPKT_RKT1_"></a><q>"after copy insertion"</q>, *<a class="local col7 ref" href="#207module" title='module' data-ref="207module">module</a>);</td></tr>
<tr><th id="1179">1179</th><td></td></tr>
<tr><th id="1180">1180</th><td>  <b>if</b> (<a class="macro" href="../../../core/platform/default/logging.h.html#85" title="((1) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel())" data-ref="_M/VLOG_IS_ON">VLOG_IS_ON</a>(<var>1</var>)) {</td></tr>
<tr><th id="1181">1181</th><td>    <a class="typedef" href="../../../core/platform/default/integral_types.h.html#tensorflow::int64" title='tensorflow::int64' data-type='long long' data-ref="tensorflow::int64">int64</a> <dfn class="local col5 decl" id="215num_total_copies" title='num_total_copies' data-type='int64' data-ref="215num_total_copies">num_total_copies</dfn> = <var>0</var>;</td></tr>
<tr><th id="1182">1182</th><td>    <b>for</b> (<a class="type" href="hlo_computation.h.html#xla::HloComputation" title='xla::HloComputation' data-ref="xla::HloComputation">HloComputation</a>* <dfn class="local col6 decl" id="216computation" title='computation' data-type='xla::HloComputation *' data-ref="216computation">computation</dfn> : <a class="local col7 ref" href="#207module" title='module' data-ref="207module">module</a>-&gt;<a class="ref" href="hlo_module.h.html#_ZN3xla9HloModule12computationsEv" title='xla::HloModule::computations' data-ref="_ZN3xla9HloModule12computationsEv">computations</a>()) {</td></tr>
<tr><th id="1183">1183</th><td>      <b>for</b> (<a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col7 decl" id="217instruction" title='instruction' data-type='xla::HloInstruction *' data-ref="217instruction">instruction</dfn> : <a class="local col6 ref" href="#216computation" title='computation' data-ref="216computation">computation</a>-&gt;<a class="ref" href="hlo_computation.h.html#_ZN3xla14HloComputation12instructionsEv" title='xla::HloComputation::instructions' data-ref="_ZN3xla14HloComputation12instructionsEv">instructions</a>()) {</td></tr>
<tr><th id="1184">1184</th><td>        <b>if</b> (<a class="local col7 ref" href="#217instruction" title='instruction' data-ref="217instruction">instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction6opcodeEv" title='xla::HloInstruction::opcode' data-ref="_ZNK3xla14HloInstruction6opcodeEv">opcode</a>() == <a class="type" href="hlo_opcode.h.html#xla::HloOpcode" title='xla::HloOpcode' data-ref="xla::HloOpcode">HloOpcode</a>::<a class="enum" href="hlo_opcode.h.html#135" title='xla::HloOpcode::kCopy' data-ref="xla::HloOpcode::kCopy">kCopy</a>) {</td></tr>
<tr><th id="1185">1185</th><td>          <a class="local col5 ref" href="#215num_total_copies" title='num_total_copies' data-ref="215num_total_copies">num_total_copies</a>++;</td></tr>
<tr><th id="1186">1186</th><td>        }</td></tr>
<tr><th id="1187">1187</th><td>      }</td></tr>
<tr><th id="1188">1188</th><td>    }</td></tr>
<tr><th id="1189">1189</th><td>    <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((1) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 1189, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>1</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <q>"Num copies before copy-insertion: "</q> <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZNSt13basic_ostreamlsEm" title='std::basic_ostream::operator&lt;&lt;' data-ref="_ZNSt13basic_ostreamlsEm">&lt;&lt;</a> <a class="local col9 ref" href="#209existing_copies" title='existing_copies' data-ref="209existing_copies">existing_copies</a>.<a class="ref" href="../../../core/lib/gtl/flatset.h.html#_ZNK10tensorflow3gtl7FlatSet4sizeEv" title='tensorflow::gtl::FlatSet::size' data-ref="_ZNK10tensorflow3gtl7FlatSet4sizeEv">size</a>();</td></tr>
<tr><th id="1190">1190</th><td>    <a class="macro" href="../../../core/platform/default/logging.h.html#89" title="if ((__builtin_expect(((1) &lt;= ::tensorflow::internal::LogMessage::MinVLogLevel()), 0))) ::tensorflow::internal::LogMessage(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 1190, tensorflow::INFO)" data-ref="_M/VLOG">VLOG</a>(<var>1</var>) <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZStlsOSt13basic_ostreamIT_T0_ERKT1_" title='std::operator&lt;&lt;' data-ref="_ZStlsOSt13basic_ostreamIT_T0_ERKT1_">&lt;&lt;</a> <q>"Num copies after copy-insertion: "</q> <a class="ref" href="../../../../../include/c++/5/ostream.html#_ZNSt13basic_ostreamlsEx" title='std::basic_ostream::operator&lt;&lt;' data-ref="_ZNSt13basic_ostreamlsEx">&lt;&lt;</a> <a class="local col5 ref" href="#215num_total_copies" title='num_total_copies' data-ref="215num_total_copies">num_total_copies</a>;</td></tr>
<tr><th id="1191">1191</th><td>  }</td></tr>
<tr><th id="1192">1192</th><td></td></tr>
<tr><th id="1193">1193</th><td>  <b>return</b> <a class="ref fake" href="../statusor.h.html#_ZN3xla8StatusOrC1EOT_" title='xla::StatusOr::StatusOr&lt;T&gt;' data-ref="_ZN3xla8StatusOrC1EOT_"></a><b>true</b>;</td></tr>
<tr><th id="1194">1194</th><td>}</td></tr>
<tr><th id="1195">1195</th><td></td></tr>
<tr><th id="1196">1196</th><td><b>namespace</b> {</td></tr>
<tr><th id="1197">1197</th><td></td></tr>
<tr><th id="1198">1198</th><td><em>bool</em> <dfn class="tu decl def" id="_ZN3xla12_GLOBAL__N_111IsWhileBodyEPKNS_14HloComputationERKNS_9CallGraphE" title='xla::(anonymous namespace)::IsWhileBody' data-type='bool xla::(anonymous namespace)::IsWhileBody(const xla::HloComputation * computation, const xla::CallGraph &amp; call_graph)' data-ref="_ZN3xla12_GLOBAL__N_111IsWhileBodyEPKNS_14HloComputationERKNS_9CallGraphE">IsWhileBody</dfn>(<em>const</em> <a class="type" href="hlo_computation.h.html#xla::HloComputation" title='xla::HloComputation' data-ref="xla::HloComputation">HloComputation</a>* <dfn class="local col8 decl" id="218computation" title='computation' data-type='const xla::HloComputation *' data-ref="218computation">computation</dfn>,</td></tr>
<tr><th id="1199">1199</th><td>                 <em>const</em> <a class="type" href="call_graph.h.html#xla::CallGraph" title='xla::CallGraph' data-ref="xla::CallGraph">CallGraph</a>&amp; <dfn class="local col9 decl" id="219call_graph" title='call_graph' data-type='const xla::CallGraph &amp;' data-ref="219call_graph">call_graph</dfn>) {</td></tr>
<tr><th id="1200">1200</th><td>  <em>const</em> <a class="type" href="call_graph.h.html#xla::CallGraphNode" title='xla::CallGraphNode' data-ref="xla::CallGraphNode">CallGraphNode</a>&amp; <dfn class="local col0 decl" id="220node" title='node' data-type='const xla::CallGraphNode &amp;' data-ref="220node">node</dfn> = <a class="local col9 ref" href="#219call_graph" title='call_graph' data-ref="219call_graph">call_graph</a>.<a class="ref" href="call_graph.h.html#_ZNK3xla9CallGraph7GetNodeEPKNS_14HloComputationE" title='xla::CallGraph::GetNode' data-ref="_ZNK3xla9CallGraph7GetNodeEPKNS_14HloComputationE">GetNode</a>(<a class="local col8 ref" href="#218computation" title='computation' data-ref="218computation">computation</a>);</td></tr>
<tr><th id="1201">1201</th><td></td></tr>
<tr><th id="1202">1202</th><td>  <b>if</b> (<a class="local col0 ref" href="#220node" title='node' data-ref="220node">node</a>.<a class="ref" href="call_graph.h.html#_ZNK3xla13CallGraphNode7contextEv" title='xla::CallGraphNode::context' data-ref="_ZNK3xla13CallGraphNode7contextEv">context</a>() == <a class="type" href="call_graph.h.html#xla::CallContext" title='xla::CallContext' data-ref="xla::CallContext">CallContext</a>::<a class="enum" href="call_graph.h.html#xla::CallContext::kSequential" title='xla::CallContext::kSequential' data-ref="xla::CallContext::kSequential">kSequential</a> &amp;&amp;</td></tr>
<tr><th id="1203">1203</th><td>      !<a class="local col0 ref" href="#220node" title='node' data-ref="220node">node</a>.<a class="ref" href="call_graph.h.html#_ZNK3xla13CallGraphNode16caller_callsitesEv" title='xla::CallGraphNode::caller_callsites' data-ref="_ZNK3xla13CallGraphNode16caller_callsitesEv">caller_callsites</a>().<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNKSt6vector5emptyEv" title='std::vector::empty' data-ref="_ZNKSt6vector5emptyEv">empty</a>()) {</td></tr>
<tr><th id="1204">1204</th><td>    <i>// Callgraph should be flattened so sequential context computations can</i></td></tr>
<tr><th id="1205">1205</th><td><i>    // have at most one caller.</i></td></tr>
<tr><th id="1206">1206</th><td>    <a class="macro" href="../../../core/platform/default/logging.h.html#251" title="while (::tensorflow::internal::CheckOpString _result = ::tensorflow::internal::Check_EQImpl( ::tensorflow::internal::GetReferenceableValue(node.caller_callsites().size()), ::tensorflow::internal::GetReferenceableValue(1), &quot;node.caller_callsites().size()&quot; &quot; &quot; &quot;==&quot; &quot; &quot; &quot;1&quot;)) ::tensorflow::internal::LogMessageFatal(&quot;/root/.cache/bazel/_bazel_root/68a62076e91007a7908bc42a32e4cff9/execroot/org_tensorflow/tensorflow/compiler/xla/service/copy_insertion.cc&quot;, 1206) &lt;&lt; *(_result.str_)" data-ref="_M/CHECK_EQ">CHECK_EQ</a>(<a class="local col0 ref" href="#220node" title='node' data-ref="220node">node</a>.<a class="ref" href="call_graph.h.html#_ZNK3xla13CallGraphNode16caller_callsitesEv" title='xla::CallGraphNode::caller_callsites' data-ref="_ZNK3xla13CallGraphNode16caller_callsitesEv">caller_callsites</a>().<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNKSt6vector4sizeEv" title='std::vector::size' data-ref="_ZNKSt6vector4sizeEv">size</a>(), <var>1</var>);</td></tr>
<tr><th id="1207">1207</th><td>    <em>const</em> <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col1 decl" id="221calling_instruction" title='calling_instruction' data-type='const xla::HloInstruction *' data-ref="221calling_instruction">calling_instruction</dfn> =</td></tr>
<tr><th id="1208">1208</th><td>        <a class="local col0 ref" href="#220node" title='node' data-ref="220node">node</a>.<a class="ref" href="call_graph.h.html#_ZNK3xla13CallGraphNode16caller_callsitesEv" title='xla::CallGraphNode::caller_callsites' data-ref="_ZNK3xla13CallGraphNode16caller_callsitesEv">caller_callsites</a>()<a class="ref" href="../../../../../include/c++/5/bits/stl_vector.h.html#_ZNKSt6vectorixEm" title='std::vector::operator[]' data-ref="_ZNKSt6vectorixEm">[<var>0</var>]</a>.<a class="ref" href="call_graph.h.html#_ZNK3xla8CallSite11instructionEv" title='xla::CallSite::instruction' data-ref="_ZNK3xla8CallSite11instructionEv">instruction</a>();</td></tr>
<tr><th id="1209">1209</th><td>    <b>if</b> (<a class="local col1 ref" href="#221calling_instruction" title='calling_instruction' data-ref="221calling_instruction">calling_instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction6opcodeEv" title='xla::HloInstruction::opcode' data-ref="_ZNK3xla14HloInstruction6opcodeEv">opcode</a>() == <a class="type" href="hlo_opcode.h.html#xla::HloOpcode" title='xla::HloOpcode' data-ref="xla::HloOpcode">HloOpcode</a>::<a class="enum" href="hlo_opcode.h.html#135" title='xla::HloOpcode::kWhile' data-ref="xla::HloOpcode::kWhile">kWhile</a> &amp;&amp;</td></tr>
<tr><th id="1210">1210</th><td>        <a class="local col1 ref" href="#221calling_instruction" title='calling_instruction' data-ref="221calling_instruction">calling_instruction</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction10while_bodyEv" title='xla::HloInstruction::while_body' data-ref="_ZNK3xla14HloInstruction10while_bodyEv">while_body</a>() == <a class="local col0 ref" href="#220node" title='node' data-ref="220node">node</a>.<a class="ref" href="call_graph.h.html#_ZNK3xla13CallGraphNode11computationEv" title='xla::CallGraphNode::computation' data-ref="_ZNK3xla13CallGraphNode11computationEv">computation</a>()) {</td></tr>
<tr><th id="1211">1211</th><td>      <b>return</b> <b>true</b>;</td></tr>
<tr><th id="1212">1212</th><td>    }</td></tr>
<tr><th id="1213">1213</th><td>  }</td></tr>
<tr><th id="1214">1214</th><td>  <b>return</b> <b>false</b>;</td></tr>
<tr><th id="1215">1215</th><td>}</td></tr>
<tr><th id="1216">1216</th><td></td></tr>
<tr><th id="1217">1217</th><td>}  <i>// namespace</i></td></tr>
<tr><th id="1218">1218</th><td></td></tr>
<tr><th id="1219">1219</th><td><i>/* static */</i> <a class="type" href="../statusor.h.html#xla::StatusOr" title='xla::StatusOr' data-ref="xla::StatusOr">StatusOr</a>&lt;<em>bool</em>&gt; <a class="type" href="copy_insertion.h.html#xla::CopyInsertion" title='xla::CopyInsertion' data-ref="xla::CopyInsertion">CopyInsertion</a>::<dfn class="decl def" id="_ZN3xla13CopyInsertion28AddCopiesForBufferAssignmentEPNS_9HloModuleE" title='xla::CopyInsertion::AddCopiesForBufferAssignment' data-ref="_ZN3xla13CopyInsertion28AddCopiesForBufferAssignmentEPNS_9HloModuleE">AddCopiesForBufferAssignment</dfn>(</td></tr>
<tr><th id="1220">1220</th><td>    <a class="type" href="hlo_module.h.html#xla::HloModule" title='xla::HloModule' data-ref="xla::HloModule">HloModule</a>* <dfn class="local col2 decl" id="222module" title='module' data-type='xla::HloModule *' data-ref="222module">module</dfn>) {</td></tr>
<tr><th id="1221">1221</th><td>  <span class="namespace">std::</span><a class="type" href="../../../../../include/c++/5/bits/unique_ptr.h.html#std::unique_ptr" title='std::unique_ptr' data-ref="std::unique_ptr">unique_ptr</a>&lt;<a class="type" href="call_graph.h.html#xla::CallGraph" title='xla::CallGraph' data-ref="xla::CallGraph">CallGraph</a>&gt; <dfn class="local col3 decl" id="223call_graph" title='call_graph' data-type='std::unique_ptr&lt;CallGraph&gt;' data-ref="223call_graph">call_graph</dfn> = <a class="type" href="call_graph.h.html#xla::CallGraph" title='xla::CallGraph' data-ref="xla::CallGraph">CallGraph</a>::<a class="ref" href="call_graph.h.html#_ZN3xla9CallGraph5BuildEPKNS_9HloModuleE" title='xla::CallGraph::Build' data-ref="_ZN3xla9CallGraph5BuildEPKNS_9HloModuleE">Build</a>(<a class="local col2 ref" href="#222module" title='module' data-ref="222module">module</a>);</td></tr>
<tr><th id="1222">1222</th><td>  <a class="macro" href="../status_macros.h.html#199" title="auto _status_or_value21 = (HloDataflowAnalysis::Run(*module)); if ((__builtin_expect(!_status_or_value21.ok(), 0))) { return _status_or_value21.status(); } std::unique_ptr&lt;HloDataflowAnalysis&gt; dataflow = std::move(_status_or_value21.ValueOrDie())" data-ref="_M/TF_ASSIGN_OR_RETURN">TF_ASSIGN_OR_RETURN</a>(std::<a class="type" href="../../../../../include/c++/5/bits/unique_ptr.h.html#std::unique_ptr" title='std::unique_ptr' data-ref="std::unique_ptr">unique_ptr</a>&lt;<a class="type" href="hlo_dataflow_analysis.h.html#xla::HloDataflowAnalysis" title='xla::HloDataflowAnalysis' data-ref="xla::HloDataflowAnalysis">HloDataflowAnalysis</a>&gt; <dfn class="local col4 decl" id="224dataflow" title='dataflow' data-type='std::unique_ptr&lt;HloDataflowAnalysis&gt;' data-ref="224dataflow">dataflow</dfn>,</td></tr>
<tr><th id="1223">1223</th><td>                      <a class="type" href="hlo_dataflow_analysis.h.html#xla::HloDataflowAnalysis" title='xla::HloDataflowAnalysis' data-ref="xla::HloDataflowAnalysis">HloDataflowAnalysis</a>::<a class="ref" href="hlo_dataflow_analysis.h.html#_ZN3xla19HloDataflowAnalysis3RunERKNS_9HloModuleEbb" title='xla::HloDataflowAnalysis::Run' data-ref="_ZN3xla19HloDataflowAnalysis3RunERKNS_9HloModuleEbb">Run</a>(*<a class="local col2 ref" href="#222module" title='module' data-ref="222module">module</a>));</td></tr>
<tr><th id="1224">1224</th><td></td></tr>
<tr><th id="1225">1225</th><td>  <em>bool</em> <dfn class="local col5 decl" id="225changed" title='changed' data-type='bool' data-ref="225changed">changed</dfn> = <b>false</b>;</td></tr>
<tr><th id="1226">1226</th><td></td></tr>
<tr><th id="1227">1227</th><td>  <i>// If a buffer live out of a computation is a constant, a parameter, or not</i></td></tr>
<tr><th id="1228">1228</th><td><i>  // defined in the computation, then copy it to account for the limited</i></td></tr>
<tr><th id="1229">1229</th><td><i>  // computation-scoped analysis in buffer assignment. An exception to this rule</i></td></tr>
<tr><th id="1230">1230</th><td><i>  // is the while body which is handled properly without copies.</i></td></tr>
<tr><th id="1231">1231</th><td>  <b>for</b> (<a class="type" href="hlo_computation.h.html#xla::HloComputation" title='xla::HloComputation' data-ref="xla::HloComputation">HloComputation</a>* <dfn class="local col6 decl" id="226computation" title='computation' data-type='xla::HloComputation *' data-ref="226computation">computation</dfn> : <a class="local col2 ref" href="#222module" title='module' data-ref="222module">module</a>-&gt;<a class="ref" href="hlo_module.h.html#_ZN3xla9HloModule12computationsEv" title='xla::HloModule::computations' data-ref="_ZN3xla9HloModule12computationsEv">computations</a>()) {</td></tr>
<tr><th id="1232">1232</th><td>    <b>if</b> (<a class="local col6 ref" href="#226computation" title='computation' data-ref="226computation">computation</a> == <a class="local col2 ref" href="#222module" title='module' data-ref="222module">module</a>-&gt;<a class="ref" href="hlo_module.h.html#_ZN3xla9HloModule17entry_computationEv" title='xla::HloModule::entry_computation' data-ref="_ZN3xla9HloModule17entry_computationEv">entry_computation</a>() ||</td></tr>
<tr><th id="1233">1233</th><td>        <a class="tu ref" href="#_ZN3xla12_GLOBAL__N_111IsWhileBodyEPKNS_14HloComputationERKNS_9CallGraphE" title='xla::(anonymous namespace)::IsWhileBody' data-use='c' data-ref="_ZN3xla12_GLOBAL__N_111IsWhileBodyEPKNS_14HloComputationERKNS_9CallGraphE">IsWhileBody</a>(<a class="local col6 ref" href="#226computation" title='computation' data-ref="226computation">computation</a>, <a class="ref" href="../../../../../include/c++/5/bits/unique_ptr.h.html#_ZNKSt10unique_ptrdeEv" title='std::unique_ptr::operator*' data-ref="_ZNKSt10unique_ptrdeEv">*</a><a class="local col3 ref" href="#223call_graph" title='call_graph' data-ref="223call_graph">call_graph</a>)) {</td></tr>
<tr><th id="1234">1234</th><td>      <b>continue</b>;</td></tr>
<tr><th id="1235">1235</th><td>    }</td></tr>
<tr><th id="1236">1236</th><td></td></tr>
<tr><th id="1237">1237</th><td>    <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col7 decl" id="227root" title='root' data-type='xla::HloInstruction *' data-ref="227root">root</dfn> = <a class="local col6 ref" href="#226computation" title='computation' data-ref="226computation">computation</a>-&gt;<a class="ref" href="hlo_computation.h.html#_ZNK3xla14HloComputation16root_instructionEv" title='xla::HloComputation::root_instruction' data-ref="_ZNK3xla14HloComputation16root_instructionEv">root_instruction</a>();</td></tr>
<tr><th id="1238">1238</th><td>    <a class="type" href="../shape_tree.h.html#xla::ShapeTree" title='xla::ShapeTree' data-ref="xla::ShapeTree">ShapeTree</a>&lt;<em>bool</em>&gt; <dfn class="local col8 decl" id="228indices_to_copy" title='indices_to_copy' data-type='ShapeTree&lt;bool&gt;' data-ref="228indices_to_copy">indices_to_copy</dfn><a class="ref" href="../shape_tree.h.html#_ZN3xla9ShapeTreeC1ENS_5ShapeERKT_" title='xla::ShapeTree::ShapeTree&lt;T&gt;' data-ref="_ZN3xla9ShapeTreeC1ENS_5ShapeERKT_">(</a><span class='ref fake' title='xla::Shape::Shape' data-ref="_ZN3xla5ShapeC1ERKS0_"></span><a class="local col7 ref" href="#227root" title='root' data-ref="227root">root</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction5shapeEv" title='xla::HloInstruction::shape' data-ref="_ZNK3xla14HloInstruction5shapeEv">shape</a>(), <i>/*init_value=*/</i><b>false</b>);</td></tr>
<tr><th id="1239">1239</th><td>    <em>bool</em> <dfn class="local col9 decl" id="229copy_root" title='copy_root' data-type='bool' data-ref="229copy_root">copy_root</dfn> = <b>false</b>;</td></tr>
<tr><th id="1240">1240</th><td>    <b>for</b> (<em>const</em> <em>auto</em>&amp; <dfn class="local col0 decl" id="230pair" title='pair' data-type='const std::pair&lt;xla::ShapeIndex, xla::HloValueSet &amp;&gt; &amp;' data-ref="230pair">pair</dfn> : <a class="local col4 ref" href="#1222" title='dataflow' data-ref="224dataflow">dataflow</a><a class="ref" href="../../../../../include/c++/5/bits/unique_ptr.h.html#_ZNKSt10unique_ptrptEv" title='std::unique_ptr::operator-&gt;' data-ref="_ZNKSt10unique_ptrptEv">-&gt;</a><a class="ref" href="hlo_dataflow_analysis.h.html#_ZN3xla19HloDataflowAnalysis22GetInstructionValueSetEPKNS_14HloInstructionE" title='xla::HloDataflowAnalysis::GetInstructionValueSet' data-ref="_ZN3xla19HloDataflowAnalysis22GetInstructionValueSetEPKNS_14HloInstructionE">GetInstructionValueSet</a>(<a class="local col7 ref" href="#227root" title='root' data-ref="227root">root</a>)) {</td></tr>
<tr><th id="1241">1241</th><td>      <em>const</em> <a class="type" href="../shape_util.h.html#xla::ShapeIndex" title='xla::ShapeIndex' data-ref="xla::ShapeIndex">ShapeIndex</a>&amp; <dfn class="local col1 decl" id="231index" title='index' data-type='const xla::ShapeIndex &amp;' data-ref="231index">index</dfn> = <a class="local col0 ref" href="#230pair" title='pair' data-ref="230pair">pair</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_pair.h.html#std::pair::first" title='std::pair&lt;xla::ShapeIndex, xla::HloValueSet &amp;&gt;::first' data-ref="std::pair::first">first</a>;</td></tr>
<tr><th id="1242">1242</th><td>      <em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValueSet" title='xla::HloValueSet' data-ref="xla::HloValueSet">HloValueSet</a>&amp; <dfn class="local col2 decl" id="232value_set" title='value_set' data-type='const xla::HloValueSet &amp;' data-ref="232value_set">value_set</dfn> = <a class="local col0 ref" href="#230pair" title='pair' data-ref="230pair">pair</a>.<a class="ref" href="../../../../../include/c++/5/bits/stl_pair.h.html#std::pair::second" title='std::pair&lt;xla::ShapeIndex, xla::HloValueSet &amp;&gt;::second' data-ref="std::pair::second">second</a>;</td></tr>
<tr><th id="1243">1243</th><td>      <b>for</b> (<em>const</em> <a class="type" href="hlo_value.h.html#xla::HloValue" title='xla::HloValue' data-ref="xla::HloValue">HloValue</a>* <dfn class="local col3 decl" id="233value" title='value' data-type='const xla::HloValue *' data-ref="233value">value</dfn> : <a class="local col2 ref" href="#232value_set" title='value_set' data-ref="232value_set">value_set</a>.<a class="ref" href="hlo_value.h.html#_ZNK3xla11HloValueSet6valuesEv" title='xla::HloValueSet::values' data-ref="_ZNK3xla11HloValueSet6valuesEv">values</a>()) {</td></tr>
<tr><th id="1244">1244</th><td>        <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a>* <dfn class="local col4 decl" id="234def" title='def' data-type='xla::HloInstruction *' data-ref="234def">def</dfn> = <a class="local col3 ref" href="#233value" title='value' data-ref="233value">value</a>-&gt;<a class="ref" href="hlo_value.h.html#_ZNK3xla8HloValue20defining_instructionEv" title='xla::HloValue::defining_instruction' data-ref="_ZNK3xla8HloValue20defining_instructionEv">defining_instruction</a>();</td></tr>
<tr><th id="1245">1245</th><td>        <b>if</b> (<a class="local col4 ref" href="#234def" title='def' data-ref="234def">def</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZN3xla14HloInstruction6parentEv" title='xla::HloInstruction::parent' data-ref="_ZN3xla14HloInstruction6parentEv">parent</a>() != <a class="local col6 ref" href="#226computation" title='computation' data-ref="226computation">computation</a> ||</td></tr>
<tr><th id="1246">1246</th><td>            <a class="local col4 ref" href="#234def" title='def' data-ref="234def">def</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction6opcodeEv" title='xla::HloInstruction::opcode' data-ref="_ZNK3xla14HloInstruction6opcodeEv">opcode</a>() == <a class="type" href="hlo_opcode.h.html#xla::HloOpcode" title='xla::HloOpcode' data-ref="xla::HloOpcode">HloOpcode</a>::<a class="enum" href="hlo_opcode.h.html#135" title='xla::HloOpcode::kConstant' data-ref="xla::HloOpcode::kConstant">kConstant</a> ||</td></tr>
<tr><th id="1247">1247</th><td>            <a class="local col4 ref" href="#234def" title='def' data-ref="234def">def</a>-&gt;<a class="ref" href="hlo_instruction.h.html#_ZNK3xla14HloInstruction6opcodeEv" title='xla::HloInstruction::opcode' data-ref="_ZNK3xla14HloInstruction6opcodeEv">opcode</a>() == <a class="type" href="hlo_opcode.h.html#xla::HloOpcode" title='xla::HloOpcode' data-ref="xla::HloOpcode">HloOpcode</a>::<a class="enum" href="hlo_opcode.h.html#135" title='xla::HloOpcode::kParameter' data-ref="xla::HloOpcode::kParameter">kParameter</a>) {</td></tr>
<tr><th id="1248">1248</th><td>          *<a class="local col8 ref" href="#228indices_to_copy" title='indices_to_copy' data-ref="228indices_to_copy">indices_to_copy</a>.<a class="ref" href="../shape_tree.h.html#_ZN3xla9ShapeTree15mutable_elementERKNS_10ShapeIndexE" title='xla::ShapeTree::mutable_element' data-ref="_ZN3xla9ShapeTree15mutable_elementERKNS_10ShapeIndexE">mutable_element</a>(<a class="local col1 ref" href="#231index" title='index' data-ref="231index">index</a>) = <b>true</b>;</td></tr>
<tr><th id="1249">1249</th><td>          <a class="local col9 ref" href="#229copy_root" title='copy_root' data-ref="229copy_root">copy_root</a> = <b>true</b>;</td></tr>
<tr><th id="1250">1250</th><td>        }</td></tr>
<tr><th id="1251">1251</th><td>      }</td></tr>
<tr><th id="1252">1252</th><td>    }</td></tr>
<tr><th id="1253">1253</th><td>    <b>if</b> (<a class="local col9 ref" href="#229copy_root" title='copy_root' data-ref="229copy_root">copy_root</a>) {</td></tr>
<tr><th id="1254">1254</th><td>      <a class="macro" href="../status_macros.h.html#199" title="auto _status_or_value23 = (computation-&gt;DeepCopyInstruction(root, &amp;indices_to_copy)); if ((__builtin_expect(!_status_or_value23.ok(), 0))) { return _status_or_value23.status(); } HloInstruction * root_copy = std::move(_status_or_value23.ValueOrDie())" data-ref="_M/TF_ASSIGN_OR_RETURN">TF_ASSIGN_OR_RETURN</a>(</td></tr>
<tr><th id="1255">1255</th><td>          <a class="type" href="hlo_instruction.h.html#xla::HloInstruction" title='xla::HloInstruction' data-ref="xla::HloInstruction">HloInstruction</a> * <dfn class="local col5 decl" id="235root_copy" title='root_copy' data-type='xla::HloInstruction *' data-ref="235root_copy">root_copy</dfn>,</td></tr>
<tr><th id="1256">1256</th><td>          <a class="local col6 ref" href="#226computation" title='computation' data-ref="226computation">computation</a>-&gt;<a class="ref" href="hlo_computation.h.html#_ZN3xla14HloComputation19DeepCopyInstructionEPNS_14HloInstructionEPKNS_9ShapeTreeIbEEPNS3_IS2_EE" title='xla::HloComputation::DeepCopyInstruction' data-ref="_ZN3xla14HloComputation19DeepCopyInstructionEPNS_14HloInstructionEPKNS_9ShapeTreeIbEEPNS3_IS2_EE">DeepCopyInstruction</a>(<a class="local col7 ref" href="#227root" title='root' data-ref="227root">root</a>, &amp;<a class="local col8 ref" href="#228indices_to_copy" title='indices_to_copy' data-ref="228indices_to_copy">indices_to_copy</a>));</td></tr>
<tr><th id="1257">1257</th><td>      <a class="local col6 ref" href="#226computation" title='computation' data-ref="226computation">computation</a>-&gt;<a class="ref" href="hlo_computation.h.html#_ZN3xla14HloComputation20set_root_instructionEPNS_14HloInstructionE" title='xla::HloComputation::set_root_instruction' data-ref="_ZN3xla14HloComputation20set_root_instructionEPNS_14HloInstructionE">set_root_instruction</a>(<a class="local col5 ref" href="#1254" title='root_copy' data-ref="235root_copy">root_copy</a>);</td></tr>
<tr><th id="1258">1258</th><td>      <a class="local col5 ref" href="#225changed" title='changed' data-ref="225changed">changed</a> = <b>true</b>;</td></tr>
<tr><th id="1259">1259</th><td>    }</td></tr>
<tr><th id="1260">1260</th><td>  }</td></tr>
<tr><th id="1261">1261</th><td></td></tr>
<tr><th id="1262">1262</th><td>  <a class="type" href="tuple_simplifier.h.html#xla::TupleSimplifier" title='xla::TupleSimplifier' data-ref="xla::TupleSimplifier">TupleSimplifier</a> <a class="ref fake" href="tuple_simplifier.h.html#_ZN3xla15TupleSimplifierC1Ev" title='xla::TupleSimplifier::TupleSimplifier' data-ref="_ZN3xla15TupleSimplifierC1Ev"></a><dfn class="local col6 decl" id="236tuple_simplifier" title='tuple_simplifier' data-type='xla::TupleSimplifier' data-ref="236tuple_simplifier">tuple_simplifier</dfn>;</td></tr>
<tr><th id="1263">1263</th><td>  <a class="type" href="hlo_dce.h.html#xla::HloDCE" title='xla::HloDCE' data-ref="xla::HloDCE">HloDCE</a> <a class="ref fake" href="hlo_dce.h.html#36" title='xla::HloDCE::HloDCE' data-ref="_ZN3xla6HloDCEC1Ev"></a><dfn class="local col7 decl" id="237dce" title='dce' data-type='xla::HloDCE' data-ref="237dce">dce</dfn>;</td></tr>
<tr><th id="1264">1264</th><td>  <a class="macro" href="../status_macros.h.html#199" title="auto _status_or_value25 = (tuple_simplifier.Run(module)); if ((__builtin_expect(!_status_or_value25.ok(), 0))) { return _status_or_value25.status(); } bool tuple_simplifier_changed = std::move(_status_or_value25.ValueOrDie())" data-ref="_M/TF_ASSIGN_OR_RETURN">TF_ASSIGN_OR_RETURN</a>(<em>bool</em> <dfn class="local col8 decl" id="238tuple_simplifier_changed" title='tuple_simplifier_changed' data-type='bool' data-ref="238tuple_simplifier_changed">tuple_simplifier_changed</dfn>,</td></tr>
<tr><th id="1265">1265</th><td>                      <a class="local col6 ref" href="#236tuple_simplifier" title='tuple_simplifier' data-ref="236tuple_simplifier">tuple_simplifier</a>.<a class="virtual ref" href="tuple_simplifier.h.html#_ZN3xla15TupleSimplifier3RunEPNS_9HloModuleE" title='xla::TupleSimplifier::Run' data-ref="_ZN3xla15TupleSimplifier3RunEPNS_9HloModuleE">Run</a>(<a class="local col2 ref" href="#222module" title='module' data-ref="222module">module</a>));</td></tr>
<tr><th id="1266">1266</th><td>  <a class="macro" href="../status_macros.h.html#199" title="auto _status_or_value27 = (dce.Run(module)); if ((__builtin_expect(!_status_or_value27.ok(), 0))) { return _status_or_value27.status(); } bool dce_changed = std::move(_status_or_value27.ValueOrDie())" data-ref="_M/TF_ASSIGN_OR_RETURN">TF_ASSIGN_OR_RETURN</a>(<em>bool</em> <dfn class="local col9 decl" id="239dce_changed" title='dce_changed' data-type='bool' data-ref="239dce_changed">dce_changed</dfn>, <a class="local col7 ref" href="#237dce" title='dce' data-ref="237dce">dce</a>.<a class="virtual ref" href="hlo_dce.h.html#_ZN3xla6HloDCE3RunEPNS_9HloModuleE" title='xla::HloDCE::Run' data-ref="_ZN3xla6HloDCE3RunEPNS_9HloModuleE">Run</a>(<a class="local col2 ref" href="#222module" title='module' data-ref="222module">module</a>));</td></tr>
<tr><th id="1267">1267</th><td></td></tr>
<tr><th id="1268">1268</th><td>  <b>return</b> <a class="ref fake" href="../statusor.h.html#_ZN3xla8StatusOrC1EOT_" title='xla::StatusOr::StatusOr&lt;T&gt;' data-ref="_ZN3xla8StatusOrC1EOT_"></a><a class="local col5 ref" href="#225changed" title='changed' data-ref="225changed">changed</a> || <a class="local col8 ref" href="#1264" title='tuple_simplifier_changed' data-ref="238tuple_simplifier_changed">tuple_simplifier_changed</a> || <a class="local col9 ref" href="#1266" title='dce_changed' data-ref="239dce_changed">dce_changed</a>;</td></tr>
<tr><th id="1269">1269</th><td>}</td></tr>
<tr><th id="1270">1270</th><td></td></tr>
<tr><th id="1271">1271</th><td>}  <i>// namespace xla</i></td></tr>
<tr><th id="1272">1272</th><td></td></tr>
</table><hr/><p id='footer'>
Generated on <em>2018-Aug-16</em> from project tensorflow revision <em>v1.8</em><br />Powered by <a href='https://woboq.com'><img alt='Woboq' src='https://code.woboq.org/woboq-16.png' width='41' height='16' /></a> <a href='https://code.woboq.org'>Code Browser</a> 2.1
<br/>Generator usage only permitted with license.</p>
</div></body></html>
